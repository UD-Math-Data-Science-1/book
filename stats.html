<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Descriptive statistics – Data Science 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./classification.html" rel="next">
<link href="./data.html" rel="prev">
<link href="./_media/logo_small.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script> 
MathJax = {
  chtml: {
    scale: 0.92,
  }
}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stats.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="quarto-sidebar-header"><div class="sidebar-header-item">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_media/logo_small.png" class="quarto-figure quarto-figure-center figure-img" height="120"></p>
</figure>
</div>
</div></div>
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science 1</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./starting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Representation of data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Classification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model selection</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Networks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Review questions by section</span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>Copyright (c) 2024 by <a href="https://tobydriscoll.net">Toby Driscoll</a></p>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link active" data-scroll-target="#summary-statistics"><span class="header-section-number">2.1</span> Summary statistics</a>
  <ul class="collapse">
  <li><a href="#mean-and-dispersion" id="toc-mean-and-dispersion" class="nav-link" data-scroll-target="#mean-and-dispersion"><span class="header-section-number">2.1.1</span> Mean and dispersion</a></li>
  <li><a href="#populations-and-samples" id="toc-populations-and-samples" class="nav-link" data-scroll-target="#populations-and-samples"><span class="header-section-number">2.1.2</span> Populations and samples</a></li>
  <li><a href="#z-scores" id="toc-z-scores" class="nav-link" data-scroll-target="#z-scores"><span class="header-section-number">2.1.3</span> z-scores</a></li>
  <li><a href="#median-and-quantiles" id="toc-median-and-quantiles" class="nav-link" data-scroll-target="#median-and-quantiles"><span class="header-section-number">2.1.4</span> Median and quantiles</a></li>
  </ul></li>
  <li><a href="#empirical-distributions" id="toc-empirical-distributions" class="nav-link" data-scroll-target="#empirical-distributions"><span class="header-section-number">2.2</span> Empirical distributions</a>
  <ul class="collapse">
  <li><a href="#histograms" id="toc-histograms" class="nav-link" data-scroll-target="#histograms"><span class="header-section-number">2.2.1</span> Histograms</a></li>
  <li><a href="#empirical-cdf" id="toc-empirical-cdf" class="nav-link" data-scroll-target="#empirical-cdf"><span class="header-section-number">2.2.2</span> Empirical CDF</a></li>
  </ul></li>
  <li><a href="#continuous-distributions" id="toc-continuous-distributions" class="nav-link" data-scroll-target="#continuous-distributions"><span class="header-section-number">2.3</span> Continuous distributions</a>
  <ul class="collapse">
  <li><a href="#cdf" id="toc-cdf" class="nav-link" data-scroll-target="#cdf"><span class="header-section-number">2.3.1</span> CDF</a></li>
  <li><a href="#pdf" id="toc-pdf" class="nav-link" data-scroll-target="#pdf"><span class="header-section-number">2.3.2</span> PDF</a></li>
  <li><a href="#random-numbers-in-python" id="toc-random-numbers-in-python" class="nav-link" data-scroll-target="#random-numbers-in-python"><span class="header-section-number">2.3.3</span> Random numbers in Python</a></li>
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution"><span class="header-section-number">2.3.4</span> Normal distribution</a></li>
  </ul></li>
  <li><a href="#grouping-data" id="toc-grouping-data" class="nav-link" data-scroll-target="#grouping-data"><span class="header-section-number">2.4</span> Grouping data</a>
  <ul class="collapse">
  <li><a href="#facet-box-and-violin-plots" id="toc-facet-box-and-violin-plots" class="nav-link" data-scroll-target="#facet-box-and-violin-plots"><span class="header-section-number">2.4.1</span> Facet, box, and violin plots</a></li>
  <li><a href="#sec-stats-groupby" id="toc-sec-stats-groupby" class="nav-link" data-scroll-target="#sec-stats-groupby"><span class="header-section-number">2.4.2</span> Grouped operations in pandas</a></li>
  <li><a href="#grouping-by-a-quantitative-variable" id="toc-grouping-by-a-quantitative-variable" class="nav-link" data-scroll-target="#grouping-by-a-quantitative-variable"><span class="header-section-number">2.4.3</span> Grouping by a quantitative variable</a></li>
  </ul></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers"><span class="header-section-number">2.5</span> Outliers</a>
  <ul class="collapse">
  <li><a href="#iqr" id="toc-iqr" class="nav-link" data-scroll-target="#iqr"><span class="header-section-number">2.5.1</span> IQR</a></li>
  <li><a href="#mean-and-std" id="toc-mean-and-std" class="nav-link" data-scroll-target="#mean-and-std"><span class="header-section-number">2.5.2</span> Mean and STD</a></li>
  </ul></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">2.6</span> Correlation</a>
  <ul class="collapse">
  <li><a href="#relational-plots" id="toc-relational-plots" class="nav-link" data-scroll-target="#relational-plots"><span class="header-section-number">2.6.1</span> Relational plots</a></li>
  <li><a href="#correlation-1" id="toc-correlation-1" class="nav-link" data-scroll-target="#correlation-1"><span class="header-section-number">2.6.2</span> Correlation</a></li>
  <li><a href="#spearman-coefficient" id="toc-spearman-coefficient" class="nav-link" data-scroll-target="#spearman-coefficient"><span class="header-section-number">2.6.3</span> Spearman coefficient</a></li>
  <li><a href="#categorical-correlation" id="toc-categorical-correlation" class="nav-link" data-scroll-target="#categorical-correlation"><span class="header-section-number">2.6.4</span> Categorical correlation</a></li>
  </ul></li>
  <li><a href="#cautionary-tales" id="toc-cautionary-tales" class="nav-link" data-scroll-target="#cautionary-tales"><span class="header-section-number">2.7</span> Cautionary tales</a>
  <ul class="collapse">
  <li><a href="#the-datasaurus" id="toc-the-datasaurus" class="nav-link" data-scroll-target="#the-datasaurus"><span class="header-section-number">2.7.1</span> The Datasaurus</a></li>
  <li><a href="#correlation-vs.-dependence" id="toc-correlation-vs.-dependence" class="nav-link" data-scroll-target="#correlation-vs.-dependence"><span class="header-section-number">2.7.2</span> Correlation vs.&nbsp;dependence</a></li>
  <li><a href="#sec-stats-simpson" id="toc-sec-stats-simpson" class="nav-link" data-scroll-target="#sec-stats-simpson"><span class="header-section-number">2.7.3</span> Simpson’s paradox</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
<p><span class="math display">\[
    \newcommand{\float}{\mathbb{F}}
    \newcommand{\real}{\mathbb{R}}
    \newcommand{\complex}{\mathbb{C}}
    \newcommand{\nat}{\mathbb{N}}
    \newcommand{\integer}{\mathbb{Z}}
    \newcommand{\bfa}{\mathbf{a}}
    \newcommand{\bfe}{\mathbf{e}}
    \newcommand{\bfh}{\mathbf{h}}
    \newcommand{\bfp}{\mathbf{p}}
    \newcommand{\bfq}{\mathbf{q}}
    \newcommand{\bfu}{\mathbf{u}}
    \newcommand{\bfv}{\mathbf{v}}
    \newcommand{\bfw}{\mathbf{w}}
    \newcommand{\bfx}{\mathbf{x}}
    \newcommand{\bfy}{\mathbf{y}}
    \newcommand{\bfz}{\mathbf{z}}
    \newcommand{\bfA}{\mathbf{A}}
    \newcommand{\bfW}{\mathbf{W}}
    \newcommand{\bfX}{\mathbf{X}}
    \newcommand{\bfzero}{\boldsymbol{0}}
    \newcommand{\bfmu}{\boldsymbol{\mu}}
    \newcommand{\TP}{\text{TP}}
    \newcommand{\TN}{\text{TN}}
    \newcommand{\FP}{\text{FP}}
    \newcommand{\FN}{\text{FN}}
    \newcommand{\rmn}[2]{\mathbb{R}^{#1 \times #2}}
    \newcommand{\dd}[2]{\frac{d #1}{d #2}}
    \newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
    \newcommand{\norm}[1]{\left\lVert \mathstrut #1 \right\rVert}
    \newcommand{\abs}[1]{\left\lvert \mathstrut #1 \right\rvert}
    \newcommand{\twonorm}[1]{\norm{#1}_2}
    \newcommand{\onenorm}[1]{\norm{#1}_1}
    \newcommand{\infnorm}[1]{\norm{#1}_\infty}
    \newcommand{\innerprod}[2]{\langle #1,#2 \rangle}
    \newcommand{\pr}[1]{^{(#1)}}
    \newcommand{\diag}{\operatorname{diag}}
    \newcommand{\sign}{\operatorname{sign}}
    \newcommand{\dist}{\operatorname{dist}}
    \newcommand{\simil}{\operatorname{sim}}
    \newcommand{\ee}{\times 10^}
    \newcommand{\floor}[1]{\lfloor#1\rfloor}
    \newcommand{\argmin}{\operatorname{argmin}}
    \newcommand{\E}[1]{\operatorname{\mathbb{E}}\left[\mathstrut #1\right]}
    \newcommand{\Cov}{\operatorname{Cov}}
    \newcommand{\logit}{\operatorname{logit}}
\]</span></p>
</div>
<p>When confronted with a new dataset, it’s crucial to get a sense of its characteristics before attempting to draw conclusions or predictions from it. There are two aspects of this exploration: numerical and graphical. We begin with numbers.</p>
<section id="summary-statistics" class="level2 page-columns page-full" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="summary-statistics"><span class="header-section-number">2.1</span> Summary statistics</h2>
<p>The idea of descriptive statistics is to reduce a large collection of numerical values to a much smaller one, or even a single number, that captures essential features. You have probably encountered at least a few of these statistics before. In many cases, the statistical results connect to mathematical theory that makes it possible to reason abstractly about the data.</p>
<div id="exm-stats-summary" class="theorem example" data-chapter="2" type="💻" data-description="Summary statistics in pandas">
<p><span class="theorem-title"><strong>Example 2.1</strong></span> Here a classic dataset about flowers:</p>
<div id="13cc7056" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/mwaskom/seaborn-data/master/iris.csv'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>iris.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 150 entries, 0 to 149
Data columns (total 5 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   sepal_length  150 non-null    float64
 1   sepal_width   150 non-null    float64
 2   petal_length  150 non-null    float64
 3   petal_width   150 non-null    float64
 4   species       150 non-null    object 
dtypes: float64(4), object(1)
memory usage: 6.0+ KB</code></pre>
</div>
</div>
<p>The <code>describe</code> method of a data frame gives a bunch of summary statistics for each column of quantitative data:</p>
<div id="1c53b4b5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>iris.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sepal_length</th>
<th data-quarto-table-cell-role="th">sepal_width</th>
<th data-quarto-table-cell-role="th">petal_length</th>
<th data-quarto-table-cell-role="th">petal_width</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">count</td>
<td>150.000000</td>
<td>150.000000</td>
<td>150.000000</td>
<td>150.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">mean</td>
<td>5.843333</td>
<td>3.057333</td>
<td>3.758000</td>
<td>1.199333</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">std</td>
<td>0.828066</td>
<td>0.435866</td>
<td>1.765298</td>
<td>0.762238</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">min</td>
<td>4.300000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>0.100000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">25%</td>
<td>5.100000</td>
<td>2.800000</td>
<td>1.600000</td>
<td>0.300000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">50%</td>
<td>5.800000</td>
<td>3.000000</td>
<td>4.350000</td>
<td>1.300000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">75%</td>
<td>6.400000</td>
<td>3.300000</td>
<td>5.100000</td>
<td>1.800000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">max</td>
<td>7.900000</td>
<td>4.400000</td>
<td>6.900000</td>
<td>2.500000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="_media/memes/panda.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="_media/memes/panda.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="200"></a></p>
</figure>
</div>
</div></div><p>We now discuss the definitions and interpretations of the values prodcued by <code>describe</code>.</p>
<section id="mean-and-dispersion" class="level3 page-columns page-full" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="mean-and-dispersion"><span class="header-section-number">2.1.1</span> Mean and dispersion</h3>
<p>Here are the Big Three of summary statistics: mean, variance, and standard deviation.</p>
<div id="def-stats-meanvarstd" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.1</strong></span> Given data values <span class="math inline">\(x_1,\ldots,x_n\)</span>, their <strong>mean</strong> is <span id="eq-stats-mean"><span class="math display">\[
\mu = \frac{1}{n}\sum_{i=1}^n x_i,
\tag{2.1}\]</span></span></p>
<p>their <strong>variance</strong> is <span id="eq-stats-var"><span class="math display">\[
\sigma^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \mu)^2,
\tag{2.2}\]</span></span></p>
<p>and their <strong>standard deviation</strong> (STD) is <span class="math inline">\(\sigma\)</span>, the square root of the variance.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_geff87ds&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_d2z5o00p" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 2.1.1" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>Mean is a measurement of central tendency. Variance and STD are measures of spread or <strong>dispersion</strong> in the data.</p>
<div id="exm-stats-maxvar" class="theorem example" data-chapter="2" type="✍️" data-description="Standard deviation by hand">
<p><span class="theorem-title"><strong>Example 2.2</strong></span> Suppose that <span class="math inline">\(x_1=0\)</span>, <span class="math inline">\(x_2=t\)</span>, and <span class="math inline">\(x_3=-t\)</span>, where <span class="math inline">\(|t| \le 6\)</span>. What are the minimum and maximum possible values of the standard deviation?</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>The mean is <span class="math inline">\(\mu=0\)</span>, hence <span class="math display">\[
\sigma^2 = \frac{1}{3}\left[ 0^2 + t^2 + (-t)^2 \right] = \frac{2}{3} t^2.
\]</span> From this we conclude <span class="math display">\[
\sigma =  \sqrt{\tfrac{2}{3}} |t|.
\]</span> Given that <span class="math inline">\(0 \le |t| \le 6\)</span>, we see that the minimum value of <span class="math inline">\(\sigma\)</span> is 0 and the maximum is <span class="math inline">\(2\sqrt{6}\)</span>.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_o10wj99b&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_3dy7ythh" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.2" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variance is in units that are the square of the data, which can be hard to interpret. But it has other characteristics that are useful mathematically.</p>
</div>
</div>
</section>
<section id="populations-and-samples" class="level3 page-columns page-full" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="populations-and-samples"><span class="header-section-number">2.1.2</span> Populations and samples</h3>
<p>In statistics one refers to the <strong>population</strong> as the entire universe of available values. Thus, the ages of adults on Earth at some instant has a particular population mean and standard deviation. However, we can usually only measure a <strong>sample</strong> of the population directly, and we use the sample mean and standard deviation as estimates of the population values.</p>
<p>The definitions in <a href="#def-stats-meanvarstd" class="quarto-xref">Definition&nbsp;<span>2.1</span></a> are for populations. When they are used on a sample rather than a population, we change the notation a bit as a reminder.</p>
<div id="def-stats-sample-mean" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.2</strong></span> Given a sample of data values <span class="math inline">\(x_1,\ldots,x_n\)</span>, the <strong>sample mean</strong> is</p>
<p><span id="eq-stats-mean-sample"><span class="math display">\[
\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i,
\tag{2.3}\]</span></span></p>
<p>and the <strong>sample variance</strong> is <span class="math display">\[
s_n^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2.
\]</span></p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="_media/memes/sample.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="_media/memes/sample.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="200"></a></p>
</figure>
</div>
</div></div><p>It can be proved that the sample mean is an accurate way to estimate the population mean, in the following precise sense. If, in a thought experiment, we could average <span class="math inline">\(\bar{x}\)</span> over all possible samples of size <span class="math inline">\(n\)</span>, the result would be exactly the population mean <span class="math inline">\(\mu\)</span>. That is, we say that <span class="math inline">\(\bar{x}\)</span> is an <strong>unbiased estimator</strong> for <span class="math inline">\(\mu\)</span>.</p>
<p>The situation with sample variance is more subtle. If <span class="math inline">\(s_n^2\)</span> is averaged over all possible sample sets, we do <em>not</em> get the population variance <span class="math inline">\(\sigma^2\)</span>; hence, <span class="math inline">\(s_n^2\)</span> is called a <strong>biased estimator</strong> of the population variance. This can be proved by a calculation we won’t go into here, but the essential issue is that the sample mean used in <span class="math inline">\(s_n^2\)</span> is itself only an estimate of the population mean. A minor adjustment fixes that issue.</p>
<div id="thm-stats-sample-var" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.1</strong></span> An unbiased estimator for <span class="math inline">\(\sigma^2\)</span> is</p>
<p><span id="eq-stats-var-sample"><span class="math display">\[
s_{n-1}^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2.
\tag{2.4}\]</span></span></p>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sources are not always uniform using this terminology. Some use <em>sample variance</em> to mean <span class="math inline">\(s_{n-1}^2\)</span>, not <span class="math inline">\(s_n^2\)</span>, and many even omit the subscripts. You should check any source to understand its conventions.</p>
</div>
</div>
<div id="exm-stats-sample" class="theorem example" data-chapter="2" type="✍️" data-description="Sample variance">
<p><span class="theorem-title"><strong>Example 2.3</strong></span> The values [1, 4, 9, 16, 25] have mean <span class="math inline">\(\bar{x}=55/5 = 11\)</span>. The sample variance is</p>
<p><span class="math display">\[
\begin{split}
    s_n^2 &amp;= \frac{(1-11)^2+(4-11)^2+(9-11)^2+(16-11)^2+(25-11)^2}{5} \\
    &amp; = \frac{374}{5} = 74.8.
\end{split}
\]</span></p>
<p>By contrast, the unbiased estimate of population variance from this sample is</p>
<p><span class="math display">\[
s_{n-1}^2 = \frac{374}{4} = 93.5.
\]</span></p>
</div>
<p>As you can see from the formulas and in <a href="#exm-stats-sample" class="quarto-xref">Example&nbsp;<span>2.3</span></a>, <span class="math inline">\(s_n^2\)</span> is always an overestimate of the variance. However, the difference becomes negligible as the sample size <span class="math inline">\(n\)</span> increases, and in any practical dataset the distinction is basically academic.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>NumPy computes the biased estimator of variance by default, while pandas computes the unbiased version. Whee!</p>
</div>
</div>
<p>For standard deviation, <em>neither</em> <span class="math inline">\(s_n\)</span> <em>nor</em> <span class="math inline">\(s_{n-1}\)</span> is an unbiased estimator of <span class="math inline">\(\sigma\)</span>, and there is no simple fix. Again, though, it’s not usually something we worry about in practice.</p>
<div id="exm-stats-meanvar-pandas" class="theorem example" data-chapter="2" type="💻" data-description="Mean, variance, STD in pandas">
<p><span class="theorem-title"><strong>Example 2.4</strong></span> While the <code>describe</code> method computes all the summary statistics, you can also obtain them individually using the <code>mean</code>, <code>var</code>, and <code>std</code> methods:</p>
<div id="73a4b095" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>iris.select_dtypes(np.number).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>sepal_length    5.843333
sepal_width     3.057333
petal_length    3.758000
petal_width     1.199333
dtype: float64</code></pre>
</div>
</div>
<p>The result above is a series with the mean of each column. When given a series, the result is just a number:</p>
<div id="2a90d18f" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="st">"sepal_length"</span>].var()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0.6856935123042507</code></pre>
</div>
</div>
</div>
</section>
<section id="z-scores" class="level3 page-columns page-full" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="z-scores"><span class="header-section-number">2.1.3</span> z-scores</h3>
<p>Comparing or operating on datasets that have different ranges can be difficult. One common step is to <strong>standardize</strong> the data.</p>
<div id="def-stats-zscores" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.3</strong></span> Given data values <span class="math inline">\(x_1,\ldots,x_n\)</span>, we define the <strong>standardized scores</strong> or <strong>z-scores</strong> by</p>
<p><span id="eq-stats-zscores"><span class="math display">\[
z_i = \frac{x_i-\mu}{\sigma}, \qquad i=1,\ldots,n.
\tag{2.5}\]</span></span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="#eq-stats-zscores" class="quarto-xref">Equation&nbsp;<span>2.5</span></a> requires the population statistics <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. If sample estimates are used, the results are technically called <em>t-scores</em> in classical statistics, but this distinction is generally ignored for large datasets in practice.</p>
</div>
</div>
<p>In physical terms, z-scores are dimensionless, i.e., not dependent on the physical units chosen to express the data. The following characteristics are important:</p>
<div id="thm-stats-zscores" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.2</strong></span> The z-scores have mean equal to zero and variance equal to 1.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Using the definition <a href="#eq-stats-zscores" class="quarto-xref">Equation&nbsp;<span>2.5</span></a>, we calculate the mean of the z-scores as</p>
<p><span class="math display">\[
\begin{split}
    \frac{1}{n}\sum_{i=1}^n z_i &amp;= \frac{1}{n}\sum_{i=1}^n \frac{x_i-\mu}{\sigma} \\
    &amp;= \frac{1}{n\sigma}\sum_{i=1}^n x_i - \frac{1}{n\sigma}\sum_{i=1}^n \mu \\
    &amp;= \frac{1}{n\sigma}\sum_{i=1}^n x_i - \frac{1}{n\sigma}(n\mu) \\
    &amp;= \frac{1}{n\sigma}\sum_{i=1}^n x_i - \frac{\mu}{\sigma} \\
    &amp;= \frac{1}{\sigma}\left( \frac{1}{n}\sum_{i=1}^n x_i - \mu \right) = 0.
\end{split}
\]</span></p>
<p>A longer but similar direct calculation shows that the variance is 1.</p>
</div>
<div id="exm-stats-zscores" class="theorem example" data-chapter="2" type="✍️, 💻" data-description="Z scores">
<p><span class="theorem-title"><strong>Example 2.5</strong></span> Continuing with the values from <a href="#exm-stats-maxvar" class="quarto-xref">Example&nbsp;<span>2.2</span></a>, we assume without losing generality that <span class="math inline">\(t\ge 0\)</span>. (Otherwise, we can just swap <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span>.) Then we have the z-scores <span class="math display">\[
z_1 = \frac{0-0}{2t\sqrt{6}} = 0, \quad z_2 = \frac{t-0}{2t\sqrt{6}} = \frac{1}{2\sqrt{6}} \quad z_3 = \frac{-t-0}{2t\sqrt{6}} = \frac{-1}{2\sqrt{6}}.
\]</span></p>
<p>These are independent of <span class="math inline">\(t\)</span>, which just scales the original values.</p>
</div>
<div id="exm-stats-zscores-py" class="theorem example" data-chapter="2" type="💻" data-description="Z scores in Python">
<p><span class="theorem-title"><strong>Example 2.6</strong></span> We can write a little function to compute z-scores in Python:</p>
<div id="78df2d79" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> standardize(x):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">-</span> x.mean()) <span class="op">/</span> x.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function can be applied to any series <code>x</code> and returns a series of the same length. If we apply it to a data frame, it standardizes each column:</p>
<div id="52d09e53" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="st">"z"</span>] <span class="op">=</span> standardize( iris[<span class="st">"petal_length"</span>] )</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>iris[ [<span class="st">"petal_length"</span>, <span class="st">"z"</span>] ].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">petal_length</th>
<th data-quarto-table-cell-role="th">z</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">count</td>
<td>150.000000</td>
<td>1.500000e+02</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">mean</td>
<td>3.758000</td>
<td>-2.842171e-16</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">std</td>
<td>1.765298</td>
<td>1.000000e+00</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">min</td>
<td>1.000000</td>
<td>-1.562342e+00</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">25%</td>
<td>1.600000</td>
<td>-1.222456e+00</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">50%</td>
<td>4.350000</td>
<td>3.353541e-01</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">75%</td>
<td>5.100000</td>
<td>7.602115e-01</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">max</td>
<td>6.900000</td>
<td>1.779869e+00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_btuf0vym&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_d85ascs9" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.6" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since floating-point values are rounded off, it’s unlikely that a value derived from them that is meant to be zero will actually be exactly zero. Above, the mean value of about <span class="math inline">\(-10^{-15}\)</span> should be seen as reasonable for values that have been rounded off in the 15th digit or so.</p>
</div>
</div>
</section>
<section id="median-and-quantiles" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="median-and-quantiles"><span class="header-section-number">2.1.4</span> Median and quantiles</h3>
<p>Mean and variance are not the most relevant summary statistics for every dataset. There are important alternatives.</p>
<div id="def-stats-percentile" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.4</strong></span> For any <span class="math inline">\(0 &lt; p &lt; 1\)</span>, the <span class="math inline">\(100p\)</span>-<strong>percentile</strong> or <strong>quantile</strong> is the value of <span class="math inline">\(x\)</span> such that <span class="math inline">\(p\)</span> is the probability of observing a population value less than or equal to <span class="math inline">\(x\)</span>.</p>
<p>The 50th percentile is known as the <strong>median</strong> of the population.</p>
</div>
<!-- In other words, percentiles are the inverse function of the CDF.  -->
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some sources reserve the term <em>quantile</em> for another meaning, but since pandas offers <code>quantile</code> to compute percentiles, we don’t draw a distinction.</p>
</div>
</div>
<p>The unbiased sample median of <span class="math inline">\(x_1,\ldots,x_n\)</span> can be computed by sorting the values into <span class="math inline">\(y_1,\ldots,y_n\)</span>. If <span class="math inline">\(n\)</span> is odd, then <span class="math inline">\(y_{(n+1)/2}\)</span> is the sample median; otherwise, the average of <span class="math inline">\(y_{n/2}\)</span> and <span class="math inline">\(y_{1+(n/2)}\)</span> is the sample median.</p>
<div id="exm-stats-median" class="theorem example" data-chapter="2" type="✍️" data-description="Median">
<p><span class="theorem-title"><strong>Example 2.7</strong></span> For the sorted sample values <span class="math inline">\(1,3,3,4,5,5,5\)</span>, we have <span class="math inline">\(n=7\)</span> and the sample median is <span class="math inline">\(4\)</span>.</p>
<p>If the sample values are <span class="math inline">\(1,3,3,4,5,5,5,9\)</span>, then <span class="math inline">\(n=8\)</span> and the sample median is <span class="math inline">\((4+5)/2=4.5\)</span>.</p>
</div>
<div id="exm-stats-quantiles" class="theorem example" data-chapter="2" type="💻" data-description="Quantiles">
<p><span class="theorem-title"><strong>Example 2.8</strong></span> Here we find the 90th quantile (percentile) of the <em>loan_amnt</em> variable in the <code>loans</code> dataset:</p>
<div id="d61970b2" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>loans <span class="op">=</span> pd.read_csv(<span class="st">"_datasets/loans_small.csv"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> loans[<span class="st">"loan_amnt"</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>pct90 <span class="op">=</span> x.quantile(<span class="fl">0.9</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pct90)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>22000.0</code></pre>
</div>
</div>
<p>Equivalently, 90 percent of the values are no greater than that value:</p>
<div id="d572905f" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(x <span class="op">&lt;=</span> pct90) <span class="op">/</span> <span class="bu">len</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>0.9008233250245486</code></pre>
</div>
</div>
<p>The 50th percentile is the same thing as the median:</p>
<div id="7422e881" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x.median())</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x.quantile(<span class="fl">0.50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10000.0
10000.0</code></pre>
</div>
</div>
</div>
<p>The median is a measure of central tendency that can substitute for the mean. To calculate an alternative to the standard deviation, we can use two other quantiles.</p>
<div id="def-stats-quartile" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.5</strong></span> The 25th, 50th, and 75th percentiles are the called first, second, and third <strong>quartiles</strong> of the distribution. The <strong>interquartile range (IQR)</strong> is the difference between the 75th percentile and the 25th percentile.</p>
</div>
<!-- Sometimes the definition above is extended to the *zeroth quartile*, which is the minimum sample value, and the *fourth quartile*, which is the maximum sample value. -->
<p>For some samples, the median and IQR might be a good substitute for the mean and standard deviation.</p>
<div id="exm-stats-describe" class="theorem example" data-chapter="2" type="💻" data-description="Quartiles and IQR">
<p><span class="theorem-title"><strong>Example 2.9</strong></span> The dataframe <code>describe</code> method includes mean, standard deviation, and the quartiles:</p>
<div id="28a4861b" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>loans.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Unnamed: 0</th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">funded_amnt</th>
<th data-quarto-table-cell-role="th">int_rate</th>
<th data-quarto-table-cell-role="th">annual_inc</th>
<th data-quarto-table-cell-role="th">total_pymnt</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">count</td>
<td>39717.000000</td>
<td>39717.000000</td>
<td>39717.000000</td>
<td>39717.000000</td>
<td>3.971700e+04</td>
<td>39717.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">mean</td>
<td>19858.000000</td>
<td>11219.443815</td>
<td>10947.713196</td>
<td>12.021177</td>
<td>6.896893e+04</td>
<td>12153.596544</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">std</td>
<td>11465.454657</td>
<td>7456.670694</td>
<td>7187.238670</td>
<td>3.724825</td>
<td>6.379377e+04</td>
<td>9042.040766</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>500.000000</td>
<td>500.000000</td>
<td>5.420000</td>
<td>4.000000e+03</td>
<td>0.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">25%</td>
<td>9929.000000</td>
<td>5500.000000</td>
<td>5400.000000</td>
<td>9.250000</td>
<td>4.040400e+04</td>
<td>5576.930000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">50%</td>
<td>19858.000000</td>
<td>10000.000000</td>
<td>9600.000000</td>
<td>11.860000</td>
<td>5.900000e+04</td>
<td>9899.640319</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">75%</td>
<td>29787.000000</td>
<td>15000.000000</td>
<td>15000.000000</td>
<td>14.590000</td>
<td>8.230000e+04</td>
<td>16534.433040</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">max</td>
<td>39716.000000</td>
<td>35000.000000</td>
<td>35000.000000</td>
<td>24.590000</td>
<td>6.000000e+06</td>
<td>58563.679930</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>It’s easy to write a function that computes and returns the IQR of a series:</p>
<div id="377eacf1" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> IQR(x):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    Q25, Q75 <span class="op">=</span> x.quantile( [<span class="fl">0.25</span>, <span class="fl">0.75</span>] )</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Q75 <span class="op">-</span> Q25 </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>IQR(loans[<span class="st">"loan_amnt"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>9500.0</code></pre>
</div>
</div>
<p>That function can also be applied columnwise to a data frame:</p>
<div id="d1d97b51" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>loans.<span class="bu">apply</span>(IQR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Unnamed: 0     19858.00000
loan_amnt       9500.00000
funded_amnt     9600.00000
int_rate           5.34000
annual_inc     41896.00000
total_pymnt    10957.50304
dtype: float64</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="empirical-distributions" class="level2 page-columns page-full" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="empirical-distributions"><span class="header-section-number">2.2</span> Empirical distributions</h2>
<p>Mean and STD, or median and IQR, attempt to summarize quantitative data with a couple of numbers. At the other extreme, we can express the distribution values more precisely using functions and graphical tools.</p>
<p>Python has many graphics packages with different niches. The most widespread is <strong>Matplotlib</strong>, for which you must explicitly specify most aspects of how the plots will look.</p>
<p>We will instead use <strong>seaborn</strong>, which is built on top of Matplotlib. It’s built around a declarative style, meaning that you describe what you want to see and seaborn makes the decisions about how it looks. Most of the time, the decisions it makes are just fine. To use seaborn, you import it:</p>
<div id="cbea8982" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are three major commands that you call in seaborn:</p>
<dl>
<dt><code>displot</code></dt>
<dd>
How values of a single variable are distributed.
</dd>
<dt><code>catplot</code></dt>
<dd>
How categorical values are distributed within and across categories.
</dd>
<dt><code>relplot</code></dt>
<dd>
How values of two variables are related to each other.
</dd>
</dl>
<p>These three commands then call other functions to create the actual plots. (You can call those directly yourself, but then you will be missing a lot of automated setup and formatting that seaborn provides.)</p>
<section id="histograms" class="level3 page-columns page-full" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="histograms"><span class="header-section-number">2.2.1</span> Histograms</h3>
<p>By definition, we know that if <span class="math inline">\(a&lt;b\)</span>, <span class="math inline">\(\hat{F}(b) - \hat{F}(a)\)</span> is the number of observations in the half-open interval <span class="math inline">\((a,b]\)</span>. This leads into the next definition.</p>
<div id="def-stats-histogram" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.6</strong></span> Select the ordered values <span class="math inline">\(t_1 &lt; t_2 &lt; \cdots &lt; t_m\)</span>, called <strong>edges</strong>, and define <strong>bins</strong> as the intervals <span class="math display">\[
B_k = (t_k,t_{k+1}], \qquad k=0,\ldots,m,
\]</span></p>
<p>where we adopt the convention that <span class="math inline">\(t_0=-\infty\)</span> and <span class="math inline">\(t_{m+1}=\infty\)</span>. Let <span class="math inline">\(c_k\)</span> be the number of data values in <span class="math inline">\(B_k\)</span>. Then a <strong>histogram</strong> relative to the bins is the list of <span class="math inline">\((B_0,c_0),\ldots,(B_m,c_m)\)</span>.</p>
</div>
<p>Seaborn uses <code>displot</code> to show empirical distributions, and the default is to show a histogram.</p>
<div id="exm-stats-ecdf-penguins" class="theorem example" data-chapter="2" type="💻" data-description="ECDF of penguins">
<p><span class="theorem-title"><strong>Example 2.10</strong></span> Here is a histogram from the <code>penguins</code> dataset:</p>
<div id="6b775673" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="op">=</span> sns.load_dataset(<span class="st">"penguins"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-15-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can specify the number of bins to use, or their edges:</p>
<div id="5d693a04" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>, bins<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-16-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Sometimes we’d rather show the proportions of values rather than the counts:</p>
<div id="58412acf" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>, stat<span class="op">=</span><span class="st">"proportion"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-17-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_4eybb266&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_yqdbpjv0" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.10" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="empirical-cdf" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="empirical-cdf"><span class="header-section-number">2.2.2</span> Empirical CDF</h3>
<p>Given a sample of a population, we can characterize it using an important function defined by the data.</p>
<div id="def-stats-ecdf" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.7</strong></span> The <strong>empirical cumulative distribution function</strong> or ECDF of a sample is the function <span class="math inline">\(\hat{F}(t)\)</span> whose value at <span class="math inline">\(t\)</span> equals the proportion of the sample values that are less than or equal to <span class="math inline">\(t\)</span>.</p>
</div>
<p>Note that the value of <span class="math inline">\(\hat{F}\)</span> ranges between 0 and 1 (inclusive) and is a nondecreasing function of <span class="math inline">\(t\)</span>.</p>
<div id="exm-stats-uniform-discrete" class="theorem example" data-chapter="2" type="✍️" data-description="ECDF of a simple distribution">
<p><span class="theorem-title"><strong>Example 2.11</strong></span> Consider the population</p>
<p><span class="math display">\[
x_1=1/4, \quad x_2=2/4, \quad x_3=3/4, \quad x_4=1.
\]</span></p>
<p>Since the smallest value is at 1/4, we have <span class="math inline">\(F(t)=0\)</span> when <span class="math inline">\(t &lt; 1/4\)</span>. At <span class="math inline">\(t=1/4\)</span> we have passed 1 of the 4 values, so <span class="math inline">\(F(1/4)=1/4\)</span>. This value of <span class="math inline">\(F\)</span> remains constant until we get to <span class="math inline">\(t=1/2\)</span>, at which point it jumps to the value <span class="math inline">\(1/2\)</span>, and so on, leading to the graph in <a href="#fig-stats-cdf-a" class="quarto-xref">Figure&nbsp;<span>2.1</span></a></p>
<div id="fig-stats-cdf-a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stats-cdf-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="_media/ch2_cdf_a.svg" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stats-cdf-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: CDF for a population of size 4.
</figcaption>
</figure>
</div>
<p>Now consider the population</p>
<p><span class="math display">\[
x_1=1/10, \quad x_2=2/10, \quad x_3=3/10, \quad \ldots, \quad x_{10}=1.
\]</span></p>
<p>Using the same reasoning as above, we get the graph in <a href="#fig-stats-cdf-b" class="quarto-xref">Figure&nbsp;<span>2.2</span></a>.</p>
<div id="fig-stats-cdf-b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stats-cdf-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="_media/ch2_cdf_b.svg" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stats-cdf-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: CDF for a population of size 10.
</figcaption>
</figure>
</div>
</div>
<div id="exm-stats-ecdf-penguins" class="theorem example" data-chapter="2" type="💻" data-description="ECDF of penguins">
<p><span class="theorem-title"><strong>Example 2.12</strong></span> A variation of the seaborn <code>displot</code> function creates an ECDF. Here is one for the <code>penguins</code> dataset:</p>
<div id="d1206122" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="op">=</span> sns.load_dataset(<span class="st">"penguins"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>penguins, x<span class="op">=</span><span class="st">"body_mass_g"</span>, kind<span class="op">=</span><span class="st">"ecdf"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-18-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>It’s a stairstep plot, because the ECDF jumps at each data value.</p>
</div>
<p>There is a simple relationship between the ECDF <span class="math inline">\(\hat{F}\)</span> and histograms. If there are <span class="math inline">\(n\)</span> total observations in the sample and <span class="math inline">\(c_k\)</span> is the count in bin <span class="math inline">\((t_k,t_{k+1}]\)</span>, then</p>
<p><span id="eq-stats-hist-ecdf"><span class="math display">\[
c_k = n[\hat{F}(t_{k+1}) - \hat{F}(t_k)].
\tag{2.6}\]</span></span></p>
</section>
</section>
<section id="continuous-distributions" class="level2 page-columns page-full" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="continuous-distributions"><span class="header-section-number">2.3</span> Continuous distributions</h2>
<p>Paradoxically, sometimes infinity makes things easier. For instance, a Riemann sum is a long, complicated expression, but in the limit of infinitely many rectangles, it becomes a simple definite integral. Something similar happens when we think about populations so large that they can be considered infinite.</p>
<section id="cdf" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="cdf"><span class="header-section-number">2.3.1</span> CDF</h3>
<div id="exm-stats-uniform-continuous" class="theorem example" data-chapter="2" type="✍️" data-description="CDF of a uniform distribution">
<p><span class="theorem-title"><strong>Example 2.13</strong></span> It’s natural and easy to generalize <a href="#exm-stats-uniform-discrete" class="quarto-xref">Example&nbsp;<span>2.11</span></a> to samples of any size <span class="math inline">\(n\)</span>: <span class="math inline">\(x_i=i/n\)</span> for <span class="math inline">\(i=1,\ldots,n\)</span>. Intuitively you cam see that as <span class="math inline">\(n\)</span> increases, the stairs in the plots in <a href="#fig-stats-cdf-a" class="quarto-xref">Figure&nbsp;<span>2.1</span></a> and <a href="#fig-stats-cdf-b" class="quarto-xref">Figure&nbsp;<span>2.2</span></a> become narrower and shallower, eventually becoming a smooth ramp:</p>
<div id="fig-stats-cdf-c" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stats-cdf-c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="_media/ch2_cdf_c.svg" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stats-cdf-c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: CDF for an infinite population.
</figcaption>
</figure>
</div>
<p>The formal expression of the function plotted in <a href="#fig-stats-cdf-c" class="quarto-xref">Figure&nbsp;<span>2.3</span></a> is</p>
<p><span id="eq-stats-uniform-cdf"><span class="math display">\[
F(t) = \begin{cases}
0, &amp; t &lt; 0, \\
t,&amp; 0 \le t \le 1, \\
1,&amp; t &gt; 1.
\end{cases}
\tag{2.7}\]</span></span></p>
<p>Conceptually, this function represents a distribution in which every value between 0 and 1 is equally likely. This is known as the <strong>uniform distribution</strong> over the interval <span class="math inline">\([0,1]\)</span>.</p>
</div>
<p>We now define the continuous counterpart of the ECDF.</p>
<div id="def-stats-cdf-continuous" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.8</strong></span> The <strong>cumulative distribution function</strong> (CDF) of a distribution is the function <span class="math display">\[
F(t) = \text{probability that a randomly chosen value is $\le t$},
\]</span></p>
<p>where <span class="math inline">\(t\)</span> is any real number.</p>
</div>
<p>For a finite population, the CDF and the ECDF are the same.</p>
<div id="exm-stats-temps-ecdf" class="theorem example" data-chapter="2" type="💻" data-description="ECDF of temperatures">
<p><span class="theorem-title"><strong>Example 2.14</strong></span> Here are maximum daily temperatures (in tenths of Celsius degrees) for Newark, DE, starting in 1894:</p>
<div id="0d81f66b" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>weather <span class="op">=</span> pd.read_csv(<span class="st">"_datasets/ghcn_newark.csv"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sns.displot(weather, x<span class="op">=</span><span class="st">"TMAX"</span>, kind<span class="op">=</span><span class="st">"ecdf"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-19-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>More than 29,000 observations are summarized in this ECDF. There are still small steps visible in the graph above because the temperature values are discrete. Even so, there would be little changed by approximating the distribution with a smooth one.</p>
</div>
<p>Conceptually we may interpret a large sample as an approximation to an infinite population. In this case, the ECDF is an approximation to the CDF.</p>
</section>
<section id="pdf" class="level3 page-columns page-full" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="pdf"><span class="header-section-number">2.3.2</span> PDF</h3>
<p>In <a href="#eq-stats-hist-ecdf" class="quarto-xref">Equation&nbsp;<span>2.6</span></a> we connected a histogram to the ECDF via <span class="math inline">\({c_k} = n[\hat{F}(t_{k+1}) - \hat{F}(t_k)]\)</span>, where <span class="math inline">\(c_k\)</span> is the count in bin <span class="math inline">\((t_k,t_{k+1}]\)</span>. If we let <span class="math inline">\(p_k = c_k/n\)</span> be the fraction of observations in that bin, then we can write</p>
<p><span id="eq-stats-pdf"><span class="math display">\[
\frac{p_k}{t_{k+1}-t_k} = \frac{\hat{F}(t_{k+1})-\hat{F}(t_k)}{t_{k+1}-t_k}.
\tag{2.8}\]</span></span></p>
<p>We can interpret the left-hand side of <a href="#eq-stats-pdf" class="quarto-xref">Equation&nbsp;<span>2.8</span></a> as the density of observations in the bin. If we take the limit <span class="math inline">\(t_{k+1} \to t_k\)</span>, we get a derivative on the right-hand side, which motivates the following definition.</p>
<div id="def-stats-pdf" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.9</strong></span> The <strong>probability density function</strong> or <strong>PDF</strong> of a distribution, denoted <span class="math inline">\(f(t)\)</span>, is the derivative of the CDF, i.e.,</p>
<p><span id="eq-stats-pdf-def"><span class="math display">\[
f(t) = F'(t).
\tag{2.9}\]</span></span></p>
</div>
<p>The intuitive interpretation of <span class="math inline">\(f(t)\)</span> is as the probability of observing a value in a tiny interval around <span class="math inline">\(t\)</span>.</p>
<div id="exm-stats-temps-pdf" class="theorem example" data-chapter="2" type="✍️" data-description="PDF of temperature distribution">
<p><span class="theorem-title"><strong>Example 2.15</strong></span> The histogram of the temperature distribution in <a href="#exm-stats-temps-ecdf" class="quarto-xref">Example&nbsp;<span>2.14</span></a> is an approximation to the continuous PDF, if we normalize the counts properly:</p>
<div id="6357aeca" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sns.displot(weather, x<span class="op">=</span><span class="st">"TMIN"</span>, bins<span class="op">=</span><span class="dv">20</span>, stat<span class="op">=</span><span class="st">"density"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-20-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>There is an algorithm known as <strong>kernel density estimation</strong> (KDE) that can be used to estimate the true PDF from a sample. It’s another option in the <code>displot</code> function:</p>
<div id="01f48f19" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sns.displot(weather, x<span class="op">=</span><span class="st">"TMIN"</span>, kind<span class="op">=</span><span class="st">"kde"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-21-output-1.png" width="470" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_a1g6pze9&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_86alwtnf" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.15" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><div id="exm-stats-uniform-pdf" class="theorem example" data-chapter="2" type="✍️" data-description="PDF of a uniform distribution">
<p><span class="theorem-title"><strong>Example 2.16</strong></span> For a uniform distribution over <span class="math inline">\([0,1]\)</span>, we can take the derivative of the CDF in <a href="#eq-stats-uniform-cdf" class="quarto-xref">Equation&nbsp;<span>2.7</span></a> to get</p>
<p><span id="eq-stats-uniform-pdf"><span class="math display">\[
F'(t) = \begin{cases}
0, &amp; t &lt; 0, \\
1, &amp; 0 &lt; t &lt; 1, \\
0, &amp; t &gt; 1.
\end{cases}
\tag{2.10}\]</span></span></p>
<p>We’re sweeping some details under the rug here, because <span class="math inline">\(F\)</span> is not differentiable at <span class="math inline">\(t=0\)</span> and <span class="math inline">\(t=1\)</span>. It turns out that we can mostly ignore such points in practice.</p>
</div>
<p>The Fundamental Theorem of Calculus and <a href="#eq-stats-pdf-def" class="quarto-xref">Equation&nbsp;<span>2.9</span></a> imply that the CDF is the integral of the PDF. Specifically, for any value of <span class="math inline">\(a\)</span>,</p>
<p><span id="eq-stats-cdf-integral"><span class="math display">\[
F(t) = F(a) + \int_{a}^t f(s) \, ds.
\tag{2.11}\]</span></span></p>
</section>
<section id="random-numbers-in-python" class="level3 page-columns page-full" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="random-numbers-in-python"><span class="header-section-number">2.3.3</span> Random numbers in Python</h3>
<p>Generating truly random numbers on a computer is not simple. We rely on <em>pseudorandom</em> numbers, which are generated by deterministic functions called <strong>random number generators</strong> (RNGs) that have extremely long periods. One consequence is repeatability: by specifying the starting state of the RNG, you can get exactly the same pseudorandom sequence every time.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is an older way to use random numbers in NumPy than the one presented here. You’ll still find it on the web and in some books, but the newer way is recommended.</p>
</div>
</div>
<div id="exm-stats-numpy-uniform" class="theorem example" data-chapter="2" type="💻" data-description="Uniform random numbers in NumPy">
<p><span class="theorem-title"><strong>Example 2.17</strong></span> We start by creating an RNG with a specific state. Every time this code is run, the same sequence of numbers will be generated from it.</p>
<div id="37c179cc" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> default_rng</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> default_rng(<span class="dv">19716</span>)    <span class="co"># setting an initial state</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>uniform</code> generator method produces numbers distributed uniformly between two limits you specify.</p>
<div id="0ab218bd" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>rng.uniform( <span class="dv">0</span>, <span class="dv">1</span>, size<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>array([0.97584377, 0.65769739, 0.167421  , 0.7146286 , 0.98038127])</code></pre>
</div>
</div>
<p>For a large uniform random sample, the ECDF will approximate the CDF in <a href="#fig-stats-cdf-c" class="quarto-xref">Figure&nbsp;<span>2.3</span></a>.</p>
<div id="b79a3387" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.uniform( size<span class="op">=</span><span class="dv">10000</span> )</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sns.displot(x, kind<span class="op">=</span><span class="st">"ecdf"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-24-output-1.png" width="469" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Similarly, a histogram of the sample will approximate a plot of the PDF in <a href="#eq-stats-uniform-pdf" class="quarto-xref">Equation&nbsp;<span>2.10</span></a>:</p>
<div id="411d2805" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>sns.displot(x, bins<span class="op">=</span><span class="dv">16</span>, stat<span class="op">=</span><span class="st">"density"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-25-output-1.png" width="469" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_idm34uwa&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_zo16ot10" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.17" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
<p><br> <a href="_media/memes/cat-distributon.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="_media/memes/cat-distributon.jpg" class="img-fluid quarto-figure quarto-figure-center" width="200"></a></p>
</div></div></section>
<section id="normal-distribution" class="level3 page-columns page-full" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="normal-distribution"><span class="header-section-number">2.3.4</span> Normal distribution</h3>
<p>Next to the uniform distribution, the following is the most important continuous distribution to know.</p>
<div id="def-stats-normal" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.10</strong></span> The <strong>normal distribution</strong> or <em>Gaussian distribution</em> with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span> is defined by the PDF</p>
<p><span id="eq-stats-normal"><span class="math display">\[
f(t) = \frac{1}{\sigma \sqrt{2\pi}} e^{ -(t - \mu)^2/(2\sigma^2)}.
\tag{2.12}\]</span></span></p>
<p>The <strong>standard normal</strong> distribution uses <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma=1\)</span>.</p>
</div>
<p>For data that are distributed normally, about 68% of the values lie within one standard deviation of the mean, and 95% lie within two standard deviations. Note however that all real values of <span class="math inline">\(t\)</span> are theoretically possible.</p>
<p>One appealing fact about the normal distribution is that the effects of scaling and shifting the variable are simple:</p>
<div id="thm-stats-normal" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.3</strong></span> If the variable <span class="math inline">\(s\)</span> has a standard normal distribution, then the variable <span class="math inline">\(t = \sigma s + \mu\)</span> has a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_aclhtcjr&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_xhmhxyac" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Normal distribution" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="_media/memes/cant-be-normal.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="_media/memes/cant-be-normal.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="200"></a></p>
</figure>
</div>
</div></div><div id="exm-stats-normal" class="theorem example" data-chapter="2" type="💻" data-description="Normal distribution in NumPy">
<p><span class="theorem-title"><strong>Example 2.18</strong></span> The <code>normal</code> method of a NumPy RNG simulates a standard normal distribution.</p>
<div id="33e96467" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> default_rng(<span class="dv">19716</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.normal( size<span class="op">=</span>(<span class="dv">30000</span>,) )</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>sns.displot(x, bins<span class="op">=</span><span class="dv">25</span>, stat<span class="op">=</span><span class="st">"density"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-26-output-1.png" width="469" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can change the variance by multiplying by <span class="math inline">\(\sigma\)</span> and change the mean by adding <span class="math inline">\(\mu\)</span>:</p>
<div id="c1391b9e" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame( {<span class="st">"x"</span>: x, <span class="st">"3x-10"</span>: <span class="dv">3</span><span class="op">*</span>x<span class="op">-</span><span class="dv">10</span>} )</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">3x-10</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">count</td>
<td>30000.000000</td>
<td>30000.000000</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">mean</td>
<td>-0.000175</td>
<td>-10.000526</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">std</td>
<td>1.001663</td>
<td>3.004990</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">min</td>
<td>-3.520333</td>
<td>-20.560998</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">25%</td>
<td>-0.671223</td>
<td>-12.013670</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">50%</td>
<td>0.001121</td>
<td>-9.996636</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">75%</td>
<td>0.672540</td>
<td>-7.982381</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">max</td>
<td>4.044099</td>
<td>2.132297</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>A KDE plot shows us a result close to the classic bell curve:</p>
<div id="ff496c7c" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">"3x-10"</span>, kind<span class="op">=</span><span class="st">"kde"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-28-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="grouping-data" class="level2 page-columns page-full" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="grouping-data"><span class="header-section-number">2.4</span> Grouping data</h2>
<p>It’s often useful to analyze data in groups defined by one or more columns. Grouping data is tied to the idea of <strong>conditional probability</strong>.</p>
<div id="exm-stats-groups" class="theorem example" data-chapter="2" type="💻" data-description="Grouping data">
<p><span class="theorem-title"><strong>Example 2.19</strong></span> This is a dataset about the fuel efficiency of some cars:</p>
<div id="eb95a0f2" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cars <span class="op">=</span> sns.load_dataset(<span class="st">"mpg"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>cars.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">model_year</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">name</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>18.0</td>
<td>8</td>
<td>307.0</td>
<td>130.0</td>
<td>3504</td>
<td>12.0</td>
<td>70</td>
<td>usa</td>
<td>chevrolet chevelle malibu</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>15.0</td>
<td>8</td>
<td>350.0</td>
<td>165.0</td>
<td>3693</td>
<td>11.5</td>
<td>70</td>
<td>usa</td>
<td>buick skylark 320</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>18.0</td>
<td>8</td>
<td>318.0</td>
<td>150.0</td>
<td>3436</td>
<td>11.0</td>
<td>70</td>
<td>usa</td>
<td>plymouth satellite</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>16.0</td>
<td>8</td>
<td>304.0</td>
<td>150.0</td>
<td>3433</td>
<td>12.0</td>
<td>70</td>
<td>usa</td>
<td>amc rebel sst</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>17.0</td>
<td>8</td>
<td>302.0</td>
<td>140.0</td>
<td>3449</td>
<td>10.5</td>
<td>70</td>
<td>usa</td>
<td>ford torino</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here’s the distribution of the <em>mpg</em> variable in <code>cars</code> over the entire dataset:</p>
<div id="38713773" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"mpg"</span>, bins<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-30-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here is the probability that a randomly chosen car has <em>mpg</em> less than 20:</p>
<div id="7a04b9c6" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>(cars[<span class="st">"mpg"</span>] <span class="op">&lt;</span> <span class="dv">20</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>0.3793969849246231</code></pre>
</div>
</div>
<p>Now, note that one of the columns of the dataset indicates the place of manufacture:</p>
<div id="9b22e640" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>cars[<span class="st">"origin"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>origin
usa       249
japan      79
europe     70
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>Intuitively, it seems likely that the distribution of <em>mpg</em> will differ for different countries of origin. For example, if we narrow our focus to cars made in the U.S.A., we get a very different result for the probability of <em>mpg</em> less than 20:</p>
<div id="f690547b" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>(cars.loc[cars[<span class="st">"origin"</span>]<span class="op">==</span><span class="st">"usa"</span>, <span class="st">"mpg"</span>] <span class="op">&lt;</span> <span class="dv">20</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>0.570281124497992</code></pre>
</div>
</div>
<p>There is no need to pattern your code after this example, as we will see more convenient ways to do this sort of computation in <a href="#sec-stats-groupby" class="quarto-xref"><span>Section 2.4.2</span></a>.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_knofje34&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_csdtudbz" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.19" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><section id="facet-box-and-violin-plots" class="level3 page-columns page-full" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="facet-box-and-violin-plots"><span class="header-section-number">2.4.1</span> Facet, box, and violin plots</h3>
<p>In a <strong>facet plot</strong>, a distribution plot is repeated across columns or rows for each group, making it easy to compare the groups visually.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>In these examples we sometimes use <code>height</code> or <code>width</code> keywords to specify the size of the plots (in inches) for this output format. You should start without them and use them only as needed.</p>
</div>
</div>
<div id="exm-stats-groups-facet" class="theorem example" data-chapter="2" type="💻" data-description="Facet plots">
<p><span class="theorem-title"><strong>Example 2.20</strong></span> A facet plot allows us to easily group data by a categorical variable. In this case, we select the <em>origin</em> column using the <code>col</code> keyword:</p>
<div id="6bdcda3e" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"mpg"</span>, col<span class="op">=</span><span class="st">"origin"</span>, height<span class="op">=</span><span class="fl">2.2</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-34-output-1.png" width="623" height="199" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A key feature of the facet plots is that the <span class="math inline">\(x\)</span> axis limits are the same in all three cases, facilitating a direct visual comparison.</p>
</div>
<p>Other ways to visualize grouped data are offered by the <code>catplot</code> function in seaborn, including the well-known <strong>box plot</strong> and <strong>violin plot</strong>.</p>
<div id="exm-stats-groups-box-violin" class="theorem example" data-chapter="2" type="💻" data-description="Box and violin plots">
<p><span class="theorem-title"><strong>Example 2.21</strong></span> Here is a grouped <strong>box plot</strong> for <em>mpg</em>:</p>
<div id="2aa50931" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"origin"</span>, y<span class="op">=</span><span class="st">"mpg"</span>, kind<span class="op">=</span><span class="st">"box"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-35-output-1.png" width="486" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Each colored box shows the interquartile range, with the interior horizontal line showing the median. The whiskers and dots are explained in a later section. A related visualization is a <strong>violin plot</strong>:</p>
<div id="5468adbb" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>cars, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"mpg"</span>, y<span class="op">=</span><span class="st">"origin"</span>, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"violin"</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-36-output-1.png" width="485" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In a violin plot, the inner lines show the same information as the box plot, with the thick part showing the IQR, while the sides of the “violins” are KDE estimates of the density functions.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_4stcfpp7&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_6tx09vnr" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.21" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="sec-stats-groupby" class="level3 page-columns page-full" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="sec-stats-groupby"><span class="header-section-number">2.4.2</span> Grouped operations in pandas</h3>
<p>In pandas, the <code>groupby</code> method splits a data frame into groups based on values in a designated (categorical) column. By itself, this method doesn’t accomplish much, but it’s a prelude to operating in a groupwise (i.e., conditional) manner.</p>
<section id="aggregation" class="level4 page-columns page-full" data-number="2.4.2.1">
<h4 data-number="2.4.2.1" class="anchored" data-anchor-id="aggregation"><span class="header-section-number">2.4.2.1</span> Aggregation</h4>
<p>When you want to compute a summary statistic for each group, you need an <em>aggregator</em>. A list of the most common predefined aggregation functions is given in <a href="#tbl-stats-agg" class="quarto-xref">Table&nbsp;<span>2.1</span></a>.</p>
<div id="tbl-stats-agg" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-stats-agg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.1: Aggregation functions. All ignore <code>NaN</code> values.
</figcaption>
<div aria-describedby="tbl-stats-agg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top">
<thead>
<tr>
<th>method</th>
<th>effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>count</code></td>
<td>Number of values in each group</td>
</tr>
<tr>
<td><code>mean</code></td>
<td>Mean value in each group</td>
</tr>
<tr>
<td><code>sum</code></td>
<td>Sum within each group</td>
</tr>
<tr>
<td><code>std</code>, <code>var</code></td>
<td>Standard deviation/variance within groups</td>
</tr>
<tr>
<td><code>min</code>, <code>max</code></td>
<td>Min or max within groups</td>
</tr>
<tr>
<td><code>describe</code></td>
<td>Descriptive statistics</td>
</tr>
<tr>
<td><code>first</code>, <code>last</code></td>
<td>First or last of group values</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="exm-stats-groups-aggregation" class="theorem example" data-chapter="2" type="💻" data-description="Aggregating data in groups">
<p><span class="theorem-title"><strong>Example 2.22</strong></span> Here is how we can define groups based on the categorical <em>origin</em> column:</p>
<div id="30cb24f8" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>cars.groupby(<span class="st">"origin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x12f693380&gt;</code></pre>
</div>
</div>
<p>As you can see from the output above, a grouped data frame isn’t of much value on its own. But let’s use it to find the groupwise mean of each quantitative column in the frame:</p>
<div id="b1ccfe4d" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>cars.groupby(<span class="st">"origin"</span>).mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">model_year</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">europe</td>
<td>27.891429</td>
<td>4.157143</td>
<td>109.142857</td>
<td>80.558824</td>
<td>2423.300000</td>
<td>16.787143</td>
<td>75.814286</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">japan</td>
<td>30.450633</td>
<td>4.101266</td>
<td>102.708861</td>
<td>79.835443</td>
<td>2221.227848</td>
<td>16.172152</td>
<td>77.443038</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">usa</td>
<td>20.083534</td>
<td>6.248996</td>
<td>245.901606</td>
<td>119.048980</td>
<td>3361.931727</td>
<td>15.033735</td>
<td>75.610442</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Multiply dotted commands are common in pandas. You need to parse them from left to right. The first command above groups the data frame, and the second computes the mean within each group.</p>
<p>If we want to focus on just <em>mpg</em> from the dataset, we can extract that column <em>after</em> the grouping but <em>before</em> operating on the groups:</p>
<div id="a469a5dc" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>cars.groupby(<span class="st">"origin"</span>)[<span class="st">"mpg"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>origin
europe    27.891429
japan     30.450633
usa       20.083534
Name: mpg, dtype: float64</code></pre>
</div>
</div>
<p>To help interpret this expression, we could break it into equivalent separate steps:</p>
<div id="b7e25306" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>by_origin <span class="op">=</span> cars.groupby(<span class="st">"origin"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>mpg_by_origin <span class="op">=</span> by_origin[<span class="st">"mpg"</span>]</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>mpg_by_origin.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>origin
europe    27.891429
japan     30.450633
usa       20.083534
Name: mpg, dtype: float64</code></pre>
</div>
</div>
<p>However, the one-liner is considered better style most of the time.</p>
<p>If you want an aggregator other than those in <a href="#tbl-stats-agg" class="quarto-xref">Table&nbsp;<span>2.1</span></a>, you can call <code>agg</code> with your own function. Here are the conditional probabilities of <em>mpg</em> being less than 20 for all values of <em>origin</em>:</p>
<div id="3e2e2084" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> less_than_20(x):</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">&lt;</span> <span class="dv">20</span>).mean()</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>cars.groupby(<span class="st">"origin"</span>)[<span class="st">"mpg"</span>].agg(less_than_20)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>origin
europe    0.085714
japan     0.037975
usa       0.570281
Name: mpg, dtype: float64</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_d0r09h5o&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_u8e4y4w5" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.22" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
<p><br> <a href="_media/memes/groupby.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="_media/memes/groupby.jpg" class="img-fluid quarto-figure quarto-figure-center" width="200"></a></p>
</div></div></section>
<section id="transformation" class="level4" data-number="2.4.2.2">
<h4 data-number="2.4.2.2" class="anchored" data-anchor-id="transformation"><span class="header-section-number">2.4.2.2</span> Transformation</h4>
<p>A <strong>transformation</strong> applies a function groupwise to a column, producing a column of the same length.</p>
<div id="exm-stats-groups-transformation" class="theorem example" data-chapter="2" type="💻" data-description="Transforming data in groups">
<p><span class="theorem-title"><strong>Example 2.23</strong></span> We can convert the <em>mpg</em> values to z-scores using the population mean and variance:</p>
<div id="73f146ca" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> standardize(x):</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">-</span> x.mean()) <span class="op">/</span> x.std()</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>cars[<span class="st">"mpg_z"</span>] <span class="op">=</span> standardize(cars[<span class="st">"mpg"</span>])</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"mpg_z"</span>, col<span class="op">=</span><span class="st">"origin"</span>, height<span class="op">=</span><span class="fl">2.3</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-42-output-1.png" width="652" height="208" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Above, each of the conditional distributions was shifted and scaled identically. But we might instead, want to standardize within groups separately, with each group using its own mean and standard deviation:</p>
<div id="8f03f385" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>by_origin <span class="op">=</span> cars.groupby(<span class="st">"origin"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>cars[<span class="st">"group_mpg_z"</span>] <span class="op">=</span> by_origin[<span class="st">"mpg"</span>].transform(standardize)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"group_mpg_z"</span>, col<span class="op">=</span><span class="st">"origin"</span>, height<span class="op">=</span><span class="fl">2.3</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-43-output-1.png" width="652" height="208" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now, each group distribution is centered at 0 and has a standard deviation of 1.</p>
</div>
</section>
</section>
<section id="grouping-by-a-quantitative-variable" class="level3 page-columns page-full" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="grouping-by-a-quantitative-variable"><span class="header-section-number">2.4.3</span> Grouping by a quantitative variable</h3>
<p>Grouping is easiest to think about as being conditioned on a categorical variable. But it can also be done on a quantitative variable by first binning it into intervals using <code>pd.cut</code>.</p>
<div id="exm-stats-groups-cuts" class="theorem example" data-chapter="2" type="💻" data-description="Grouping data by cuts">
<p><span class="theorem-title"><strong>Example 2.24</strong></span> Suppose we want to group cars by horsepower, which is quantitative. We can use <code>pd.cut</code> to create bins of width 40:</p>
<div id="a75830ca" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>cuts <span class="op">=</span> pd.cut(cars[<span class="st">"horsepower"</span>], <span class="bu">range</span>(<span class="dv">40</span>, <span class="dv">250</span>, <span class="dv">40</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>by_hp <span class="op">=</span> cars.groupby(cuts)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>by_hp[<span class="st">"mpg"</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>horsepower
(40, 80]      119
(80, 120]     171
(120, 160]     65
(160, 200]     27
(200, 240]     10
Name: mpg, dtype: int64</code></pre>
</div>
</div>
<p>The <code>count</code> method then gives the number of observations in each group.</p>
<p>We can also use the cuts to make, for example, a violin plot:</p>
<div id="b744de5a" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"mpg"</span>, y<span class="op">=</span>cuts, kind<span class="op">=</span><span class="st">"violin"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-45-output-1.png" width="485" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_uma3wh4j&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_j9x6hskn" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.24" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
</section>
<section id="outliers" class="level2 page-columns page-full" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="outliers"><span class="header-section-number">2.5</span> Outliers</h2>
<p>Informally, an <strong>outlier</strong> is a data value that is considered to be far from typical. In some applications, such as detecting earthquakes or cancer, outliers are the cases of real interest. But here we will treat them as unwelcome values that might result from equipment failure, confounding effects, mistyping a value, using an artificial extreme value to represent missing data, and so on. In such cases we want to minimize the effect of the outliers on the statistics.</p>
<p>It is well known, for instance, that the mean is more sensitive to outliers than the median is.</p>
<div id="exm-stats-median-mean" class="theorem example" data-chapter="2" type="✍️" data-description="Outliers for mean and median">
<p><span class="theorem-title"><strong>Example 2.25</strong></span> The values <span class="math inline">\(1,2,3,4,5\)</span> have a mean and median both equal to 3. If we change the largest value to be a lot larger, say <span class="math inline">\(1,2,3,4,1000\)</span>, then the mean changes to 202. But the median is still 3!</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_fdm9u5cu&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_bcetgsog" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.25" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
<p><br> <a href="_media/memes/outlier.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="_media/memes/outlier.jpg" class="img-fluid quarto-figure quarto-figure-center" width="200"></a></p>
</div></div><p>If you want to use a statistic like the mean that is vulnerable to outliers, it’s typical to remove such values early on. There are various ways of deciding what qualifies as an outlier, with no one-size recommendation for all applications.</p>
<section id="iqr" class="level3 page-columns page-full" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="iqr"><span class="header-section-number">2.5.1</span> IQR</h3>
<p>Let <span class="math inline">\(Q_{25}\)</span> and <span class="math inline">\(Q_{75}\)</span> be the first and third quartiles (i.e., 25% and 75% percentiles), and let <span class="math inline">\(I=Q_{75}-Q_{25}\)</span> be the interquartile range (IQR). Then <span class="math inline">\(x\)</span> is an outlier value if</p>
<p><span id="eq-stats-outlier-iqr"><span class="math display">\[
x &lt; Q_{25} - 1.5I \text{ or } x &gt; Q_{75} + 1.5I.
\tag{2.13}\]</span></span></p>
<p>In a box plot, the whiskers growing from a box show the extent of the non-outlier data, and the dots beyond the whiskers represent outliers.</p>
<div id="exm-stats-outlier-iqr" class="theorem example" data-chapter="2" type="💻" data-description="Interquartile range">
<p><span class="theorem-title"><strong>Example 2.26</strong></span> Let’s look at another data set, based on a functional MRI experiment:</p>
<div id="cd83b8b4" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>fmri <span class="op">=</span> sns.load_dataset(<span class="st">"fmri"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>fmri.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">subject</th>
<th data-quarto-table-cell-role="th">timepoint</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">signal</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>s13</td>
<td>18</td>
<td>stim</td>
<td>parietal</td>
<td>-0.017552</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>s5</td>
<td>14</td>
<td>stim</td>
<td>parietal</td>
<td>-0.080883</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>s12</td>
<td>18</td>
<td>stim</td>
<td>parietal</td>
<td>-0.081033</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>s11</td>
<td>18</td>
<td>stim</td>
<td>parietal</td>
<td>-0.046134</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>s10</td>
<td>18</td>
<td>stim</td>
<td>parietal</td>
<td>-0.037970</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We want to focus on the <em>signal</em> column, splitting according to the <em>event</em>.</p>
<div id="262c58ee" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>by_event <span class="op">=</span> fmri.groupby(<span class="st">"event"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>by_event[<span class="st">"signal"</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">cue</td>
<td>532.0</td>
<td>-0.006669</td>
<td>0.047752</td>
<td>-0.181241</td>
<td>-0.031122</td>
<td>-0.008871</td>
<td>0.015825</td>
<td>0.215735</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">stim</td>
<td>532.0</td>
<td>0.013748</td>
<td>0.123179</td>
<td>-0.255486</td>
<td>-0.062378</td>
<td>-0.022202</td>
<td>0.058143</td>
<td>0.564985</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here is a box plot of the signal for these groups.</p>
<div id="264b0964" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>fmri, x<span class="op">=</span><span class="st">"event"</span>, y<span class="op">=</span><span class="st">"signal"</span>, kind<span class="op">=</span><span class="st">"box"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-48-output-1.png" width="486" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The dots lying outside the whiskers in the plot can be considered outliers satisfying one of the inequalities in <a href="#eq-stats-outlier-iqr" class="quarto-xref">Equation&nbsp;<span>2.13</span></a>.</p>
<p>Let’s now remove the outliers. We start with a function that computes a Boolean-valued series for a given input. This function is applied as a <code>transform</code> to the data as grouped by <em>events</em>:</p>
<div id="cad9950d" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_outlier(x):</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    Q25, Q75 <span class="op">=</span> x.quantile([<span class="fl">.25</span>,<span class="fl">.75</span>])</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    I <span class="op">=</span> Q75 <span class="op">-</span> Q25</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">&lt;</span> Q25 <span class="op">-</span> <span class="fl">1.5</span><span class="op">*</span>I) <span class="op">|</span>  (x <span class="op">&gt;</span> Q75 <span class="op">+</span> <span class="fl">1.5</span><span class="op">*</span>I)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> by_event[<span class="st">"signal"</span>].transform(is_outlier)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>fmri.loc[outliers,<span class="st">"event"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>event
stim    40
cue     26
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>You can see above that there are 66 outliers. To negate the outlier indicator, we can use <code>~outs</code> as a row selector.</p>
<div id="6e1a0a22" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>cleaned <span class="op">=</span> fmri[<span class="op">~</span>outliers]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The median values are barely affected by the omission of the outliers:</p>
<div id="1df10350" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"medians with outliers:"</span> )</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( by_event[<span class="st">"signal"</span>].median() )</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"</span><span class="ch">\n</span><span class="st">medians without outliers:"</span> )</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( cleaned.groupby(<span class="st">"event"</span>)[<span class="st">"signal"</span>].median() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>medians with outliers:
event
cue    -0.008871
stim   -0.022202
Name: signal, dtype: float64

medians without outliers:
event
cue    -0.009006
stim   -0.028068
Name: signal, dtype: float64</code></pre>
</div>
</div>
<p>The means, though, show much greater change:</p>
<div id="bb022f25" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"means with outliers:"</span> )</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( by_event[<span class="st">"signal"</span>].mean() )</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"</span><span class="ch">\n</span><span class="st">means without outliers:"</span> )</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( cleaned.groupby(<span class="st">"event"</span>)[<span class="st">"signal"</span>].mean() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>means with outliers:
event
cue    -0.006669
stim    0.013748
Name: signal, dtype: float64

means without outliers:
event
cue    -0.008243
stim   -0.010245
Name: signal, dtype: float64</code></pre>
</div>
</div>
<p>For the <em>stim</em> case in particular, the mean value changes by almost 200%, including a sign change. (Relative to the standard deviation, it’s closer to a 20% change.)</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_op8fm8cw&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_2e45ik5q" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.26" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="mean-and-std" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="mean-and-std"><span class="header-section-number">2.5.2</span> Mean and STD</h3>
<p>In normal distributions, values more than twice the standard deviation <span class="math inline">\(\sigma\)</span> from the mean could be considered to be outliers; this would exclude 5% of the values, on average. A less aggressive criterion is to allow a distance of <span class="math inline">\(3\sigma\)</span>, which excludes only about 0.3% of the values. The IQR criterion above corresponds to about <span class="math inline">\(2.7\sigma\)</span> in the normal distribution case.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A criticism of classical statistics is that much of it is conditioned on the assumption of normal distributions. This assumption is often violated by real datasets; quantities that depend on normality should be used judiciously.</p>
</div>
</div>
<div id="exm-stats-outlier-std" class="theorem example" data-chapter="2" type="💻" data-description="Outliers">
<p><span class="theorem-title"><strong>Example 2.27</strong></span> The following plot shows the outlier cutoffs for 2000 samples from a normal distribution, using the criteria for 2σ (red), 3σ (blue), and 1.5 IQR (black).</p>
<div id="5b433d0c" class="cell" data-execution_count="53">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> default_rng</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>randn <span class="op">=</span> default_rng(<span class="dv">1</span>).normal </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.Series(randn(size<span class="op">=</span><span class="dv">2000</span>))</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>x,bins<span class="op">=</span><span class="dv">30</span>)<span class="op">;</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>m,s <span class="op">=</span> x.mean(),x.std()</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>plt.axvline(m<span class="op">-</span><span class="dv">2</span><span class="op">*</span>s,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>plt.axvline(m<span class="op">+</span><span class="dv">2</span><span class="op">*</span>s,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>plt.axvline(m<span class="op">-</span><span class="dv">3</span><span class="op">*</span>s,color<span class="op">=</span><span class="st">'b'</span>)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>plt.axvline(m<span class="op">+</span><span class="dv">3</span><span class="op">*</span>s,color<span class="op">=</span><span class="st">'b'</span>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>q1,q3 <span class="op">=</span> x.quantile([<span class="fl">.25</span>,<span class="fl">.75</span>])</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>plt.axvline(q3<span class="op">+</span><span class="fl">1.5</span><span class="op">*</span>(q3<span class="op">-</span>q1),color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>plt.axvline(q1<span class="op">-</span><span class="fl">1.5</span><span class="op">*</span>(q3<span class="op">-</span>q1),color<span class="op">=</span><span class="st">'k'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-53-output-1.png" width="469" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>For asymmetric distributions, or those with a heavy tail, these criteria might show greater differences.</p>
</div>
</section>
</section>
<section id="correlation" class="level2 page-columns page-full" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="correlation"><span class="header-section-number">2.6</span> Correlation</h2>
<p>There are often variables that we believe to be linked, either because one influences the other, or because both are influenced by some other factor. There are numerous ways to measure the extent of the relationship between variables. But it’s good practice to plot the data before jumping into the numbers.</p>
<section id="relational-plots" class="level3 page-columns page-full" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="relational-plots"><span class="header-section-number">2.6.1</span> Relational plots</h3>
<p>Thus far, we have used <code>displot</code>, or “distribution plot”, to make histograms, and <code>catplot</code>, or “categorical plot”, to make box and violin plots. The third major plot type in seaborn is <code>relplot</code>, or “relational plot”, to show the relationships between variables.</p>
<div id="exm-stats-relational" class="theorem example" data-chapter="2" type="💻" data-description="Relational plots">
<p><span class="theorem-title"><strong>Example 2.28</strong></span> By default, <code>relplot</code> makes a scatter plot of two different variables:</p>
<div id="9efb9238" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"model_year"</span>, y<span class="op">=</span><span class="st">"mpg"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-54-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Like in the other plot types, we can use hue (color) and marker size to indicate groups within the data:</p>
<div id="314774be" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>cars, </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"model_year"</span>, y<span class="op">=</span><span class="st">"mpg"</span>, hue<span class="op">=</span><span class="st">"origin"</span>, size<span class="op">=</span><span class="st">"weight"</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-55-output-1.png" width="560" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If we want to emphasize a trend rather than the individual data values, we can instead plot the average value at each <span class="math inline">\(x\)</span> with error bars:</p>
<div id="6dbdd72b" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>cars, </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"model_year"</span>, y<span class="op">=</span><span class="st">"mpg"</span>, kind<span class="op">=</span><span class="st">"line"</span>, errorbar<span class="op">=</span><span class="st">"sd"</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-56-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The error ribbon above is drawn at one standard deviation around the mean.</p>
<p>In order to see multiple pairwise scatter plots in one shot, we can use <code>pairplot</code> in seaborn:</p>
<div id="a195679c" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [ <span class="st">"mpg"</span>, <span class="st">"horsepower"</span>, <span class="st">"displacement"</span>, <span class="st">"origin"</span> ]</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>sns.pairplot(data<span class="op">=</span>cars[columns], hue<span class="op">=</span><span class="st">"origin"</span>, height<span class="op">=</span><span class="dv">2</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-57-output-1.png" width="669" height="568" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The panels along the diagonal show each quantitative variable’s PDF. The other panels show scatter plots putting one pair at a time of the variables on the coordinate axes.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_cc1w9kgr&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_rl0diku3" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.28" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="correlation-1" class="level3 page-columns page-full" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="correlation-1"><span class="header-section-number">2.6.2</span> Correlation</h3>
<div id="def-stats-covariance" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.11</strong></span> Suppose we have two series of observations, <span class="math inline">\([x_i]\)</span> and <span class="math inline">\([y_i]\)</span>, representing observations of random quantities <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> having means <span class="math inline">\(\mu_X\)</span> and <span class="math inline">\(\mu_Y\)</span>. Their <strong>covariance</strong> is defined as <span class="math display">\[
\Cov(X,Y) = \frac{1}{n} \sum_{i=1}^n (x_i-\mu_X)(y_i-\mu_Y).
\]</span></p>
</div>
<p>Note that the values <span class="math inline">\(x_i-\mu_X\)</span> and <span class="math inline">\(y_i-\mu_Y\)</span> are deviations from the means.</p>
<p>It follows from the definitions that</p>
<p><span class="math display">\[
\begin{split}
    \Cov(X,X) &amp;= \sigma_X^2, \\
    \Cov(Y,Y) &amp;= \sigma_Y^2.
\end{split}
\]</span></p>
<p>In words, self-covariance is simply variance.</p>
<p>Covariance is not easy to interpret. Its units are the products of the units of the two variables, and it is sensitive to rescaling the variables (e.g., grams versus kilograms).</p>
<p>We can remove the dependence on units and scale by applying the covariance to standardized scores for both variables, resulting in a measure called <strong>correlation</strong>. The following is the best-known measure of correlation.</p>
<div id="def-stats-pearson" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.12</strong></span> For the populations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, the <strong>Pearson correlation coefficient</strong> is <span id="eq-stats-pearson-pop"><span class="math display">\[
\begin{split}
    \rho(X,Y) &amp;= \frac{1}{n} \sum_{i=1}^n \left(\frac{x_i-\mu_X}{\sigma_X}\right)\left(\frac{y_i-\mu_Y}{\sigma_Y}\right) \\
    &amp; = \frac{\Cov(X,Y)}{\sigma_X\sigma_Y},
\end{split}
\tag{2.14}\]</span></span></p>
<p>where <span class="math inline">\(\sigma_X^2\)</span> and <span class="math inline">\(\sigma_Y^2\)</span> are the population variances of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>For samples from the two populations, we use <span id="eq-stats-pearson-samp"><span class="math display">\[
r_{xy} =  \frac{\sum_{i=1}^n (x_i-\bar{x}) (y_i-\bar{y})}{\sqrt{\sum_{i=1}^n (x_i-\bar{x})^2}\,\sqrt{\sum_{i=1}^n (y_i-\bar{y})^2}},
\tag{2.15}\]</span></span></p>
<p>where <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> are sample means.</p>
</div>
<p>Both <span class="math inline">\(\rho_{XY}\)</span> and <span class="math inline">\(r_{xy}\)</span> are between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>, with the endpoints indicating perfect correlation (inverse or direct).</p>
<p>An equivalent formula for the sampled case <span class="math inline">\(r_{xy}\)</span> is <span id="eq-stats-pearson-alt"><span class="math display">\[
r_{xy} =  \frac{1}{n-1} \sum_{i=1}^n \left(\frac{x_i-\bar{x}}{s_x}\right)\, \left(\frac{y_i-\bar{y}}{s_y}\right),
\tag{2.16}\]</span></span></p>
<p>where <span class="math inline">\(s_x^2\)</span> and <span class="math inline">\(s_y^2\)</span> are the (unbiased) sample variances of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<div id="exm-stats-pearson-cars" class="theorem example" data-chapter="2" type="💻" data-description="Pearson correlation coefficient">
<p><span class="theorem-title"><strong>Example 2.29</strong></span> We might reasonably expect horsepower and miles per gallon to be negatively correlated:</p>
<div id="a2d09d80" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"horsepower"</span>, y<span class="op">=</span><span class="st">"mpg"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-58-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Covariance allows us to quantify the relationship:</p>
<div id="c639c939" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>cars[ [<span class="st">"horsepower"</span>, <span class="st">"mpg"</span>] ].cov()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">mpg</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">horsepower</td>
<td>1481.569393</td>
<td>-233.857926</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">mpg</td>
<td>-233.857926</td>
<td>61.089611</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>But should these numbers considered big? The Pearson coefficient is more easily interpreted:</p>
<div id="62bb4326" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>cars[ [<span class="st">"horsepower"</span>, <span class="st">"mpg"</span>] ].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">mpg</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">horsepower</td>
<td>1.000000</td>
<td>-0.778427</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">mpg</td>
<td>-0.778427</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The value of about <span class="math inline">\(-0.79\)</span> suggests that knowing one of the values would allow us to predict the other one rather well using a best-fit straight line (more on that in a future chapter).</p>
<p>When you want to see correlations among many variables, the numbers can be overwhelming to look at:</p>
<div id="049cc15a" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>cars.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">model_year</th>
<th data-quarto-table-cell-role="th">mpg_z</th>
<th data-quarto-table-cell-role="th">group_mpg_z</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">mpg</td>
<td>1.000000</td>
<td>-0.775396</td>
<td>-0.804203</td>
<td>-0.778427</td>
<td>-0.831741</td>
<td>0.420289</td>
<td>0.579267</td>
<td>1.000000</td>
<td>0.816412</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">cylinders</td>
<td>-0.775396</td>
<td>1.000000</td>
<td>0.950721</td>
<td>0.842983</td>
<td>0.896017</td>
<td>-0.505419</td>
<td>-0.348746</td>
<td>-0.775396</td>
<td>-0.527214</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">displacement</td>
<td>-0.804203</td>
<td>0.950721</td>
<td>1.000000</td>
<td>0.897257</td>
<td>0.932824</td>
<td>-0.543684</td>
<td>-0.370164</td>
<td>-0.804203</td>
<td>-0.528723</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">horsepower</td>
<td>-0.778427</td>
<td>0.842983</td>
<td>0.897257</td>
<td>1.000000</td>
<td>0.864538</td>
<td>-0.689196</td>
<td>-0.416361</td>
<td>-0.778427</td>
<td>-0.609533</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">weight</td>
<td>-0.831741</td>
<td>0.896017</td>
<td>0.932824</td>
<td>0.864538</td>
<td>1.000000</td>
<td>-0.417457</td>
<td>-0.306564</td>
<td>-0.831741</td>
<td>-0.592236</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">acceleration</td>
<td>0.420289</td>
<td>-0.505419</td>
<td>-0.543684</td>
<td>-0.689196</td>
<td>-0.417457</td>
<td>1.000000</td>
<td>0.288137</td>
<td>0.420289</td>
<td>0.348266</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">model_year</td>
<td>0.579267</td>
<td>-0.348746</td>
<td>-0.370164</td>
<td>-0.416361</td>
<td>-0.306564</td>
<td>0.288137</td>
<td>1.000000</td>
<td>0.579267</td>
<td>0.596192</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">mpg_z</td>
<td>1.000000</td>
<td>-0.775396</td>
<td>-0.804203</td>
<td>-0.778427</td>
<td>-0.831741</td>
<td>0.420289</td>
<td>0.579267</td>
<td>1.000000</td>
<td>0.816412</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">group_mpg_z</td>
<td>0.816412</td>
<td>-0.527214</td>
<td>-0.528723</td>
<td>-0.609533</td>
<td>-0.592236</td>
<td>0.348266</td>
<td>0.596192</td>
<td>0.816412</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>It’s often helpful to visualize correlations using a heatmap:</p>
<div id="e61aa086" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use vmin and vmax to set the extreme values of the color scale</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cars.corr(numeric_only<span class="op">=</span><span class="va">True</span>), </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-62-output-1.png" width="630" height="493" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_5sm57hj4&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_6i3phm87" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.29" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>As is usual when dealing with means, the Pearson coefficient can be sensitive to outlier values.</p>
<div id="exm-stats-pearson-outlier" class="theorem example" data-chapter="2" type="💻" data-description="Outliers and the Pearson coefficient">
<p><span class="theorem-title"><strong>Example 2.30</strong></span> The Pearson coefficient of any variable with itself is 1:</p>
<div id="d675bb80" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.Series( <span class="bu">range</span>(<span class="dv">10</span>) )</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>x.corr(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>0.9999999999999999</code></pre>
</div>
</div>
<p>Now let’s correlate <code>x</code> with a series that differs in only one element, but by a lot:</p>
<div id="d7f95981" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x.copy()</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">4</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">1000</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>x.corr(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>0.06752159131392785</code></pre>
</div>
</div>
<p>The Pearson coefficient is overwhelmed by the extreme outlier.</p>
</div>
</section>
<section id="spearman-coefficient" class="level3 page-columns page-full" data-number="2.6.3">
<h3 data-number="2.6.3" class="anchored" data-anchor-id="spearman-coefficient"><span class="header-section-number">2.6.3</span> Spearman coefficient</h3>
<p>The Spearman coefficient is one way to lessen the impact of outliers when measuring correlation. The idea is that only the orderings of the values are used, not their magnitudes.</p>
<div id="def-stats-rank-series" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.13</strong></span> If <span class="math inline">\(x_1,\ldots,x_n\)</span> is a series of observations, let their sorted ordering be <span class="math display">\[
x_{s_1},x_{s_2},\ldots,x_{s_n}.
\]</span></p>
<p>Then <span class="math inline">\(s_1,s_2,\ldots,s_n\)</span> is the <strong>rank series</strong> of <span class="math inline">\(\bfx\)</span>.</p>
</div>
<div id="def-stats-spearman" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.14</strong></span> The <strong>Spearman coefficient</strong> of two series of equal length is the Pearson coefficient of their rank series.</p>
</div>
<div id="exm-stats-spearman-outlier" class="theorem example" data-chapter="2" type="💻" data-description="Spearman correlation coefficient">
<p><span class="theorem-title"><strong>Example 2.31</strong></span> Continuing with <a href="#exm-stats-pearson-outlier" class="quarto-xref">Example&nbsp;<span>2.30</span></a>, we can use <code>argsort</code> to find the rank series:</p>
<div id="492bafa1" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>ranks <span class="op">=</span> pd.DataFrame( {<span class="st">'x'</span>: x.argsort(), <span class="st">'y'</span>: y.argsort()} )</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>ranks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>4</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>3</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">5</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">6</td>
<td>6</td>
<td>6</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>7</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">8</td>
<td>8</td>
<td>8</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">9</td>
<td>9</td>
<td>9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The Pearson coefficient of the ranks is the Spearman coefficient of the original <code>x</code> and <code>y</code> series:</p>
<div id="91536a2e" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ranks.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>0.878788</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>0.878788</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Recall that <code>x</code> and <code>y</code> differ only in one element. The Spearman coefficient between them remains fairly close to one. Note that we don’t actually have to find the rank series manually:</p>
<div id="1b9a4586" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>x.corr(y, <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>0.8787878787878788</code></pre>
</div>
</div>
<p>As long as <code>y[4]</code> is negative, so that its rank is zero, it doesn’t matter what its particular value is:</p>
<div id="5e5ce3ef" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">4</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">1000000</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>x.corr(y,<span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>0.8787878787878788</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
(different data, same idea)<br>
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_xemkvgjk&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_ek4cibrt" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.31" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>The robustness of the Spearman coefficient makes in an interesting alternative to the Pearson coefficient when dealing with datasets that have outliers.</p>
</section>
<section id="categorical-correlation" class="level3" data-number="2.6.4">
<h3 data-number="2.6.4" class="anchored" data-anchor-id="categorical-correlation"><span class="header-section-number">2.6.4</span> Categorical correlation</h3>
<p>An ordinal variable, such as the days of the week, is often straightforward to quantify as integers. But a nominal variable poses a different challenge.</p>
<div id="exm-stats-catcorr" class="theorem example" data-chapter="2" type="💻" data-description="Categorical correlation">
<p><span class="theorem-title"><strong>Example 2.32</strong></span> Grouped histograms suggest an association between country of origin and MPG:</p>
<div id="df03973a" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, kind<span class="op">=</span><span class="st">"kde"</span>,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"mpg"</span>, hue<span class="op">=</span><span class="st">"origin"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-69-output-1.png" width="572" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>How can we quantify the association? The first step is to convert the <em>origin</em> column into dummy variables:</p>
<div id="ff7cf246" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>dum <span class="op">=</span> pd.get_dummies(cars, columns<span class="op">=</span>[<span class="st">"origin"</span>])</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>dum.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">model_year</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">mpg_z</th>
<th data-quarto-table-cell-role="th">group_mpg_z</th>
<th data-quarto-table-cell-role="th">origin_europe</th>
<th data-quarto-table-cell-role="th">origin_japan</th>
<th data-quarto-table-cell-role="th">origin_usa</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>18.0</td>
<td>8</td>
<td>307.0</td>
<td>130.0</td>
<td>3504</td>
<td>12.0</td>
<td>70</td>
<td>chevrolet chevelle malibu</td>
<td>-0.705551</td>
<td>-0.325405</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>15.0</td>
<td>8</td>
<td>350.0</td>
<td>165.0</td>
<td>3693</td>
<td>11.5</td>
<td>70</td>
<td>buick skylark 320</td>
<td>-1.089379</td>
<td>-0.793943</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>18.0</td>
<td>8</td>
<td>318.0</td>
<td>150.0</td>
<td>3436</td>
<td>11.0</td>
<td>70</td>
<td>plymouth satellite</td>
<td>-0.705551</td>
<td>-0.325405</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>16.0</td>
<td>8</td>
<td>304.0</td>
<td>150.0</td>
<td>3433</td>
<td>12.0</td>
<td>70</td>
<td>amc rebel sst</td>
<td>-0.961437</td>
<td>-0.637764</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>17.0</td>
<td>8</td>
<td>302.0</td>
<td>140.0</td>
<td>3449</td>
<td>10.5</td>
<td>70</td>
<td>ford torino</td>
<td>-0.833494</td>
<td>-0.481585</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The original <em>origin</em> column has been replaced by three binary indicator columns. Now we can look for correlations between them and <em>mpg</em>:</p>
<div id="1545eda5" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mpg"</span>,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"origin_europe"</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"origin_japan"</span>,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"origin_usa"</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>dum[columns].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">origin_europe</th>
<th data-quarto-table-cell-role="th">origin_japan</th>
<th data-quarto-table-cell-role="th">origin_usa</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">mpg</td>
<td>1.000000</td>
<td>0.259022</td>
<td>0.442174</td>
<td>-0.568192</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">origin_europe</td>
<td>0.259022</td>
<td>1.000000</td>
<td>-0.229895</td>
<td>-0.597198</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">origin_japan</td>
<td>0.442174</td>
<td>-0.229895</td>
<td>1.000000</td>
<td>-0.643317</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">origin_usa</td>
<td>-0.568192</td>
<td>-0.597198</td>
<td>-0.643317</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As you can see from the above, <code>europe</code> and <code>japan</code> are positively associated with <em>mpg</em>, while <code>usa</code> is inversely associated with <em>mpg</em>.</p>
</div>
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_lt0xli2d&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_6vg0qxus" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.32" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
<p>:::</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://imgs.xkcd.com/comics/correlation.png" class="img-fluid figure-img"></p>
<figcaption>xckd by <a href="https://xkcd.com/license.html">Randall Munroe</a></figcaption>
</figure>
</div>
</section>
</section>
<section id="cautionary-tales" class="level2 page-columns page-full" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="cautionary-tales"><span class="header-section-number">2.7</span> Cautionary tales</h2>
<p>Attaching theorem-supported numbers to real data feels precise and infallible. The theorems do what they say, of course—they’re theorems!—but our intuition can be a little too ready to attach significance to the numbers, causing misconceptions or mistakes. Proper visualizations can help us navigate these waters safely.</p>
<section id="the-datasaurus" class="level3 page-columns page-full" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="the-datasaurus"><span class="header-section-number">2.7.1</span> The Datasaurus</h3>
<p>The Datasaurus Dozen is a collection of datasets that highlights the perils of putting blind trust into summary statistics.</p>
<div id="exm-stats-datasaurus" class="theorem example" data-chapter="2" type="💻" data-description="The Datasaurus">
<p><span class="theorem-title"><strong>Example 2.33</strong></span> The Datasaurus is a set of 142 points making a handsome portrait:</p>
<div id="31777996" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>dozen <span class="op">=</span> pd.read_csv(<span class="st">"_datasets/DatasaurusDozen.tsv"</span>, delimiter<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>dozen[dozen[<span class="st">"dataset"</span>]<span class="op">==</span><span class="st">"dino"</span>], x<span class="op">=</span><span class="st">"x"</span>, y<span class="op">=</span><span class="st">"y"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-72-output-1.png" width="470" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>However, there are 12 other datasets that all have roughly the same mean and variance for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and the same correlations between them:</p>
<div id="98afe99a" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>by_set <span class="op">=</span> dozen.groupby(<span class="st">"dataset"</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>by_set.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">dataset</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">away</td>
<td>54.266100</td>
<td>47.834721</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">bullseye</td>
<td>54.268730</td>
<td>47.830823</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">circle</td>
<td>54.267320</td>
<td>47.837717</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">dino</td>
<td>54.263273</td>
<td>47.832253</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">dots</td>
<td>54.260303</td>
<td>47.839829</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">h_lines</td>
<td>54.261442</td>
<td>47.830252</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">high_lines</td>
<td>54.268805</td>
<td>47.835450</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">slant_down</td>
<td>54.267849</td>
<td>47.835896</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">slant_up</td>
<td>54.265882</td>
<td>47.831496</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">star</td>
<td>54.267341</td>
<td>47.839545</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">v_lines</td>
<td>54.269927</td>
<td>47.836988</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">wide_lines</td>
<td>54.266916</td>
<td>47.831602</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">x_shape</td>
<td>54.260150</td>
<td>47.839717</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e7ff8672" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>by_set.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">dataset</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">away</td>
<td>16.769825</td>
<td>26.939743</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">bullseye</td>
<td>16.769239</td>
<td>26.935727</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">circle</td>
<td>16.760013</td>
<td>26.930036</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">dino</td>
<td>16.765142</td>
<td>26.935403</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">dots</td>
<td>16.767735</td>
<td>26.930192</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">h_lines</td>
<td>16.765898</td>
<td>26.939876</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">high_lines</td>
<td>16.766704</td>
<td>26.939998</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">slant_down</td>
<td>16.766759</td>
<td>26.936105</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">slant_up</td>
<td>16.768853</td>
<td>26.938608</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">star</td>
<td>16.768959</td>
<td>26.930275</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">v_lines</td>
<td>16.769959</td>
<td>26.937684</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">wide_lines</td>
<td>16.770000</td>
<td>26.937902</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">x_shape</td>
<td>16.769958</td>
<td>26.930002</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="109b9906" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>by_set.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">dataset</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">away</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.064128</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.064128</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">bullseye</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068586</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068586</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">circle</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068343</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068343</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">dino</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.064472</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.064472</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">dots</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.060341</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.060341</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">h_lines</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.061715</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.061715</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">high_lines</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068504</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068504</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">slant_down</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068980</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068980</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">slant_up</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068609</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068609</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">star</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.062961</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.062961</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">v_lines</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.069446</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.069446</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">wide_lines</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.066575</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.066575</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">x_shape</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.065583</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">y</td>
<td>-0.065583</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>However, a plot reveals that these sets are, to put it mildly, quite distinct:</p>
<div id="0abd9f13" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>others <span class="op">=</span> dozen[ dozen[<span class="st">"dataset"</span>] <span class="op">!=</span> <span class="st">"dino"</span> ]</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>others,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"x"</span>, y<span class="op">=</span><span class="st">"y"</span>,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    col<span class="op">=</span><span class="st">"dataset"</span>, col_wrap<span class="op">=</span><span class="dv">3</span>, height<span class="op">=</span><span class="fl">2.2</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-76-output-1.png" width="623" height="832" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_kiug6i2v&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_uphqzzhe" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.33" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Always plot your data.</p>
</div>
</div>
<p>Always 👏 plot 👏 your 👏 data!</p>
</section>
<section id="correlation-vs.-dependence" class="level3" data-number="2.7.2">
<h3 data-number="2.7.2" class="anchored" data-anchor-id="correlation-vs.-dependence"><span class="header-section-number">2.7.2</span> Correlation vs.&nbsp;dependence</h3>
<p>In casual speech, you might expect two variables that are uncorrelated to be unrelated. But that is not at all how the mathematical definitions play out.</p>
<div id="exm-stats-correlation" class="theorem example" data-chapter="2" type="💻" data-description="Correlation vs. dependence">
<p><span class="theorem-title"><strong>Example 2.34</strong></span> For example, here are <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> variables that both depend on a hidden variable <span class="math inline">\(\theta\)</span>:</p>
<div id="14464094" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>np.pi,<span class="dv">50</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.Series(np.cos(theta))</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> pd.Series(np.sin(theta))</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>sns.relplot(x<span class="op">=</span>x, y<span class="op">=</span>y)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-77-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Neither informally nor mathematically would we say that <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are independent! For example, if <span class="math inline">\(y=0\)</span>, then there is only one possible value for <span class="math inline">\(x\)</span>. Yet the correlation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is zero:</p>
<div id="4c4537ed" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>x.corr(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>8.276095507101827e-18</code></pre>
</div>
</div>
<p>Correlation can only measure the extent of the relationship that is <em>linear</em>; <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> lying on a straight line means perfect correlation. In this case, every line you can draw that passes through <span class="math inline">\((0,0)\)</span> is essentially equally bad at representing the data, and correlation cannot express the relationship.</p>
</div>
</section>
<section id="sec-stats-simpson" class="level3 page-columns page-full" data-number="2.7.3">
<h3 data-number="2.7.3" class="anchored" data-anchor-id="sec-stats-simpson"><span class="header-section-number">2.7.3</span> Simpson’s paradox</h3>
<p>The penguin dataset contains a common paradox—or a counterintuitive phenomenon, at least.</p>
<div id="exm-stats-simpson" class="theorem example" data-chapter="2" type="💻" data-description="Simpson's paradox">
<p><span class="theorem-title"><strong>Example 2.35</strong></span> Two of the variables show a fairly strong negative correlation:</p>
<div id="644399ed" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="op">=</span> sns.load_dataset(<span class="st">"penguins"</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [ <span class="st">"body_mass_g"</span>, <span class="st">"bill_depth_mm"</span> ]</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>penguins[columns].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">body_mass_g</th>
<th data-quarto-table-cell-role="th">bill_depth_mm</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">body_mass_g</td>
<td>1.000000</td>
<td>-0.471916</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">bill_depth_mm</td>
<td>-0.471916</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>But something surprising happens if we compute correlations <em>after</em> grouping by species.</p>
<div id="5f96d39f" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>penguins.groupby(<span class="st">"species"</span>)[columns].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">body_mass_g</th>
<th data-quarto-table-cell-role="th">bill_depth_mm</th>
</tr>
<tr>
<th data-quarto-table-cell-role="th">species</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Adelie</td>
<td data-quarto-table-cell-role="th">body_mass_g</td>
<td>1.000000</td>
<td>0.576138</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">bill_depth_mm</td>
<td>0.576138</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Chinstrap</td>
<td data-quarto-table-cell-role="th">body_mass_g</td>
<td>1.000000</td>
<td>0.604498</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">bill_depth_mm</td>
<td>0.604498</td>
<td>1.000000</td>
</tr>
<tr>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Gentoo</td>
<td data-quarto-table-cell-role="th">body_mass_g</td>
<td>1.000000</td>
<td>0.719085</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">bill_depth_mm</td>
<td>0.719085</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Within each individual species, the correlation between the variables is strongly positive!</p>
<p>This is an example of <strong>Simpson’s paradox</strong>. The reason for it can be seen from a scatter plot:</p>
<div id="5fbb7a1d" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>penguins,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>columns[<span class="dv">0</span>], y<span class="op">=</span>columns[<span class="dv">1</span>], </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">"species"</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="stats_files/figure-html/cell-81-output-1.png" width="575" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Within each color, the positive association is clear. But what dominates the combination of all three species is the large difference between Gentoo and the others. Because the Gentoo are both larger and have shallower bills, the dominant relationship is negative.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_ocuuaffk&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_i0596m4u" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.35" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
<p><br> <a href="_media/memes/simpson.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="_media/memes/simpson.gif" class="img-fluid quarto-figure quarto-figure-center" width="200"></a></p>
</div></div><p>As often happens in statistics, the precise framing of the question can strongly affect its answer. This can lead to honest mistakes by the naive as well as outright deception by the unscrupulous.</p>
</section>
</section>
<section id="exercises" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="exercises">Exercises</h2>
<p>For these exercises, you may use computer help to work on a problem, but your submitted solution should be self-contained without reference to computer output (unless stated otherwise).</p>
<div id="exr-stats-summary" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.1</strong></span> (2.1) The following parts are about the sample set of <span class="math inline">\(n\)</span> values (<span class="math inline">\(n&gt;2\)</span>)</p>
<p><span class="math display">\[
0, 0, 0, \ldots, 0, 1000.
\]</span></p>
<p>(That is, there are <span class="math inline">\(n-1\)</span> copies of 0 and one copy of 1000.)</p>
<p><strong>(a)</strong> Show that the sample mean is <span class="math inline">\(1000/n\)</span>.</p>
<p><strong>(b)</strong> Find the sample median when <span class="math inline">\(n\)</span> is odd.</p>
<p><strong>(c)</strong> Show that the corrected sample variance <span class="math inline">\(s_{n-1}^2\)</span> is <span class="math inline">\(10^6/n\)</span>.</p>
<p><strong>(d)</strong> Find the sample z-scores of all the values.</p>
</div>
<div id="exr-stats-z-scores" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.2</strong></span> (2.1) Suppose given samples <span class="math inline">\(x_1,\ldots,x_n\)</span> have the sample z-scores <span class="math inline">\(z_1,\ldots,z_n\)</span>.</p>
<p><strong>(a)</strong> Show that <span class="math inline">\(\displaystyle \sum_{i=1}^n z_i = 0.\)</span> (Start by substituting the definition of <span class="math inline">\(z_i\)</span>, using a new index variable <span class="math inline">\(j\)</span> for that sum.)</p>
<p><strong>(b)</strong> Show that <span class="math inline">\(\displaystyle \sum_{i=1}^n z_i^2 = n-1.\)</span></p>
</div>
<div id="exr-stats-ellipse" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.3</strong></span> (2.1) Define 8 points on an ellipse by <span class="math inline">\(x_k=a\cos(\theta_k)\)</span> and <span class="math inline">\(y_k=b\sin(\theta_k)\)</span>, where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are positive and <span class="math display">\[
\theta_1= \frac{\pi}{4}, \theta_2 = \frac{\pi}{2}, \theta_3 = \frac{3\pi}{4}, \ldots, \theta_8 = 2\pi.
\]</span> Let <span class="math inline">\(u_1,\ldots,u_8\)</span> and <span class="math inline">\(v_1,\ldots,v_8\)</span> be the z-scores of the <span class="math inline">\(x_k\)</span> and the <span class="math inline">\(y_k\)</span>, respectively. Show that the points <span class="math inline">\((u_k,v_k)\)</span> all lie on a circle centered at the origin for all <span class="math inline">\(k=1,\ldots,8\)</span>. (By extension, standardizing points into z-scores is sometimes called <em>sphereing</em> them.)</p>
</div>
<div id="exr-stats-least-squares" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.4</strong></span> (2.1) Given a population of values <span class="math inline">\(x_1,x_2,\ldots,x_n\)</span>, define the function</p>
<p><span class="math display">\[
r_2(x) = \sum_{i=1}^n (x_i-x)^2.
\]</span></p>
<p>Show using calculus that <span class="math inline">\(r_2\)</span> is minimized at <span class="math inline">\(x=\mu\)</span>, the population mean. (The idea is that minimizing <span class="math inline">\(r_2\)</span> is a way to find the “most representative” value for the dataset.)</p>
</div>
<div id="exr-stats-least-mad" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.5</strong></span> (2.1) Suppose that <span class="math inline">\(n=2k+1\)</span> and a population has values <span class="math inline">\(x_1,x_2,\ldots,x_{n}\)</span> in sorted order, so that the median is equal to <span class="math inline">\(x_k\)</span>. Define the function</p>
<p><span class="math display">\[
r_1(x) = \sum_{i=1}^n |x_i - x|.
\]</span></p>
<p>(This function is called the <em>total absolute deviation</em> of <span class="math inline">\(x\)</span> from the population.) Show that <span class="math inline">\(r_1\)</span> has a global minimum at <span class="math inline">\(x=x_k\)</span> by way of the following steps.</p>
<p><strong>(a)</strong> Explain why the derivative of <span class="math inline">\(r_1\)</span> is undefined at every <span class="math inline">\(x_i\)</span>. Consequently, all of the <span class="math inline">\(x_i\)</span> are critical points of <span class="math inline">\(r_1\)</span>.</p>
<p><strong>(b)</strong> Determine <span class="math inline">\(r_1'\)</span> within each interval <span class="math inline">\((-\infty,x_1),\, (x_1,x_2),\, (x_2,x_3),\)</span> and so on. Explain why this shows that there cannot be any additional critical points to consider. (Note: you can replace the absolute values with a piecewise definition of <span class="math inline">\(r_1\)</span>, where the formula for the pieces changes as you cross over each <span class="math inline">\(x_i\)</span>.)</p>
<p><strong>(c)</strong> By considering the <span class="math inline">\(r_1'\)</span> values between the <span class="math inline">\(x_i\)</span>, explain why it must be that</p>
<p><span class="math display">\[
r_1(x_1) &gt; r_1(x_2) &gt; \cdots &gt; r_1(x_k) &lt; r_1(x_{k+1}) &lt; \cdots &lt; r_1(x_n).
\]</span></p>
</div>
<div id="exr-stats-empirical" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.6</strong></span> (2.2) This problem is about the dataset</p>
<p><span class="math display">\[
1, 3, 4, 5, 5, 6, 7, 8.
\]</span></p>
<p><strong>(a)</strong> Make a table of the values of the ECDF <span class="math inline">\(\hat{F}(t)\)</span> at the values <span class="math inline">\(t=0,1,2,\ldots,10\)</span>.</p>
<p><strong>(b)</strong> Carefully sketch the ECDF of the dataset over the interval <span class="math inline">\([0,10]\)</span>.</p>
<p><strong>(c)</strong> Make a table of counts <span class="math inline">\(c_k\)</span> for the bins <span class="math inline">\((0,2],(2,4],(4,6],(6,8],(8,10]\)</span>.</p>
<p><strong>(d)</strong> Sketch a histogram of the dataset using the bins from part (c).</p>
<p><strong>(e)</strong> Verify the equation <a href="#eq-stats-hist-ecdf" class="quarto-xref">Equation&nbsp;<span>2.6</span></a> for the bins from part (c).</p>
</div>
<div id="exr-stats-integrate-pdf" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.7</strong></span> (2.3) Suppose that a distribution has continuous PDF <span class="math inline">\(f(t)\)</span> and CDF <span class="math inline">\(F(t)\)</span>, and that <span class="math inline">\(F(a)=0\)</span> and <span class="math inline">\(F(b)=1\)</span>. Explain why</p>
<p><span class="math display">\[
\int_a^b f(t)\,dt = 1.
\]</span></p>
</div>
<div id="exr-stats-get-cdf" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.8</strong></span> (2.3) Suppose that a distribution has PDF</p>
<p><span class="math display">\[
f(t) = \begin{cases}
0, &amp; |t| &gt;  1, \\
\tfrac{1}{2}(1+t), &amp; |t| \le 1.
\end{cases}
\]</span></p>
<p>Find a formula for its CDF. (Hint: It’s a piecewise formula. First find it for <span class="math inline">\(t&lt; -1,\)</span> then for <span class="math inline">\(-1 \le t \le 1,\)</span> and finally for <span class="math inline">\(t&gt;1\)</span>.)</p>
</div>
<div id="exr-stats-normal-median" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.9</strong></span> (2.3) What is the median of the normal distribution whose PDF is given by <a href="#eq-stats-normal" class="quarto-xref">Equation&nbsp;<span>2.12</span></a>? The answer is probably intuitively clear, but you should make a mathematical argument (though it does not require difficult calculations). Note: there is no simple antiderivative formula for the PDF, and you do not need it anyway.</p>
</div>
<div id="exr-stats-outlier" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.10</strong></span> (2.5) This exercise is about the same set of sample values as <a href="#exr-stats-summary" class="quarto-xref">Exercise&nbsp;<span>2.1</span></a>. Suppose the 2σ-outlier criterion is applied using the sample mean and sample variance.</p>
<p><strong>(a)</strong> Show that regardless of <span class="math inline">\(n\)</span>, the value 0 is never an outlier.</p>
<p><strong>(b)</strong> Show that the value 1000 is an outlier if <span class="math inline">\(n \ge 6\)</span>.</p>
</div>
<div id="exr-stats-outlier-iqr" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.11</strong></span> (2.5) Define a population by</p>
<p><span class="math display">\[
x_i = \begin{cases}
1, &amp; 1 \le i \le 11, \\
2, &amp; 12 \le i \le 14,\\
4, &amp; 15 \le i \le 22, \\
6, &amp; 23 \le i \le 32.
\end{cases}
\]</span></p>
<p>(That is, there are 11 values of 1, 3 values of 2, 8 values of 4, and 10 values of 6.)</p>
<p><strong>(a)</strong> Find the median of the population.</p>
<p><strong>(b)</strong> Find the smallest interval containing all non-outlier values according to the 1.5 IQR criterion.</p>
</div>
<div id="exr-stats-pearson-z" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.12</strong></span> (2.6) Prove that two sample sets have a Pearson correlation coefficient equal to 1 if they have identical z-scores. (Hint: Use the results of <a href="#exr-stats-z-scores" class="quarto-xref">Exercise&nbsp;<span>2.2</span></a>.)</p>
</div>
<div id="exr-stats-pearson-anti" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.13</strong></span> (2.6) Suppose that two sample sets satisfy <span class="math inline">\(y_i=-x_i\)</span> for all <span class="math inline">\(i\)</span>. Prove that the Pearson correlation coefficient between the sets equals <span class="math inline">\(-1\)</span>.</p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data.html" class="pagination-link" aria-label="Representation of data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Representation of data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./classification.html" class="pagination-link" aria-label="Classification">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Classification</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Data Science 1
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Toby Driscoll
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","openEffect":"zoom","loop":false,"closeEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>