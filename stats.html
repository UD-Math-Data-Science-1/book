<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.339">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Science 1 - 2&nbsp; Descriptive statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./classification.html" rel="next">
<link href="./data.html" rel="prev">
<link href="./_media/logo_small.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<script> 
MathJax = {
  chtml: {
    scale: 0.92,
  }
}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stats.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="quarto-sidebar-header"><div class="sidebar-header-item">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_media/logo_small.png" height="120" class="figure-img"></p>
</figure>
</div>
</div></div>
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science 1</a> 
        <div class="sidebar-tools-main">
    <a href="./Data-Science-1.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./starting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genAI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generative AI</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Representation of data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Classification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model selection</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Networks</span></span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>Copyright (c) 2024 by <a href="https://tobydriscoll.net">Toby Driscoll</a></p>
</div></div></nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link active" data-scroll-target="#summary-statistics"><span class="header-section-number">2.1</span> Summary statistics</a>
  <ul class="collapse">
  <li><a href="#mean-and-spread" id="toc-mean-and-spread" class="nav-link" data-scroll-target="#mean-and-spread"><span class="header-section-number">2.1.1</span> Mean and spread</a></li>
  <li><a href="#z-scores" id="toc-z-scores" class="nav-link" data-scroll-target="#z-scores"><span class="header-section-number">2.1.2</span> z-scores</a></li>
  <li><a href="#populations-and-samples" id="toc-populations-and-samples" class="nav-link" data-scroll-target="#populations-and-samples"><span class="header-section-number">2.1.3</span> Populations and samples</a></li>
  <li><a href="#median-and-quantiles" id="toc-median-and-quantiles" class="nav-link" data-scroll-target="#median-and-quantiles"><span class="header-section-number">2.1.4</span> Median and quantiles</a></li>
  </ul></li>
  <li><a href="#distributions" id="toc-distributions" class="nav-link" data-scroll-target="#distributions"><span class="header-section-number">2.2</span> Distributions</a>
  <ul class="collapse">
  <li><a href="#cdf" id="toc-cdf" class="nav-link" data-scroll-target="#cdf"><span class="header-section-number">2.2.1</span> CDF</a></li>
  <li><a href="#random-numbers-in-python" id="toc-random-numbers-in-python" class="nav-link" data-scroll-target="#random-numbers-in-python"><span class="header-section-number">2.2.2</span> Random numbers in Python</a></li>
  <li><a href="#empirical-cdf" id="toc-empirical-cdf" class="nav-link" data-scroll-target="#empirical-cdf"><span class="header-section-number">2.2.3</span> Empirical CDF</a></li>
  <li><a href="#pdf" id="toc-pdf" class="nav-link" data-scroll-target="#pdf"><span class="header-section-number">2.2.4</span> PDF</a></li>
  <li><a href="#mean-and-variance" id="toc-mean-and-variance" class="nav-link" data-scroll-target="#mean-and-variance"><span class="header-section-number">2.2.5</span> Mean and variance</a></li>
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution"><span class="header-section-number">2.2.6</span> Normal distribution</a></li>
  </ul></li>
  <li><a href="#grouping-data" id="toc-grouping-data" class="nav-link" data-scroll-target="#grouping-data"><span class="header-section-number">2.3</span> Grouping data</a>
  <ul class="collapse">
  <li><a href="#facet-box-and-violin-plots" id="toc-facet-box-and-violin-plots" class="nav-link" data-scroll-target="#facet-box-and-violin-plots"><span class="header-section-number">2.3.1</span> Facet, box, and violin plots</a></li>
  <li><a href="#aggregation" id="toc-aggregation" class="nav-link" data-scroll-target="#aggregation"><span class="header-section-number">2.3.2</span> Aggregation</a></li>
  <li><a href="#transformation" id="toc-transformation" class="nav-link" data-scroll-target="#transformation"><span class="header-section-number">2.3.3</span> Transformation</a></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering"><span class="header-section-number">2.3.4</span> Filtering</a></li>
  </ul></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers"><span class="header-section-number">2.4</span> Outliers</a>
  <ul class="collapse">
  <li><a href="#iqr" id="toc-iqr" class="nav-link" data-scroll-target="#iqr"><span class="header-section-number">2.4.1</span> IQR</a></li>
  <li><a href="#mean-and-std" id="toc-mean-and-std" class="nav-link" data-scroll-target="#mean-and-std"><span class="header-section-number">2.4.2</span> Mean and STD</a></li>
  </ul></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">2.5</span> Correlation</a>
  <ul class="collapse">
  <li><a href="#relational-plots" id="toc-relational-plots" class="nav-link" data-scroll-target="#relational-plots"><span class="header-section-number">2.5.1</span> Relational plots</a></li>
  <li><a href="#covariance" id="toc-covariance" class="nav-link" data-scroll-target="#covariance"><span class="header-section-number">2.5.2</span> Covariance</a></li>
  <li><a href="#pearson-coefficient" id="toc-pearson-coefficient" class="nav-link" data-scroll-target="#pearson-coefficient"><span class="header-section-number">2.5.3</span> Pearson coefficient</a></li>
  <li><a href="#spearman-coefficient" id="toc-spearman-coefficient" class="nav-link" data-scroll-target="#spearman-coefficient"><span class="header-section-number">2.5.4</span> Spearman coefficient</a></li>
  <li><a href="#categorical-correlation" id="toc-categorical-correlation" class="nav-link" data-scroll-target="#categorical-correlation"><span class="header-section-number">2.5.5</span> Categorical correlation</a></li>
  </ul></li>
  <li><a href="#cautionary-tales" id="toc-cautionary-tales" class="nav-link" data-scroll-target="#cautionary-tales"><span class="header-section-number">2.6</span> Cautionary tales</a>
  <ul class="collapse">
  <li><a href="#the-datasaurus" id="toc-the-datasaurus" class="nav-link" data-scroll-target="#the-datasaurus"><span class="header-section-number">2.6.1</span> The Datasaurus</a></li>
  <li><a href="#correlation-vs.-dependence" id="toc-correlation-vs.-dependence" class="nav-link" data-scroll-target="#correlation-vs.-dependence"><span class="header-section-number">2.6.2</span> Correlation vs.&nbsp;dependence</a></li>
  <li><a href="#sec-stats-simpson" id="toc-sec-stats-simpson" class="nav-link" data-scroll-target="#sec-stats-simpson"><span class="header-section-number">2.6.3</span> Simpson’s paradox</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<div class="hidden">
<p><span class="math display">\[
    \newcommand{\float}{\mathbb{F}}
    \newcommand{\real}{\mathbb{R}}
    \newcommand{\complex}{\mathbb{C}}
    \newcommand{\nat}{\mathbb{N}}
    \newcommand{\integer}{\mathbb{Z}}
    \newcommand{\bfa}{\mathbf{a}}
    \newcommand{\bfe}{\mathbf{e}}
    \newcommand{\bfh}{\mathbf{h}}
    \newcommand{\bfp}{\mathbf{p}}
    \newcommand{\bfq}{\mathbf{q}}
    \newcommand{\bfu}{\mathbf{u}}
    \newcommand{\bfv}{\mathbf{v}}
    \newcommand{\bfw}{\mathbf{w}}
    \newcommand{\bfx}{\mathbf{x}}
    \newcommand{\bfy}{\mathbf{y}}
    \newcommand{\bfz}{\mathbf{z}}
    \newcommand{\bfA}{\mathbf{A}}
    \newcommand{\bfW}{\mathbf{W}}
    \newcommand{\bfX}{\mathbf{X}}
    \newcommand{\bfzero}{\boldsymbol{0}}
    \newcommand{\bfmu}{\boldsymbol{\mu}}
    \newcommand{\TP}{\text{TP}}
    \newcommand{\TN}{\text{TN}}
    \newcommand{\FP}{\text{FP}}
    \newcommand{\FN}{\text{FN}}
    \newcommand{\rmn}[2]{\mathbb{R}^{#1 \times #2}}
    \newcommand{\dd}[2]{\frac{d #1}{d #2}}
    \newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
    \newcommand{\norm}[1]{\left\lVert \mathstrut #1 \right\rVert}
    \newcommand{\abs}[1]{\left\lvert \mathstrut #1 \right\rvert}
    \newcommand{\twonorm}[1]{\norm{#1}_2}
    \newcommand{\onenorm}[1]{\norm{#1}_1}
    \newcommand{\infnorm}[1]{\norm{#1}_\infty}
    \newcommand{\innerprod}[2]{\langle #1,#2 \rangle}
    \newcommand{\pr}[1]{^{(#1)}}
    \newcommand{\diag}{\operatorname{diag}}
    \newcommand{\sign}{\operatorname{sign}}
    \newcommand{\dist}{\operatorname{dist}}
    \newcommand{\simil}{\operatorname{sim}}
    \newcommand{\ee}{\times 10^}
    \newcommand{\floor}[1]{\lfloor#1\rfloor}
    \newcommand{\argmin}{\operatorname{argmin}}
    \newcommand{\E}[1]{\operatorname{\mathbb{E}}\left[\mathstrut #1\right]}
    \newcommand{\Cov}{\operatorname{Cov}}
    \newcommand{\logit}{\operatorname{logit}}
\]</span></p>
</div>
<p>When confronted with a new dataset, it’s crucial to get a sense of its characteristics before attempting to draw conclusions or predictions from it.</p>
<p>One of the fastest ways to become familiar with a data set is to visualize it. Python has many graphics packages with different niches. The most widespread is <strong>Matplotlib</strong>, which is fairly low-level in the sense that you must explicitly specify most aspects of how the plots will look.</p>
<p>We will make extensive use of <strong>seaborn</strong>, which is built on top of Matplotlib. It’s meant to be used at a higher level, i.e., letting you describe what you want to see and making it look pretty good. (It is possible to customize seaborn plots using Matplotlib commands, but we won’t need much of that.)</p>
<div id="ed8856d8" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are three major plot types within seaborn:</p>
<dl>
<dt><code>displot</code></dt>
<dd>
How values of a single variable are distributed.
</dd>
<dt><code>catplot</code></dt>
<dd>
How categorical values are distributed within and across categories.
</dd>
<dt><code>relplot</code></dt>
<dd>
How values of two variables are related to each other.
</dd>
</dl>
<section id="summary-statistics" class="level2 page-columns page-full" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="summary-statistics"><span class="header-section-number">2.1</span> Summary statistics</h2>
<p>We will use data about car fuel efficiency for illustrations.</p>
<div id="cccf0ebe" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cars <span class="op">=</span> sns.load_dataset(<span class="st">"mpg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>describe</code> method of a data frame gives summary statistics for each column of quantitative data:</p>
<div id="c4a0e6ca" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>cars.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">model_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>398.000000</td>
<td>398.000000</td>
<td>398.000000</td>
<td>392.000000</td>
<td>398.000000</td>
<td>398.000000</td>
<td>398.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>23.514573</td>
<td>5.454774</td>
<td>193.425879</td>
<td>104.469388</td>
<td>2970.424623</td>
<td>15.568090</td>
<td>76.010050</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>7.815984</td>
<td>1.701004</td>
<td>104.269838</td>
<td>38.491160</td>
<td>846.841774</td>
<td>2.757689</td>
<td>3.697627</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>9.000000</td>
<td>3.000000</td>
<td>68.000000</td>
<td>46.000000</td>
<td>1613.000000</td>
<td>8.000000</td>
<td>70.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>17.500000</td>
<td>4.000000</td>
<td>104.250000</td>
<td>75.000000</td>
<td>2223.750000</td>
<td>13.825000</td>
<td>73.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>23.000000</td>
<td>4.000000</td>
<td>148.500000</td>
<td>93.500000</td>
<td>2803.500000</td>
<td>15.500000</td>
<td>76.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>29.000000</td>
<td>8.000000</td>
<td>262.000000</td>
<td>126.000000</td>
<td>3608.000000</td>
<td>17.175000</td>
<td>79.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>46.600000</td>
<td>8.000000</td>
<td>455.000000</td>
<td>230.000000</td>
<td>5140.000000</td>
<td>24.800000</td>
<td>82.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We now discuss the definitions and interpretations of these values.</p>
<section id="mean-and-spread" class="level3 page-columns page-full" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="mean-and-spread"><span class="header-section-number">2.1.1</span> Mean and spread</h3>
<p>You may already know the Big Three summary statistics:</p>
<div id="def-stats-meanvarstd" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.1 </strong></span>Given data values <span class="math inline">\(x_1,\ldots,x_n\)</span>, their <strong>mean</strong> is <span id="eq-stats-mean"><span class="math display">\[
\mu = \frac{1}{n}\sum_{i=1}^n x_i,
\tag{2.1}\]</span></span> their <strong>variance</strong> is <span id="eq-stats-var"><span class="math display">\[
\sigma^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \mu)^2,
\tag{2.2}\]</span></span> and their <strong>standard deviation</strong> (STD) is <span class="math inline">\(\sigma\)</span>, the square root of the variance.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_geff87ds&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_d2z5o00p" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 2.1.1" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>Mean is a measurement of central tendency. Variance and STD are measures of spread or <em>dispersion</em> in the data.</p>
<div id="exm-stats-maxvar" class="theorem example" data-chapter="2" type="✍️" data-description="Standard deviation by hand">
<p><span class="theorem-title"><strong>Example 2.1 </strong></span>Suppose that <span class="math inline">\(x_1=0\)</span>, <span class="math inline">\(x_2=t\)</span>, and <span class="math inline">\(x_3=-t\)</span>, where <span class="math inline">\(|t| \le 6\)</span>. What are the minimum and maximum possible values of the standard deviation?</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>The mean is <span class="math inline">\(\mu=0\)</span>, hence <span class="math display">\[
\sigma^2 = \frac{1}{3}\left[ 0^2 + t^2 + (-t)^2 \right] = \frac{2}{3} t^2.
\]</span> From this we conclude <span class="math display">\[
\sigma =  \sqrt{\tfrac{2}{3}} |t|.
\]</span> Given that <span class="math inline">\(0 \le |t| \le 6\)</span>, we see that the minimum value of <span class="math inline">\(\sigma\)</span> is 0 and the maximum is <span class="math inline">\(2\sqrt{6}\)</span>.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_o10wj99b&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_bfaq5nru" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.1" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variance is in units that are the square of the data, which can be harder to interpret than STD, which has units the same as the data values.</p>
</div>
</div>
</section>
<section id="z-scores" class="level3 page-columns page-full" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="z-scores"><span class="header-section-number">2.1.2</span> z-scores</h3>
<p>Given data values <span class="math inline">\(x_1,\ldots,x_n\)</span>, we can define related values known as <strong>standardized scores</strong> or <strong>z-scores</strong>:</p>
<p><span class="math display">\[
z_i = \frac{x_i-\mu}{\sigma}, \qquad i=1,\ldots,n.
\]</span></p>
<p>The z-scores have mean zero and standard deviation equal to 1; in physical terms, they are dimensionless. That is, the results don’t depend on the physical units chosen to express the data. Converting data into z-scores is referred to as <strong>standardization</strong>, and it helps make operations uniform across different datasets.</p>
<div id="thm-stats-zscores" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.1 </strong></span>The z-scores have mean equal to zero and variance equal to 1.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Direct calculations.</p>
</div>
<div id="exm-stats-zscores" class="theorem example" data-chapter="2" type="✍️, 💻" data-description="Z scores">
<p><span class="theorem-title"><strong>Example 2.2 </strong></span>Continuing with the values from <a href="#exm-stats-maxvar" class="quarto-xref">Example&nbsp;<span>2.1</span></a>, we assume without losing generality that <span class="math inline">\(t\ge 0\)</span>. (Otherwise, we can just swap <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span>.) Then we have the z-scores <span class="math display">\[
z_1 = \frac{0-0}{2t\sqrt{6}} = 0, \quad z_2 = \frac{t-0}{2t\sqrt{6}} = \frac{1}{2\sqrt{6}} \quad z_3 = \frac{-t-0}{2t\sqrt{6}} = \frac{-1}{2\sqrt{6}}.
\]</span> These are independent of <span class="math inline">\(t\)</span>, which just scales the original values.</p>
</div>
<div id="exm-stats-zscores-py" class="theorem example" data-chapter="2" type="💻" data-description="Z scores in Python">
<p><span class="theorem-title"><strong>Example 2.3 </strong></span>We can write a little function to compute z-scores in Python:</p>
<div id="43612e2d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> standardize(x):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">-</span> x.mean()) <span class="op">/</span> x.std()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>cars[<span class="st">"mpg_z"</span>] <span class="op">=</span> standardize( cars[<span class="st">"mpg"</span>] )</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>cars[ [<span class="st">"mpg"</span>, <span class="st">"mpg_z"</span>] ].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">mpg_z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>398.000000</td>
<td>3.980000e+02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>23.514573</td>
<td>1.071170e-16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>7.815984</td>
<td>1.000000e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>9.000000</td>
<td>-1.857037e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>17.500000</td>
<td>-7.695221e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>23.000000</td>
<td>-6.583596e-02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>29.000000</td>
<td>7.018217e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>46.600000</td>
<td>2.953617e+00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_xe53cr77&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_ujxp7si5" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.3" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since floating-point values are rounded off, it’s unlikely that a value derived from them that is meant to be zero will actually be exactly zero. Above, the mean value of about <span class="math inline">\(-10^{-15}\)</span> should be seen as reasonable for values that have been rounded off in the 15th digit or so.</p>
</div>
</div>
</section>
<section id="populations-and-samples" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="populations-and-samples"><span class="header-section-number">2.1.3</span> Populations and samples</h3>
<p>In statistics one refers to the <strong>population</strong> as the entire universe of available values. Thus, the ages of adult on Earth at some instant has a particular population mean and standard deviation. However, in order to estimate those values, we can only measure a <strong>sample</strong> of the population directly.</p>
<p>When <a href="#eq-stats-mean" class="quarto-xref">Equation&nbsp;<span>2.1</span></a> is used to compute the mean of a sample rather than a population, we change the notation a bit as a reminder: <span id="eq-stats-mean-sample"><span class="math display">\[
\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i.
\tag{2.3}\]</span></span></p>
<p>It can be proved that the sample mean is an accurate way to estimate the population mean, in the following precise sense. If, in a thought experiment, we could average <span class="math inline">\(\bar{x}\)</span> over all possible samples of size <span class="math inline">\(n\)</span>, the result would be exactly the population mean <span class="math inline">\(\mu\)</span>. That is, we say that <span class="math inline">\(\bar{x}\)</span> is an <strong>unbiased estimator</strong> for <span class="math inline">\(\mu\)</span>.</p>
<p>The sample mean in turn can be used within <a href="#eq-stats-var" class="quarto-xref">Equation&nbsp;<span>2.2</span></a> to compute <strong>sample variance</strong>: <span class="math display">\[
s_n^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2.
\]</span></p>
<p>However, sample variance is more subtle than the sample mean. If <span class="math inline">\(s_n^2\)</span> is averaged over all possible sample sets, we do <em>not</em> get the population variance <span class="math inline">\(\sigma^2\)</span>; hence, <span class="math inline">\(s_n^2\)</span> is called a <strong>biased estimator</strong> of the population variance.</p>
<p>An unbiased estimator for <span class="math inline">\(\sigma^2\)</span> is</p>
<p><span id="eq-stats-var-sample"><span class="math display">\[
s_{n-1}^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2.
\tag{2.4}\]</span></span></p>
<div id="exm-stats-sample" class="theorem example" data-chapter="2" type="✍️" data-description="Sample variance">
<p><span class="theorem-title"><strong>Example 2.4 </strong></span>The values [1, 4, 9, 16, 25] have mean <span class="math inline">\(\bar{x}=55/5 = 11\)</span>. The sample variance is</p>
<p><span class="math display">\[
\begin{split}
    s_n^2 &amp;= \frac{(1-11)^2+(4-11)^2+(9-11)^2+(16-11)^2+(25-11)^2}{5} \\
    &amp; = \frac{374}{5} = 74.8.
\end{split}
\]</span></p>
<p>By contrast, the unbiased estimate of population variance from this sample is</p>
<p><span class="math display">\[
s_{n-1}^2 = \frac{374}{4} = 93.5.
\]</span></p>
</div>
<p>As you can see from the formulas and the example, the sample variance is always too large as an estimator, but the difference vanishes as the sample size <span class="math inline">\(n\)</span> increases.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sources are not always clear about this terminology. Some use <em>sample variance</em> to mean <span class="math inline">\(s_{n-1}^2\)</span>, not <span class="math inline">\(s_n^2\)</span>, and many even omit the subscripts. You always have to check each source.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>NumPy computes the biased estimator of variance by default, while pandas computes the unbiased version. Whee! Fortunately, most datasets today have large enough <span class="math inline">\(n\)</span> to make the difference negligible.</p>
</div>
</div>
<p>For standard deviation, <em>neither</em> <span class="math inline">\(s_n\)</span> <em>nor</em> <span class="math inline">\(s_{n-1}\)</span> is an unbiased estimator of <span class="math inline">\(\sigma\)</span>. There is no simple correction that works for all distributions. Our practice is to use <span class="math inline">\(s_{n-1}\)</span>, which is what <code>std</code> computes in pandas. Thus, for instance, a <strong>sample z-score</strong> for <span class="math inline">\(x_i\)</span> is</p>
<p><span id="eq-stats-t-score"><span class="math display">\[
z_i = \frac{x_i-\bar{x}}{s_{n-1}}.
\tag{2.5}\]</span></span></p>
<!-- :::{.callout-important}
In statistics, @eq-stats-t-score is referred to as a *t-score*, and the term *sample z-score* is not common. In data science practice, however, the sample sizes are usually so large that the difference between z-scores and t-scores is rarely important. Most sources just use the term *z-score* indiscriminately.
::: -->
</section>
<section id="median-and-quantiles" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="median-and-quantiles"><span class="header-section-number">2.1.4</span> Median and quantiles</h3>
<p>Mean and variance are not the most relevant summary statistics for every dataset. There are important alternatives.</p>
<div id="def-stats-percentile" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.2 </strong></span>For any <span class="math inline">\(0 &lt; p &lt; 1\)</span>, the <span class="math inline">\(100p\)</span>-<strong>percentile</strong> or <strong>quantile</strong> is the value of <span class="math inline">\(x\)</span> such that <span class="math inline">\(p\)</span> is the probability of observing a population value less than or equal to <span class="math inline">\(x\)</span>.</p>
<p>The 50th percentile is known as the <strong>median</strong> of the population.</p>
</div>
<!-- In other words, percentiles are the inverse function of the CDF.  -->
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some sources reserve the term <em>quantile</em> for another meaning, but since pandas offers <code>quantile</code> to compute percentiles, we don’t draw a distinction.</p>
</div>
</div>
<p>The unbiased sample median of <span class="math inline">\(x_1,\ldots,x_n\)</span> can be computed by sorting the values into <span class="math inline">\(y_1,\ldots,y_n\)</span>. If <span class="math inline">\(n\)</span> is odd, then <span class="math inline">\(y_{(n+1)/2}\)</span> is the sample median; otherwise, the average of <span class="math inline">\(y_{n/2}\)</span> and <span class="math inline">\(y_{1+(n/2)}\)</span> is the sample median.</p>
<div id="exm-stats-median" class="theorem example" data-chapter="2" type="✍️" data-description="Median">
<p><span class="theorem-title"><strong>Example 2.5 </strong></span>If the sorted values are <span class="math inline">\(1,3,3,4,5,5,5\)</span>, then <span class="math inline">\(n=7\)</span> and the sample median is <span class="math inline">\(y_4=4\)</span>. If the sample values are <span class="math inline">\(1,3,3,4,5,5,5,9\)</span>, then <span class="math inline">\(n=8\)</span> and the sample median is <span class="math inline">\((4+5)/2=4.5\)</span>.</p>
</div>
<p>Computing unbiased sample estimates of percentiles other than the median is complicated, and we won’t go into the details. For large datasets, the sample values are good estimators in practice.</p>
<div id="exm-stats-quantiles" class="theorem example" data-chapter="2" type="💻" data-description="Quantiles">
<p><span class="theorem-title"><strong>Example 2.6 </strong></span>Here we find the 90th percentile of the <em>loan_amnt</em> variable in the <code>loans</code> dataset:</p>
<div id="9aceaa50" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>loans <span class="op">=</span> pd.read_csv(<span class="st">"_datasets/loan.csv"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> loans[<span class="st">"loan_amnt"</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>pct90 <span class="op">=</span> x.quantile(<span class="fl">0.9</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pct90)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>22000.0</code></pre>
</div>
</div>
<p>Equivalently, 90 percent of the values are no greater than that value:</p>
<div id="95791de8" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(x <span class="op">&lt;=</span> pct90) <span class="op">/</span> <span class="bu">len</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0.9008233250245486</code></pre>
</div>
</div>
<p>The 50th percentile is the same thing as the median:</p>
<div id="929cd8d0" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x.median())</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x.quantile(<span class="fl">0.50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10000.0
10000.0</code></pre>
</div>
</div>
</div>
<div id="def-stats-quartile" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.3 </strong></span>The 25th, 50th, and 75th percentiles are the first, second, and third <strong>quartiles</strong> of the distribution. The <strong>interquartile range</strong> (IQR) is the difference between the 75th percentile and the 25th percentile.</p>
</div>
<p>Sometimes the definition above is extended to the <em>zeroth quartile</em>, which is the minimum sample value, and the <em>fourth quartile</em>, which is the maximum sample value.</p>
<p>IQR is an indication of the spread of the values. For some distributions, the median and IQR might be a good substitute for the mean and standard deviation.</p>
<div id="exm-stats-describe" class="theorem example" data-chapter="2" type="💻" data-description="Quartiles and IQR">
<p><span class="theorem-title"><strong>Example 2.7 </strong></span>The dataframe <code>describe</code> method includes mean, standard deviation, and the quartiles:</p>
<div id="df1fbc15" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>count    39717.000000
mean     11219.443815
std       7456.670694
min        500.000000
25%       5500.000000
50%      10000.000000
75%      15000.000000
max      35000.000000
Name: loan_amnt, dtype: float64</code></pre>
</div>
</div>
<p>It’s easy to write a function to compute the IQR of a series:</p>
<div id="23d8a1bd" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> IQR(x):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    Q25, Q75 <span class="op">=</span> x.quantile( [<span class="fl">0.25</span>, <span class="fl">0.75</span>] )</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Q75 <span class="op">-</span> Q25 </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>IQR(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>9500.0</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="distributions" class="level2 page-columns page-full" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="distributions"><span class="header-section-number">2.2</span> Distributions</h2>
<p>Mean and STD, or median and IQR, attempt to summarize quantitative data with a couple of numbers. At the other extreme, we can express the distribution of all values precisely using a function.</p>
<section id="cdf" class="level3 page-columns page-full" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="cdf"><span class="header-section-number">2.2.1</span> CDF</h3>
<div id="def-stats-cdf" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.4 </strong></span>The <strong>cumulative distribution function</strong> (CDF) of a population is the function <span class="math display">\[
F(t) = \text{fraction of the population that is $\le t$},
\]</span> where <span class="math inline">\(t\)</span> ranges over all possible values.</p>
</div>
<p>Note that by its definition, <span class="math inline">\(F\)</span> ranges between 0 and 1 (inclusive) and is a nondecreasing function.</p>
<div id="exm-stats-uniform-discrete" class="theorem example" data-chapter="2" type="✍️" data-description="CDF of a uniform distribution">
<p><span class="theorem-title"><strong>Example 2.8 </strong></span>If a population is <span class="math inline">\(x_i=i\)</span> for <span class="math inline">\(i=1,\ldots,n\)</span>, then <span class="math inline">\(F(k)=k/n\)</span> at each <span class="math inline">\(k=1,\ldots,n\)</span>. We could, however, also regard <span class="math inline">\(F\)</span> as a function of a continuous variable <span class="math inline">\(t\)</span>, in which case <span class="math display">\[
F(t) = \frac{\lfloor t \rfloor}{n},
\]</span> where <span class="math inline">\(\lfloor\cdot\rfloor\)</span> is the <em>floor function</em> that rounds leftward to the nearest integer. This produces a step function that looks like stairs going up from 0 to 1.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_w41hr5us&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_ci20taew" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.8" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p><a href="#exm-stats-uniform-discrete" class="quarto-xref">Example&nbsp;<span>2.8</span></a> becomes interesting as a template for generalizing to infinite populations. If we take not <span class="math inline">\(x_i=i\)</span> but <span class="math inline">\(x_i=i/n\)</span> and then let <span class="math inline">\(n\to \infty\)</span>, then the graph of <span class="math inline">\(F\)</span> converges to <span id="eq-stats-uniform-cdf"><span class="math display">\[
F(t) = \begin{cases}
0, &amp; t &lt; 0, \\
t,&amp; 0 \le t \le 1, \\
1,&amp; t &gt; 1.
\end{cases}
\tag{2.6}\]</span></span> While it doesn’t make sense to think about a fraction of the number of values in the infinite case, we can interpret <span class="math inline">\(F(t)\)</span> as the *probability of observing a value less than or equal to the real number <span class="math inline">\(t\)</span>.</p>
<div id="def-stats-uniform-cdf" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.5 </strong></span>A <strong>uniform distribution</strong> gives an equal probability to every value. In particular, the uniform distribution over the interval <span class="math inline">\([0,1]\)</span> has the CDF given in <a href="#eq-stats-uniform-cdf" class="quarto-xref">Equation&nbsp;<span>2.6</span></a>.</p>
</div>
</section>
<section id="random-numbers-in-python" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="random-numbers-in-python"><span class="header-section-number">2.2.2</span> Random numbers in Python</h3>
<p>Generating truly random numbers on a computer is not simple. We rely on <em>pseudorandom</em> numbers, which are generated by deterministic functions called <strong>random number generators</strong> (RNGs) that have extremely long periods. One consequence is repeatability: by specifying the starting state of the RNG, you can get exactly the same pseudorandom sequence every time.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is an older way to use random numbers in NumPy than the one presented here. You’ll still find it on the web and in some books, but the newer way is recommended.</p>
</div>
</div>
<div id="exm-stats-numpy-uniform" class="theorem example" data-chapter="2" type="💻" data-description="Uniform random numbers in NumPy">
<p><span class="theorem-title"><strong>Example 2.9 </strong></span>We start by creating an RNG with a specific state. Every time this code is run, the same sequence of numbers will be generated from it.</p>
<div id="08cee7c5" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> default_rng</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> default_rng(<span class="dv">19716</span>)    <span class="co"># setting an initial state</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>uniform</code> generator method produces numbers distributed uniformly between two limits you specify.</p>
<div id="a087682c" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>( rng.uniform( <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span> ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9516875346510687
0.3153947867339544
-0.6651579991995873
0.42925720152795055
0.960762541480505</code></pre>
</div>
</div>
</div>
</section>
<section id="empirical-cdf" class="level3 page-columns page-full" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="empirical-cdf"><span class="header-section-number">2.2.3</span> Empirical CDF</h3>
<p>Given a sample of a population, we can always calculate the analog of a CDF from its values.</p>
<div id="def-stats-ecdf" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.6 </strong></span>The <strong>empirical cumulative distribution function</strong> or ECDF of a sample is the function <span class="math inline">\(\hat{F}\)</span> whose value at <span class="math inline">\(t\)</span> equals the proportion of the sample values that are less than or equal to <span class="math inline">\(t\)</span>.</p>
</div>
<div id="exm-stats-ecdf-uniform" class="theorem example" data-chapter="2" type="💻" data-description="Empirical CDF">
<p><span class="theorem-title"><strong>Example 2.10 </strong></span>Here is an experiment that producing the ECDF for a sample from the random number generator:</p>
<div id="5361e0d6" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> default_rng</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> default_rng(<span class="dv">19716</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.uniform( size<span class="op">=</span>(<span class="dv">100</span>,) )</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>sns.displot(x, kind<span class="op">=</span><span class="st">"ecdf"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-13-output-1.png" width="469" height="469"></p>
</div>
</div>
<p>If we take more samples, we expect to see a curve closer to the theoretical CDF, <span class="math inline">\(F(t)=t\)</span>:</p>
<div id="16f481e5" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.uniform( size<span class="op">=</span>(<span class="dv">4000</span>,) )</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sns.displot(x, kind<span class="op">=</span><span class="st">"ecdf"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-14-output-1.png" width="469" height="469"></p>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_ksxfliwz&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_z6swe1lg" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.10" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="pdf" class="level3 page-columns page-full" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="pdf"><span class="header-section-number">2.2.4</span> PDF</h3>
<p>By definition, we know that if <span class="math inline">\(a&lt;b\)</span>, <span class="math inline">\(\hat{F}(b) - \hat{F}(a)\)</span> is the number of observations in the half-open interval <span class="math inline">\((a,b]\)</span>. This leads into the next definition.</p>
<div id="def-stats-histogram" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.7 </strong></span>Select the ordered values <span class="math inline">\(t_1 &lt; t_2 &lt; \cdots &lt; t_m\)</span>, called <strong>edges</strong>, and define <strong>bins</strong> as the intervals <span class="math display">\[
B_k = (t_k,t_{k+1}], \qquad k=0,\ldots,m,
\]</span> where we adopt the convention that <span class="math inline">\(t_0=-\infty\)</span> and <span class="math inline">\(t_{m+1}=\infty\)</span>. Let <span class="math inline">\(c_k\)</span> be the number of data values in <span class="math inline">\(B_k\)</span>. Then a <strong>histogram</strong> relative to the bins is the list of <span class="math inline">\((B_0,c_0),\ldots,(B_m,c_m)\)</span>.</p>
</div>
<p>The default for a seaborn <code>displot</code> is to show a histogram.</p>
<div id="exm-stats-uniform-hist" class="theorem example" data-chapter="2" type="💻" data-description="Histogram of a uniform distribution">
<p><span class="theorem-title"><strong>Example 2.11 </strong></span>Continuing with the uniform distribution over <span class="math inline">\([0,1]\)</span>:</p>
<div id="5974a4e5" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.uniform( size<span class="op">=</span>(<span class="dv">1000</span>,) )</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>sns.displot(x)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-15-output-1.png" width="469" height="469"></p>
</div>
</div>
<p>We can choose the number of bins to use, or give a vector of their edges:</p>
<div id="d7a01aa5" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sns.displot(x, bins<span class="op">=</span><span class="dv">40</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-16-output-1.png" width="469" height="469"></p>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_zcbcjzcd&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_gz582maa" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.11" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p><img src="_media/memes/cat-distributon.jpg" class="img-fluid" style="width:60.0%"></p>
<p>Again something interesting happens in a limiting case. If we normalize the count in a bin by the length of that bin, we get <span id="eq-stats-pdf"><span class="math display">\[
\frac{c_k}{t_{k+1}-t_k} = \frac{\hat{F}(t_{k+1})-\hat{F}(t_k)}{t_{k+1}-t_k}.
\tag{2.7}\]</span></span> If we let the number of observations tend to infinity, then <span class="math inline">\(\hat{F}\)</span> will converge to <span class="math inline">\(F\)</span>, and if we also let the number of bins go to infinity, then the fraction in <a href="#eq-stats-pdf" class="quarto-xref">Equation&nbsp;<span>2.7</span></a> converges to <span class="math inline">\(F'(t_k)\)</span>.</p>
<div id="def-stats-pdf" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.8 </strong></span>The <strong>probability density function</strong> or PDF of a distribution is the derivative of the CDF.</p>
</div>
<div id="exm-stats-uniform-pdf" class="theorem example" data-chapter="2" type="💻" data-description="PDF of a uniform distribution">
<p><span class="theorem-title"><strong>Example 2.12 </strong></span>If we have many samples, then we can use a normalized histogram to give an approximation of the PDF:</p>
<div id="ac8d2056" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.uniform( size<span class="op">=</span>(<span class="dv">20000</span>,) )</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sns.displot(x, bins<span class="op">=</span><span class="dv">24</span>, stat<span class="op">=</span><span class="st">"density"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-17-output-1.png" width="469" height="469"></p>
</div>
</div>
<p>Alternatively, we can use process called <em>kernel density estimation</em> to plot a continuous estimate of the PDF:</p>
<div id="37104a73" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sns.displot(x, kind<span class="op">=</span><span class="st">"kde"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-18-output-1.png" width="469" height="469"></p>
</div>
</div>
<p>In this case we did not obtain a particularly good approximation of the true PDF. In part this is because kernel density estimation assumes that the PDF is continuous, but here it is 1 over <span class="math inline">\([0,1]\)</span> and jumps down to 0 elsewhere.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_3wdjax7z&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_pd3wko0x" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.12" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="mean-and-variance" class="level3 page-columns page-full" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="mean-and-variance"><span class="header-section-number">2.2.5</span> Mean and variance</h3>
<p>It’s possible to compute the mean and variance (thus STD) of a distribution from its PDF: <span class="math display">\[
\begin{split}
\mu &amp;= \int x f(x) \, dx \\
\sigma^2 &amp;= \int (x-\mu)^2 f(x) \, dx,
\end{split}
\]</span> where the integrals are taken over the domain of <span class="math inline">\(f\)</span>.</p>
<div id="exm-stats-uniform-mean" class="theorem example" data-chapter="2" type="✍️, 💻" data-description="Mean of a uniform distribution">
<p><span class="theorem-title"><strong>Example 2.13 </strong></span>The uniform distribution over <span class="math inline">\([0,1]\)</span> has <span class="math inline">\(f(x)=1\)</span> over that interval. Hence, <span class="math display">\[
\begin{split}
\mu &amp;= \int_0^1 x \, dx = \left[ \frac{1}{2} x^2\right]_0^1 = \frac{1}{2}, \\
\sigma^2 &amp;= \int_0^1 \left(x-\tfrac{1}{2}\right)^2 \, dx = \frac{1}{3} - \frac{1}{2} + \frac{1}{4} = \frac{1}{12}.
\end{split}
\]</span></p>
<p>Let’s check these results empirically:</p>
<div id="4ec0564d" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> default_rng</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> default_rng(<span class="dv">19716</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.uniform( size<span class="op">=</span>(<span class="dv">2000</span>,) )</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"µ = </span><span class="sc">{</span>np<span class="sc">.</span>mean(x)<span class="sc">:.5f}</span><span class="ss">, 12σ² = </span><span class="sc">{</span><span class="dv">12</span><span class="op">*</span>np<span class="sc">.</span>var(x)<span class="sc">:.5f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>µ = 0.50518, 12σ² = 1.00019</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_xym85fqe&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_e3k4sp4q" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.13" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="normal-distribution" class="level3 page-columns page-full" data-number="2.2.6">
<h3 data-number="2.2.6" class="anchored" data-anchor-id="normal-distribution"><span class="header-section-number">2.2.6</span> Normal distribution</h3>
<p>Next to perhaps the uniform distribution, the following is the most widely used distribution of a random variable.</p>
<div id="def-stats-normal" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.9 </strong></span>The <strong>normal distribution</strong> or <em>Gaussian distribution</em> with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span> is defined by the PDF <span id="eq-stats-normal"><span class="math display">\[
f(x) = \frac{1}{\sigma \sqrt{2\pi}} e^{ -(x-\mu)^2/(2\sigma^2)}.
\tag{2.8}\]</span></span> The <strong>standard normal</strong> distribution uses <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma=1\)</span>.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_68mq0j28&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_9o924icz" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 2.2.6" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>For data that are distributed normally, about 68% of the values lie within one standard deviation of the mean, and 95% lie within two standard deviations.</p>
<div id="exm-stats-normal" class="theorem example" data-chapter="2" type="💻" data-description="Normal distribution in NumPy">
<p><span class="theorem-title"><strong>Example 2.14 </strong></span>The <code>normal</code> method of a NumPy RNG simulates a standard normal distribution.</p>
<div id="6acebaf4" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> default_rng(<span class="dv">19716</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> rng.normal( size<span class="op">=</span>(<span class="dv">10000</span>,) )</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>sns.displot(x, bins<span class="op">=</span>np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">28</span>), stat<span class="op">=</span><span class="st">"probability"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-20-output-1.png" width="469" height="469"></p>
</div>
</div>
<p>We can change the variance by multiplying by <span class="math inline">\(\sigma\)</span> and change the mean by adding <span class="math inline">\(\mu\)</span>:</p>
<div id="08f00e0a" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame( {<span class="st">"x"</span>: x, <span class="st">"3x-10"</span>: <span class="dv">3</span><span class="op">*</span>x<span class="op">-</span><span class="dv">10</span>} )</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">3x-10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>10000.000000</td>
<td>10000.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>-0.012414</td>
<td>-10.037242</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.993568</td>
<td>2.980704</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-3.436924</td>
<td>-20.310773</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>-0.672352</td>
<td>-12.017056</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>-0.008374</td>
<td>-10.025122</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.659730</td>
<td>-8.020809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>4.044099</td>
<td>2.132297</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The KDE density estimator works pretty well for normally distributed data, except in the tails where there are few observations:</p>
<div id="02471bf6" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">"3x-10"</span>, kind<span class="op">=</span><span class="st">"kde"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-22-output-1.png" width="469" height="468"></p>
</div>
</div>
</div>
<p><img src="_media/memes/cant-be-normal.jpg" class="img-fluid" style="width:60.0%"></p>
</section>
</section>
<section id="grouping-data" class="level2 page-columns page-full" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="grouping-data"><span class="header-section-number">2.3</span> Grouping data</h2>
<p>Here is the distribution of the <em>mpg</em> variable in <code>cars</code> over the entire dataset:</p>
<div id="f1993b1e" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"mpg"</span>, bins<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-23-output-1.png" width="469" height="468"></p>
</div>
</div>
<p>It’s often useful to analyze the data in groups defined by categorical values or other criteria. For instance, does the distribution of the <em>mpg</em> variable look the same regardless of where the cars were made? Both seaborn and pandas make investigating this kind of question much more easily and efficiently than hand-written code can do.</p>
<section id="facet-box-and-violin-plots" class="level3 page-columns page-full" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="facet-box-and-violin-plots"><span class="header-section-number">2.3.1</span> Facet, box, and violin plots</h3>
<p>In a <strong>facet plot</strong>, a distribution plot is repeated across columns or rows for each group.</p>
<div id="exm-stats-groups-facet" class="theorem example" data-chapter="2" type="💻" data-description="Facet plots">
<p><span class="theorem-title"><strong>Example 2.15 </strong></span>Suppose we want to separate the <code>cars</code> data by the <em>origin</em> categorical column, which has 3 unique values:</p>
<div id="a50e5967" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cars[<span class="st">"origin"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>usa       249
japan      79
europe     70
Name: origin, dtype: int64</code></pre>
</div>
</div>
<p>We can tell seaborn to group by <em>origin</em> and apply different colors to each group using the <code>hue</code> keyword in a <code>displot</code>, or distribution plot:</p>
<div id="cc2b10c9" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"mpg"</span>, hue<span class="op">=</span><span class="st">"origin"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-25-output-1.png" width="572" height="468"></p>
</div>
</div>
<p>The above graph is a little hard to interpret because of the overlaps. We can instead plot the groups in separate columns in a facet plot:</p>
<div id="3658c649" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"mpg"</span>, col<span class="op">=</span><span class="st">"origin"</span>, height<span class="op">=</span><span class="fl">2.2</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-26-output-1.png" width="623" height="199"></p>
</div>
</div>
<p>From the facet plot it is clear that the U.S.A. cars are more clustered on the left (smaller MPG) than are the Japanese and European cars.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_oiy1q1d4&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_xoupeo8n" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.15" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>Other ways to visualize grouped data are offered by the <code>catplot</code> function in seaborn, including the well-known <strong>box plot</strong> and <strong>violin plot</strong>.</p>
<div id="exm-stats-groups-box-violin" class="theorem example" data-chapter="2" type="💻" data-description="Box and violin plots">
<p><span class="theorem-title"><strong>Example 2.16 </strong></span>Here is a grouped <strong>box plot</strong> for <em>mpg</em>:</p>
<div id="fbd7cddb" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>cars, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"origin"</span>, y<span class="op">=</span><span class="st">"mpg"</span>, kind<span class="op">=</span><span class="st">"box"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-27-output-1.png" width="469" height="468"></p>
</div>
</div>
<p>Each colored box shows the interquartile range, with the interior horizontal line showing the median. The whiskers and dots are explained in a later section. A related visualization is a <strong>violin plot</strong>:</p>
<div id="d76acb2a" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>cars, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"mpg"</span>, y<span class="op">=</span><span class="st">"origin"</span>, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"violin"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-28-output-1.png" width="469" height="468"></p>
</div>
</div>
<p>In a violin plot, the inner lines show the same information as the box plot, with the thick part showing the IQR, while the sides of the “violins” are KDE estimates of the density functions.</p>
<p>It’s also possible to make groups using a quantitative variable. The pandas <code>cut</code> method lets you define ranges that serve as bins:</p>
<div id="fd301a73" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>cuts <span class="op">=</span> pd.cut( </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    cars[<span class="st">"weight"</span>],         <span class="co"># series to cut by</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">range</span>(<span class="dv">1500</span>, <span class="dv">5800</span>, <span class="dv">1000</span>)    <span class="co"># bin edges</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>cars[<span class="st">"cuts"</span>] <span class="op">=</span> cuts</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>cars.head(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">model_year</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">mpg_z</th>
<th data-quarto-table-cell-role="th">cuts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>18.0</td>
<td>8</td>
<td>307.0</td>
<td>130.0</td>
<td>3504</td>
<td>12.0</td>
<td>70</td>
<td>usa</td>
<td>chevrolet chevelle malibu</td>
<td>-0.705551</td>
<td>(3500, 4500]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>15.0</td>
<td>8</td>
<td>350.0</td>
<td>165.0</td>
<td>3693</td>
<td>11.5</td>
<td>70</td>
<td>usa</td>
<td>buick skylark 320</td>
<td>-1.089379</td>
<td>(3500, 4500]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>18.0</td>
<td>8</td>
<td>318.0</td>
<td>150.0</td>
<td>3436</td>
<td>11.0</td>
<td>70</td>
<td>usa</td>
<td>plymouth satellite</td>
<td>-0.705551</td>
<td>(2500, 3500]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16.0</td>
<td>8</td>
<td>304.0</td>
<td>150.0</td>
<td>3433</td>
<td>12.0</td>
<td>70</td>
<td>usa</td>
<td>amc rebel sst</td>
<td>-0.961437</td>
<td>(2500, 3500]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>17.0</td>
<td>8</td>
<td>302.0</td>
<td>140.0</td>
<td>3449</td>
<td>10.5</td>
<td>70</td>
<td>usa</td>
<td>ford torino</td>
<td>-0.833494</td>
<td>(2500, 3500]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>15.0</td>
<td>8</td>
<td>429.0</td>
<td>198.0</td>
<td>4341</td>
<td>10.0</td>
<td>70</td>
<td>usa</td>
<td>ford galaxie 500</td>
<td>-1.089379</td>
<td>(3500, 4500]</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="41e3141d" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>cars, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"mpg"</span>, y<span class="op">=</span><span class="st">"cuts"</span>, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"violin"</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-30-output-1.png" width="470" height="468"></p>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_6r6e5426&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_mlmkmtz3" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.16" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="aggregation" class="level3 page-columns page-full" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="aggregation"><span class="header-section-number">2.3.2</span> Aggregation</h3>
<p>In pandas, the <code>groupby</code> method splits a data frame into groups based on values in a designated column. These groups can then be passed through <em>aggregators</em> that reduce each grouped column to a single value. A list of the most common predefined aggregation functions is given in <a href="#tbl-stats-agg" class="quarto-xref">Table&nbsp;<span>2.1</span></a>.</p>
<div id="tbl-stats-agg" class="anchored">
<table class="table">
<caption>Table&nbsp;2.1: Aggregation functions. All ignore <code>NaN</code> values.</caption>
<thead>
<tr class="header">
<th>method</th>
<th>effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>count</code></td>
<td>Number of values in each group</td>
</tr>
<tr class="even">
<td><code>mean</code></td>
<td>Mean value in each group</td>
</tr>
<tr class="odd">
<td><code>sum</code></td>
<td>Sum within each group</td>
</tr>
<tr class="even">
<td><code>std</code>, <code>var</code></td>
<td>Standard deviation/variance within groups</td>
</tr>
<tr class="odd">
<td><code>min</code>, <code>max</code></td>
<td>Min or max within groups</td>
</tr>
<tr class="even">
<td><code>describe</code></td>
<td>Descriptive statistics</td>
</tr>
<tr class="odd">
<td><code>first</code>, <code>last</code></td>
<td>First or last of group values</td>
</tr>
</tbody>
</table>
</div>
<div id="exm-stats-groups-aggregation" class="theorem example" data-chapter="2" type="💻" data-description="Aggregating data in groups">
<p><span class="theorem-title"><strong>Example 2.17 </strong></span>Here is how we can define groups based on the categorical <em>origin</em> column:</p>
<div id="cadfe0c9" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cars.groupby(<span class="st">"origin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x17fd04690&gt;</code></pre>
</div>
</div>
<p>As you can see from the output above, a grouped data frame isn’t of much value until you apply some operation to it. For instance, we can find the mean of each quantitative column:</p>
<div id="997881de" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>cars.groupby(<span class="st">"origin"</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">model_year</th>
<th data-quarto-table-cell-role="th">mpg_z</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">europe</td>
<td>27.891429</td>
<td>4.157143</td>
<td>109.142857</td>
<td>80.558824</td>
<td>2423.300000</td>
<td>16.787143</td>
<td>75.814286</td>
<td>0.559988</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">japan</td>
<td>30.450633</td>
<td>4.101266</td>
<td>102.708861</td>
<td>79.835443</td>
<td>2221.227848</td>
<td>16.172152</td>
<td>77.443038</td>
<td>0.887420</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">usa</td>
<td>20.083534</td>
<td>6.248996</td>
<td>245.901606</td>
<td>119.048980</td>
<td>3361.931727</td>
<td>15.033735</td>
<td>75.610442</td>
<td>-0.438977</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The result is a frame indexed by <em>origin</em> and whose columns contain the group means. If we want to focus on just <em>mpg</em> from the dataset, we can extract that column <em>after</em> the grouping (which needs to know <em>origin</em>) but <em>before</em> operating on the groups:</p>
<div id="d5000b2b" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>cars.groupby(<span class="st">"origin"</span>)[<span class="st">"mpg"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>origin
europe    27.891429
japan     30.450633
usa       20.083534
Name: mpg, dtype: float64</code></pre>
</div>
</div>
<p>A lot of pandas expressions end up as compound statements like the one above. It’s equivalent to a sequence of assignments to temporary names:</p>
<div id="ecc93cca" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>by_origin <span class="op">=</span> cars.groupby(<span class="st">"origin"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>mpg_by_origin <span class="op">=</span> by_origin[<span class="st">"mpg"</span>]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>mpg_by_origin.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>origin
europe    27.891429
japan     30.450633
usa       20.083534
Name: mpg, dtype: float64</code></pre>
</div>
</div>
<p>When you encounter a compound statement in pandas, just interpret it step by step, from left to right.</p>
<p>Here we define bins for the weights and find the max of <em>mpg</em> within each bin:</p>
<div id="3fdbd167" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>cuts <span class="op">=</span> pd.cut(cars[<span class="st">"weight"</span>], <span class="bu">range</span>(<span class="dv">1500</span>, <span class="dv">5800</span>, <span class="dv">1000</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>by_weight <span class="op">=</span> cars.groupby(cuts)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>by_weight[<span class="st">"mpg"</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>weight
(1500, 2500]    46.6
(2500, 3500]    38.0
(3500, 4500]    26.6
(4500, 5500]    16.0
Name: mpg, dtype: float64</code></pre>
</div>
</div>
<p>If you want an aggregator other than those in <a href="#tbl-stats-agg" class="quarto-xref">Table&nbsp;<span>2.1</span></a>, you can call <code>agg</code> with your own function:</p>
<div id="cad675f5" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> iqr(x):</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    q1, q3 <span class="op">=</span> x.quantile( [<span class="fl">.25</span>, <span class="fl">.75</span>] )</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> q3 <span class="op">-</span> q1</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>by_weight[<span class="st">"mpg"</span>].agg(iqr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>weight
(1500, 2500]    8.450
(2500, 3500]    6.325
(3500, 4500]    3.125
(4500, 5500]    1.000
Name: mpg, dtype: float64</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_hs871th4&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_teg5s1li" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.17" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="transformation" class="level3 page-columns page-full" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="transformation"><span class="header-section-number">2.3.3</span> Transformation</h3>
<p>A <strong>transformation</strong> applies a function to each element of a column, producing a result of the same length that can be indexed the same way. This transformation is applied group by group.</p>
<div id="exm-stats-groups-transformation" class="theorem example" data-chapter="2" type="💻" data-description="Transforming data in groups">
<p><span class="theorem-title"><strong>Example 2.18 </strong></span>We can convert the <em>mpg</em> values to z-scores using the population mean and variance:</p>
<div id="e36ca0af" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> standardize(x):</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">-</span> x.mean()) <span class="op">/</span> x.std()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>cars[<span class="st">"mpg_z"</span>] <span class="op">=</span> standardize(cars[<span class="st">"mpg"</span>])</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"mpg_z"</span>, </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    col<span class="op">=</span><span class="st">"origin"</span>, height<span class="op">=</span><span class="fl">2.3</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-37-output-1.png" width="652" height="208"></p>
</div>
</div>
<p>Above, each of the distributions is shifted and scaled identically. The result is identical to the facet plot in <a href="#exm-stats-groups-facet" class="quarto-xref">Example&nbsp;<span>2.15</span></a> except for relabeled <span class="math inline">\(x\)</span>-axes. Instead, we could standardize <em>mpg</em> to z-scores within groups separately, so that each group is shifted and scaled independently:</p>
<div id="596afc9c" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>cars[<span class="st">"group_mpg_z"</span>] <span class="op">=</span> by_weight[<span class="st">"mpg"</span>].transform(standardize)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"group_mpg_z"</span>, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    col<span class="op">=</span><span class="st">"origin"</span>, height<span class="op">=</span><span class="fl">2.3</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-38-output-1.png" width="652" height="208"></p>
</div>
</div>
<p>(Another reason the second set of plots looks different is that the histogram bins are chosen differently.)</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_sw7wa3t5&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_fig9mph5" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.18" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="filtering" class="level3 page-columns page-full" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="filtering"><span class="header-section-number">2.3.4</span> Filtering</h3>
<p>A <strong>filter</strong> is a function that operates on a column and returns either <code>True</code>, meaning to keep the column, or <code>False</code>, meaning to reject it. This filter may be applied to a grouped frame.</p>
<div id="exm-stats-groups-filtering" class="theorem example" data-chapter="2" type="💻" data-description="Filtering data in groups">
<p><span class="theorem-title"><strong>Example 2.19 </strong></span>Suppose we want to group cars by horsepower, but we find out that some of the groups don’t have a lot of members:</p>
<div id="ea8e55b6" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>cuts <span class="op">=</span> pd.cut(cars[<span class="st">"horsepower"</span>], <span class="bu">range</span>(<span class="dv">40</span>, <span class="dv">220</span>, <span class="dv">20</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>by_hp <span class="op">=</span> cars.groupby(cuts)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>by_hp[<span class="st">"mpg"</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>horsepower
(40, 60]       20
(60, 80]       99
(80, 100]     123
(100, 120]     48
(120, 140]     25
(140, 160]     40
(160, 180]     20
(180, 200]      7
Name: mpg, dtype: int64</code></pre>
</div>
</div>
<p>Since small groups can give misleading statistics, we can filter out the groups with fewer than, say, 30 members:</p>
<div id="ba84a1b4" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> keeper(x):</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(x) <span class="op">&gt;</span> <span class="dv">29</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>hp_30 <span class="op">=</span> by_hp.<span class="bu">filter</span>(keeper)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>hp_30.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">model_year</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">mpg_z</th>
<th data-quarto-table-cell-role="th">cuts</th>
<th data-quarto-table-cell-role="th">group_mpg_z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>18.0</td>
<td>8</td>
<td>318.0</td>
<td>150.0</td>
<td>3436</td>
<td>11.0</td>
<td>70</td>
<td>usa</td>
<td>plymouth satellite</td>
<td>-0.705551</td>
<td>(2500, 3500]</td>
<td>-0.956484</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16.0</td>
<td>8</td>
<td>304.0</td>
<td>150.0</td>
<td>3433</td>
<td>12.0</td>
<td>70</td>
<td>usa</td>
<td>amc rebel sst</td>
<td>-0.961437</td>
<td>(2500, 3500]</td>
<td>-1.377177</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>14.0</td>
<td>8</td>
<td>340.0</td>
<td>160.0</td>
<td>3609</td>
<td>8.0</td>
<td>70</td>
<td>usa</td>
<td>plymouth 'cuda 340</td>
<td>-1.217322</td>
<td>(3500, 4500]</td>
<td>-0.611515</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>15.0</td>
<td>8</td>
<td>400.0</td>
<td>150.0</td>
<td>3761</td>
<td>9.5</td>
<td>70</td>
<td>usa</td>
<td>chevrolet monte carlo</td>
<td>-1.089379</td>
<td>(3500, 4500]</td>
<td>-0.249252</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>24.0</td>
<td>4</td>
<td>113.0</td>
<td>95.0</td>
<td>2372</td>
<td>15.0</td>
<td>70</td>
<td>japan</td>
<td>toyota corona mark ii</td>
<td>0.062107</td>
<td>(1500, 2500]</td>
<td>-1.130768</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The result is a single, ungrouped frame in which the members of all groups that failed the filter were removed. Thus, the <em>horsepower</em> column has no values left less than 60 or greater than 160:</p>
<div id="50c49a3b" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>hp_30[<span class="st">"horsepower"</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>count    310.000000
mean      95.309677
std       25.298367
min       61.000000
25%       75.000000
50%       90.000000
75%      105.000000
max      160.000000
Name: horsepower, dtype: float64</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_p15atvyr&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_iimonnmm" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.19" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p><img src="_media/memes/groupby.jpg" data-alt-text="Blue Men Group-ing" height="240"></p>
</section>
</section>
<section id="outliers" class="level2 page-columns page-full" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="outliers"><span class="header-section-number">2.4</span> Outliers</h2>
<p>Informally, an <strong>outlier</strong> is a data value that is considered to be far from typical. In some applications, such as detecting earthquakes or cancer, outliers are the cases of real interest. But we will be thinking of them as unwelcome values that might result from equipment failure, confounding effects, mistyping a value, using an extreme value to represent missing data, and so on. In such cases we want to minimize the effect of the outliers on the statistics.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_fdm9u5cu&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_wqj1o7yr" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 2.4" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>It is well known, for instance, that the mean is more sensitive to outliers than the median is.</p>
<div id="exm-stats-median-mean" class="theorem example" data-chapter="2" type="✍️" data-description="Outliers for mean and median">
<p><span class="theorem-title"><strong>Example 2.20 </strong></span>The values <span class="math inline">\(1,2,3,4,5\)</span> have a mean and median both equal to 3. If we change the largest value to be a lot larger, say <span class="math inline">\(1,2,3,4,1000\)</span>, then the mean changes to 202. But the median is still 3!</p>
</div>
<p><img src="_media/memes/outlier.jpg" height="240"></p>
<p>If you want to use a method that is vulnerable to outliers, it’s typical to remove such values early on. There are various ways of deciding what qualifies as an outlier, with no one-size recommendation for all applications.</p>
<section id="iqr" class="level3 page-columns page-full" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="iqr"><span class="header-section-number">2.4.1</span> IQR</h3>
<p>Let <span class="math inline">\(Q_{25}\)</span> and <span class="math inline">\(Q_{75}\)</span> be the first and third quartiles (i.e., 25% and 75% percentiles), and let <span class="math inline">\(I=Q_{75}-Q_{25}\)</span> be the interquartile range (IQR). Then <span class="math inline">\(x\)</span> is an outlier value if</p>
<p><span id="eq-stats-outlier-iqr"><span class="math display">\[
x &lt; Q_{25} - 1.5I \text{ or } x &gt; Q_{75} + 1.5I.
\tag{2.9}\]</span></span></p>
<p>In a box plot, the whiskers growing from a box show the extent of the non-outlier data, and the dots beyond the whiskers represent outliers.</p>
<div id="exm-stats-outlier-iqr" class="theorem example" data-chapter="2" type="💻" data-description="Interquartile range">
<p><span class="theorem-title"><strong>Example 2.21 </strong></span>Let’s look at another data set, based on an fMRI experiment:</p>
<div id="597e5062" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>fmri <span class="op">=</span> sns.load_dataset(<span class="st">"fmri"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>fmri.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">subject</th>
<th data-quarto-table-cell-role="th">timepoint</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">signal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>s13</td>
<td>18</td>
<td>stim</td>
<td>parietal</td>
<td>-0.017552</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>s5</td>
<td>14</td>
<td>stim</td>
<td>parietal</td>
<td>-0.080883</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>s12</td>
<td>18</td>
<td>stim</td>
<td>parietal</td>
<td>-0.081033</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>s11</td>
<td>18</td>
<td>stim</td>
<td>parietal</td>
<td>-0.046134</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>s10</td>
<td>18</td>
<td>stim</td>
<td>parietal</td>
<td>-0.037970</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We want to focus on the <em>signal</em> column, splitting according to the <em>event</em>.</p>
<div id="eafe7787" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>by_event <span class="op">=</span> fmri.groupby(<span class="st">"event"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>by_event[<span class="st">"signal"</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">cue</td>
<td>532.0</td>
<td>-0.006669</td>
<td>0.047752</td>
<td>-0.181241</td>
<td>-0.031122</td>
<td>-0.008871</td>
<td>0.015825</td>
<td>0.215735</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stim</td>
<td>532.0</td>
<td>0.013748</td>
<td>0.123179</td>
<td>-0.255486</td>
<td>-0.062378</td>
<td>-0.022202</td>
<td>0.058143</td>
<td>0.564985</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here is a box plot of the signal for these groups.</p>
<div id="138df0ca" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>fmri,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"event"</span>, y<span class="op">=</span><span class="st">"signal"</span>,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"box"</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-44-output-1.png" width="469" height="468"></p>
</div>
</div>
<p>The dots lying outside the whiskers in the plot can be considered outliers satisfying one of the inequalities in <a href="#eq-stats-outlier-iqr" class="quarto-xref">Equation&nbsp;<span>2.9</span></a>.</p>
<p>Let’s now remove the outliers. We start with a function that computes a Boolean-valued series for a given input. This function is applied as a <code>transform</code> to the data as grouped by <em>events</em>:</p>
<div id="4ee63d66" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_outlier(x):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    Q25, Q75 <span class="op">=</span> x.quantile([<span class="fl">.25</span>,<span class="fl">.75</span>])</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    I <span class="op">=</span> Q75 <span class="op">-</span> Q25</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">&lt;</span> Q25 <span class="op">-</span> <span class="fl">1.5</span><span class="op">*</span>I) <span class="op">|</span>  (x <span class="op">&gt;</span> Q75 <span class="op">+</span> <span class="fl">1.5</span><span class="op">*</span>I)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> by_event[<span class="st">"signal"</span>].transform(is_outlier)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>fmri.loc[outliers,<span class="st">"event"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>stim    40
cue     26
Name: event, dtype: int64</code></pre>
</div>
</div>
<p>You can see above that there are 66 outliers. To negate the outlier indicator, we can use <code>~outs</code> as a row selector.</p>
<div id="7b5a2ba0" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>cleaned <span class="op">=</span> fmri[<span class="op">~</span>outliers]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The median values are barely affected by the omission of the outliers:</p>
<div id="e2488d3a" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"medians with outliers:"</span> )</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( by_event[<span class="st">"signal"</span>].median() )</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"</span><span class="ch">\n</span><span class="st">medians without outliers:"</span> )</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( cleaned.groupby(<span class="st">"event"</span>)[<span class="st">"signal"</span>].median() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>medians with outliers:
event
cue    -0.008871
stim   -0.022202
Name: signal, dtype: float64

medians without outliers:
event
cue    -0.009006
stim   -0.028068
Name: signal, dtype: float64</code></pre>
</div>
</div>
<p>The means, though, show much greater change:</p>
<div id="baa8ce15" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"means with outliers:"</span> )</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( by_event[<span class="st">"signal"</span>].mean() )</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"</span><span class="ch">\n</span><span class="st">means without outliers:"</span> )</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( cleaned.groupby(<span class="st">"event"</span>)[<span class="st">"signal"</span>].mean() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>means with outliers:
event
cue    -0.006669
stim    0.013748
Name: signal, dtype: float64

means without outliers:
event
cue    -0.008243
stim   -0.010245
Name: signal, dtype: float64</code></pre>
</div>
</div>
<p>For the <em>stim</em> case in particular, the mean value changes by almost 200%, including a sign change. (Relative to the standard deviation, it’s closer to a 20% change.)</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_op8fm8cw&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_w7afoyvz" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.21" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="mean-and-std" class="level3 page-columns page-full" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="mean-and-std"><span class="header-section-number">2.4.2</span> Mean and STD</h3>
<p>For normal distributions, values more than twice the standard deviation <span class="math inline">\(\sigma\)</span> from the mean could be considered to be outliers; this would exclude 5% of the values, on average. A less aggressive criterion is to allow a distance of <span class="math inline">\(3\sigma\)</span>, which excludes only about 0.3% of the values. The IQR criterion above corresponds to about <span class="math inline">\(2.7\sigma\)</span> in the normal distribution case.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A criticism of classical statistics is that much of it is conditioned on the assumption of normal distributions. This assumption is often violated by real datasets; quantities that depend on normality should be used judiciously.</p>
</div>
</div>
<div id="exm-stats-outlier-std" class="theorem example" data-chapter="2" type="💻" data-description="Outliers">
<p><span class="theorem-title"><strong>Example 2.22 </strong></span>The following plot shows the outlier cutoffs for 2000 samples from a normal distribution, using the criteria for 2σ (red), 3σ (blue), and 1.5 IQR (black).</p>
<div id="aad33dd2" class="cell" data-execution_count="49">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> default_rng</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>randn <span class="op">=</span> default_rng(<span class="dv">1</span>).normal </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.Series(randn(size<span class="op">=</span><span class="dv">2000</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>x,bins<span class="op">=</span><span class="dv">30</span>)<span class="op">;</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>m,s <span class="op">=</span> x.mean(),x.std()</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>plt.axvline(m<span class="op">-</span><span class="dv">2</span><span class="op">*</span>s,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>plt.axvline(m<span class="op">+</span><span class="dv">2</span><span class="op">*</span>s,color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>plt.axvline(m<span class="op">-</span><span class="dv">3</span><span class="op">*</span>s,color<span class="op">=</span><span class="st">'b'</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>plt.axvline(m<span class="op">+</span><span class="dv">3</span><span class="op">*</span>s,color<span class="op">=</span><span class="st">'b'</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>q1,q3 <span class="op">=</span> x.quantile([<span class="fl">.25</span>,<span class="fl">.75</span>])</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>plt.axvline(q3<span class="op">+</span><span class="fl">1.5</span><span class="op">*</span>(q3<span class="op">-</span>q1),color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>plt.axvline(q1<span class="op">-</span><span class="fl">1.5</span><span class="op">*</span>(q3<span class="op">-</span>q1),color<span class="op">=</span><span class="st">'k'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-49-output-1.png" width="469" height="469"></p>
</div>
</div>
<p>For asymmetric distributions, or those with a heavy tail, these criteria might show greater differences.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_03pilhbt&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_jhmbquqc" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.22" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
</section>
<section id="correlation" class="level2 page-columns page-full" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="correlation"><span class="header-section-number">2.5</span> Correlation</h2>
<p>There are often variables that we believe to be linked, either because one influences the other, or because both are influenced by some other factor. In either case, we say the quantities are <em>correlated</em>.</p>
<p>There are several ways to measure correlation. It’s good practice to look at the data first, though, before jumping to the numbers.</p>
<section id="relational-plots" class="level3 page-columns page-full" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="relational-plots"><span class="header-section-number">2.5.1</span> Relational plots</h3>
<p>Thus far, we have used <code>displot</code>, or “distribution plot”, to make histograms, and <code>catplot</code>, or “categorical plot”, to make box and violin plots. The third major plot type in seaborn is <code>relplot</code>, or “relational plot”, to show the relationships between variables.</p>
<div id="exm-stats-relational" class="theorem example" data-chapter="2" type="💻" data-description="Relational plots">
<p><span class="theorem-title"><strong>Example 2.23 </strong></span>By default, <code>relplot</code> makes a scatter plot of two different variables:</p>
<div id="d085a44f" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"model_year"</span>, y<span class="op">=</span><span class="st">"mpg"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-50-output-1.png" width="469" height="468"></p>
</div>
</div>
<p>Like in the other plot types, we can use hue (color) and marker size to indicate groups within the data:</p>
<div id="ec2758fd" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>cars, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"model_year"</span>, y<span class="op">=</span><span class="st">"mpg"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">"origin"</span>, size<span class="op">=</span><span class="st">"weight"</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-51-output-1.png" width="560" height="468"></p>
</div>
</div>
<p>If we want to emphasize a trend rather than the individual data values, we can instead plot the average value at each <span class="math inline">\(x\)</span> with error bars:</p>
<div id="76a3ca68" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>cars, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"model_year"</span>, y<span class="op">=</span><span class="st">"mpg"</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"line"</span>, errorbar<span class="op">=</span><span class="st">"sd"</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-52-output-1.png" width="469" height="468"></p>
</div>
</div>
<p>The error ribbon above is drawn at one standard deviation around the mean.</p>
<p>In order to see multiple pairwise scatter plots in one shot, we can use <code>pairplot</code> in seaborn:</p>
<div id="eb74d314" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [ <span class="st">"mpg"</span>, <span class="st">"horsepower"</span>, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">"displacement"</span>, <span class="st">"origin"</span> ]</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>sns.pairplot(data<span class="op">=</span>cars[columns],</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">"origin"</span>, height<span class="op">=</span><span class="dv">2</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-53-output-1.png" width="669" height="568"></p>
</div>
</div>
<p>The panels along the diagonal show each quantitative variable’s PDF. The other panels show scatter plots putting one pair at a time of the variables on the coordinate axes.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_4v5nh9ki&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_5n5zc3ch" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.23" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div></section>
<section id="covariance" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="covariance"><span class="header-section-number">2.5.2</span> Covariance</h3>
<div id="def-stats-covariance" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.10 </strong></span>Suppose we have two series of observations, <span class="math inline">\([x_i]\)</span> and <span class="math inline">\([y_i]\)</span>, representing observations of random quantities <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> having means <span class="math inline">\(\mu_X\)</span> and <span class="math inline">\(\mu_Y\)</span>. Their <strong>covariance</strong> is defined as <span class="math display">\[
\Cov(X,Y) = \frac{1}{n} \sum_{i=1}^n (x_i-\mu_X)(y_i-\mu_Y).
\]</span></p>
</div>
<p>Note that the values <span class="math inline">\(x_i-\mu_X\)</span> and <span class="math inline">\(y_i-\mu_Y\)</span> are deviations from the means. It follows from the definitions that <span class="math display">\[
\begin{split}
    \Cov(X,X) &amp;= \sigma_X^2, \\
    \Cov(Y,Y) &amp;= \sigma_Y^2,
\end{split}
\]</span> i.e., self-covariance is simply variance.</p>
<p>Covariance is not easy to interpret. Its units are the products of the units of the two variables, and it is sensitive to rescaling the variables (e.g., grams versus kilograms).</p>
</section>
<section id="pearson-coefficient" class="level3 page-columns page-full" data-number="2.5.3">
<h3 data-number="2.5.3" class="anchored" data-anchor-id="pearson-coefficient"><span class="header-section-number">2.5.3</span> Pearson coefficient</h3>
<p>We can remove the dependence on units and scale by applying the covariance to standardized scores for both variables. The following is the best-known measure of correlation.</p>
<div id="def-stats-pearson" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.11 </strong></span>For the populations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, the <strong>Pearson correlation coefficient</strong> is <span id="eq-stats-pearson-pop"><span class="math display">\[
\begin{split}
    \rho(X,Y) &amp;= \frac{1}{n} \sum_{i=1}^n \left(\frac{x_i-\mu_X}{\sigma_X}\right)\left(\frac{y_i-\mu_Y}{\sigma_Y}\right) \\
    &amp; = \frac{\Cov(X,Y)}{\sigma_X\sigma_Y},
\end{split}
\tag{2.10}\]</span></span> where <span class="math inline">\(\sigma_X^2\)</span> and <span class="math inline">\(\sigma_Y^2\)</span> are the population variances of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>For samples from the two populations, we use <span id="eq-stats-pearson-samp"><span class="math display">\[
r_{xy} =  \frac{\sum_{i=1}^n (x_i-\bar{x}) (y_i-\bar{y})}{\sqrt{\sum_{i=1}^n (x_i-\bar{x})^2}\,\sqrt{\sum_{i=1}^n (y_i-\bar{y})^2}},
\tag{2.11}\]</span></span> where <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> are sample means.</p>
</div>
<p>Both <span class="math inline">\(\rho_{XY}\)</span> and <span class="math inline">\(r_{xy}\)</span> are between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>, with the endpoints indicating perfect correlation (inverse or direct).</p>
<p>An equivalent formula for <span class="math inline">\(r_{xy}\)</span> is <span id="eq-stats-pearson-alt"><span class="math display">\[
r_{xy} =  \frac{1}{n-1} \sum_{i=1}^n \left(\frac{x_i-\bar{x}}{s_x}\right)\, \left(\frac{y_i-\bar{y}}{s_y}\right),
\tag{2.12}\]</span></span> where the quantities in parentheses are z-scores.</p>
<div id="exm-stats-pearson-cars" class="theorem example" data-chapter="2" type="💻" data-description="Pearson correlation coefficient">
<p><span class="theorem-title"><strong>Example 2.24 </strong></span>We might reasonably expect horsepower and miles per gallon to be negatively correlated:</p>
<div id="bbb1c55d" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>cars, x<span class="op">=</span><span class="st">"horsepower"</span>, y<span class="op">=</span><span class="st">"mpg"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-54-output-1.png" width="469" height="468"></p>
</div>
</div>
<p>Covariance allows us to quantify the relationship:</p>
<div id="e6f3b152" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>cars[ [<span class="st">"horsepower"</span>, <span class="st">"mpg"</span>] ].cov()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">mpg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">horsepower</td>
<td>1481.569393</td>
<td>-233.857926</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mpg</td>
<td>-233.857926</td>
<td>61.089611</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>But should these numbers considered big? The Pearson coefficient is more easily interpreted:</p>
<div id="1c610124" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>cars[ [<span class="st">"horsepower"</span>, <span class="st">"mpg"</span>] ].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">mpg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">horsepower</td>
<td>1.000000</td>
<td>-0.778427</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mpg</td>
<td>-0.778427</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The value of about <span class="math inline">\(-0.79\)</span> suggests that knowing one of the values would allow us to predict the other one rather well using a best-fit straight line (more on that in a future chapter).</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_vdwfrkpk&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_dpu1nain" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.24" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>As usual when dealing with means, however, the Pearson coefficient can be sensitive to outlier values.</p>
<div id="exm-stats-pearson-outlier" class="theorem example" data-chapter="2" type="💻" data-description="Outliers and the Pearson coefficient">
<p><span class="theorem-title"><strong>Example 2.25 </strong></span>The Pearson coefficient of any variable with itself is 1. But let’s correlate two series that differ in only one element: <span class="math inline">\(0,1,2,\ldots,19\)</span>, and the same sequence but with the fifth value replaced by <span class="math inline">\(-100\)</span>:</p>
<div id="f9b144ac" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.Series( <span class="bu">range</span>(<span class="dv">20</span>) )</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x.copy()</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">4</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">100</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>x.corr(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>0.43636501543147005</code></pre>
</div>
</div>
<p>Despite the change being in a single value, over half of the predictive power was lost.</p>
</div>
</section>
<section id="spearman-coefficient" class="level3 page-columns page-full" data-number="2.5.4">
<h3 data-number="2.5.4" class="anchored" data-anchor-id="spearman-coefficient"><span class="header-section-number">2.5.4</span> Spearman coefficient</h3>
<p>The Spearman coefficient is one way to lessen the impact of outliers when measuring correlation. The idea is that the values are used only in their orderings.</p>
<div id="def-stats-rank-series" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.12 </strong></span>If <span class="math inline">\(x_1,\ldots,x_n\)</span> is a series of observations, let their sorted ordering be <span class="math display">\[
x_{s_1},x_{s_2},\ldots,x_{s_n}.
\]</span> Then <span class="math inline">\(s_1,s_2,\ldots,s_n\)</span> is the <strong>rank series</strong> of <span class="math inline">\(\bfx\)</span>.</p>
</div>
<div id="def-stats-spearman" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.13 </strong></span>The <strong>Spearman coefficient</strong> of two series of equal length is the Pearson coefficient of their rank series.</p>
</div>
<div id="exm-stats-spearman-outlier" class="theorem example" data-chapter="2" type="💻" data-description="Spearman correlation coefficient">
<p><span class="theorem-title"><strong>Example 2.26 </strong></span>Returning to <a href="#exm-stats-pearson-outlier" class="quarto-xref">Example&nbsp;<span>2.25</span></a>, we find the Spearman coefficient is barely affected by the single outlier:</p>
<div id="024a12fa" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.Series( <span class="bu">range</span>(<span class="dv">20</span>) )</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x.copy()</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">4</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">100</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>x.corr(y,<span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>0.9849624060150375</code></pre>
</div>
</div>
<p>It’s trivial in this case to produce the two rank series by hand:</p>
<div id="fa469eef" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series( <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">21</span>) )    <span class="co"># already sorted</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> s.copy()</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>t[:<span class="dv">5</span>] <span class="op">=</span> [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">1</span>]     <span class="co"># modified sort ordering</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>t.corr(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>0.9849624060150375</code></pre>
</div>
</div>
<p>As long as <code>y[4]</code> is negative, it doesn’t matter what its particular value is:</p>
<div id="c1b088f3" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">4</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">1000000</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>x.corr(y,<span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>0.9849624060150375</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_xemkvgjk&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_4q0yq5vd" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.26" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>Since real data almost always features outlying or anomalous values, it’s important to think about the robustness of the statistics you choose.</p>
</section>
<section id="categorical-correlation" class="level3 page-columns page-full" data-number="2.5.5">
<h3 data-number="2.5.5" class="anchored" data-anchor-id="categorical-correlation"><span class="header-section-number">2.5.5</span> Categorical correlation</h3>
<p>An ordinal variable, such as the days of the week, is often straightforward to quantify as integers. But a nominal variable poses a different challenge.</p>
<div id="exm-stats-catcorr" class="theorem example" data-chapter="2" type="💻" data-description="Categorical correlation">
<p><span class="theorem-title"><strong>Example 2.27 </strong></span>Grouped histograms suggest an association between country of origin and MPG:</p>
<div id="ec459577" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>cars, kind<span class="op">=</span><span class="st">"kde"</span>,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"mpg"</span>, hue<span class="op">=</span><span class="st">"origin"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-61-output-1.png" width="572" height="468"></p>
</div>
</div>
<p>How can we quantify the association? The first step is to convert the <em>origin</em> column into dummy variables:</p>
<div id="d137fe00" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>dum <span class="op">=</span> pd.get_dummies(cars, columns<span class="op">=</span>[<span class="st">"origin"</span>])</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>dum.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">model_year</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">mpg_z</th>
<th data-quarto-table-cell-role="th">cuts</th>
<th data-quarto-table-cell-role="th">group_mpg_z</th>
<th data-quarto-table-cell-role="th">origin_europe</th>
<th data-quarto-table-cell-role="th">origin_japan</th>
<th data-quarto-table-cell-role="th">origin_usa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>18.0</td>
<td>8</td>
<td>307.0</td>
<td>130.0</td>
<td>3504</td>
<td>12.0</td>
<td>70</td>
<td>chevrolet chevelle malibu</td>
<td>-0.705551</td>
<td>(3500, 4500]</td>
<td>0.837535</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>15.0</td>
<td>8</td>
<td>350.0</td>
<td>165.0</td>
<td>3693</td>
<td>11.5</td>
<td>70</td>
<td>buick skylark 320</td>
<td>-1.089379</td>
<td>(3500, 4500]</td>
<td>-0.249252</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>18.0</td>
<td>8</td>
<td>318.0</td>
<td>150.0</td>
<td>3436</td>
<td>11.0</td>
<td>70</td>
<td>plymouth satellite</td>
<td>-0.705551</td>
<td>(2500, 3500]</td>
<td>-0.956484</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16.0</td>
<td>8</td>
<td>304.0</td>
<td>150.0</td>
<td>3433</td>
<td>12.0</td>
<td>70</td>
<td>amc rebel sst</td>
<td>-0.961437</td>
<td>(2500, 3500]</td>
<td>-1.377177</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>17.0</td>
<td>8</td>
<td>302.0</td>
<td>140.0</td>
<td>3449</td>
<td>10.5</td>
<td>70</td>
<td>ford torino</td>
<td>-0.833494</td>
<td>(2500, 3500]</td>
<td>-1.166831</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The original <em>origin</em> column has been replaced by three binary indicator columns. Now we can look for correlations between them and <em>mpg</em>:</p>
<div id="4963067f" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mpg"</span>,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"origin_europe"</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"origin_japan"</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"origin_usa"</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>dum[columns].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">origin_europe</th>
<th data-quarto-table-cell-role="th">origin_japan</th>
<th data-quarto-table-cell-role="th">origin_usa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">mpg</td>
<td>1.000000</td>
<td>0.259022</td>
<td>0.442174</td>
<td>-0.568192</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">origin_europe</td>
<td>0.259022</td>
<td>1.000000</td>
<td>-0.229895</td>
<td>-0.597198</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">origin_japan</td>
<td>0.442174</td>
<td>-0.229895</td>
<td>1.000000</td>
<td>-0.643317</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">origin_usa</td>
<td>-0.568192</td>
<td>-0.597198</td>
<td>-0.643317</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As you can see from the above, <code>europe</code> and <code>japan</code> are positively associated with <em>mpg</em>, while <code>usa</code> is inversely associated with <em>mpg</em>.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_lt0xli2d&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_vgpi7ufk" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.27" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://imgs.xkcd.com/comics/correlation.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">xckd by <a href="https://xkcd.com/license.html">Randall Munroe</a></figcaption>
</figure>
</div>
</section>
</section>
<section id="cautionary-tales" class="level2 page-columns page-full" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="cautionary-tales"><span class="header-section-number">2.6</span> Cautionary tales</h2>
<p>Attaching theorem-supported numbers to real data feels precise and infallible. The theorems do what they say, of course—they’re theorems!—but our intuition can be a little too ready to attach significance to the numbers, causing misconceptions or mistakes. Proper visualizations can help us see through such issues.</p>
<section id="the-datasaurus" class="level3 page-columns page-full" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="the-datasaurus"><span class="header-section-number">2.6.1</span> The Datasaurus</h3>
<p>The Datasaurus Dozen is a collection of datasets that highlights the perils of putting blind trust into summary statistics.</p>
<div id="exm-stats-datasaurus" class="theorem example" data-chapter="2" type="💻" data-description="The Datasaurus">
<p><span class="theorem-title"><strong>Example 2.28 </strong></span>The Datasaurus is a set of 142 points making a handsome portrait:</p>
<div id="f4c9310b" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>dozen <span class="op">=</span> pd.read_csv(<span class="st">"_datasets/DatasaurusDozen.tsv"</span>, delimiter<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>dozen[dozen[<span class="st">"dataset"</span>]<span class="op">==</span><span class="st">"dino"</span>], x<span class="op">=</span><span class="st">"x"</span>, y<span class="op">=</span><span class="st">"y"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-64-output-1.png" width="470" height="468"></p>
</div>
</div>
<p>However, there are 12 other datasets that all have roughly the same mean and variance for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and the same correlations between them:</p>
<div id="91e185c7" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>by_set <span class="op">=</span> dozen.groupby(<span class="st">"dataset"</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>by_set.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">dataset</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">away</td>
<td>54.266100</td>
<td>47.834721</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bullseye</td>
<td>54.268730</td>
<td>47.830823</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">circle</td>
<td>54.267320</td>
<td>47.837717</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">dino</td>
<td>54.263273</td>
<td>47.832253</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">dots</td>
<td>54.260303</td>
<td>47.839829</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">h_lines</td>
<td>54.261442</td>
<td>47.830252</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">high_lines</td>
<td>54.268805</td>
<td>47.835450</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">slant_down</td>
<td>54.267849</td>
<td>47.835896</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">slant_up</td>
<td>54.265882</td>
<td>47.831496</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">star</td>
<td>54.267341</td>
<td>47.839545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">v_lines</td>
<td>54.269927</td>
<td>47.836988</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">wide_lines</td>
<td>54.266916</td>
<td>47.831602</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">x_shape</td>
<td>54.260150</td>
<td>47.839717</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="69f37082" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>by_set.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">dataset</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">away</td>
<td>16.769825</td>
<td>26.939743</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bullseye</td>
<td>16.769239</td>
<td>26.935727</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">circle</td>
<td>16.760013</td>
<td>26.930036</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">dino</td>
<td>16.765142</td>
<td>26.935403</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">dots</td>
<td>16.767735</td>
<td>26.930192</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">h_lines</td>
<td>16.765898</td>
<td>26.939876</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">high_lines</td>
<td>16.766704</td>
<td>26.939998</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">slant_down</td>
<td>16.766759</td>
<td>26.936105</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">slant_up</td>
<td>16.768853</td>
<td>26.938608</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">star</td>
<td>16.768959</td>
<td>26.930275</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">v_lines</td>
<td>16.769959</td>
<td>26.937684</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">wide_lines</td>
<td>16.770000</td>
<td>26.937902</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">x_shape</td>
<td>16.769958</td>
<td>26.930002</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a29e29df" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>by_set.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">dataset</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">away</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.064128</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.064128</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">bullseye</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068586</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068586</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">circle</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068343</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068343</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">dino</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.064472</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.064472</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">dots</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.060341</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.060341</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">h_lines</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.061715</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.061715</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">high_lines</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068504</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068504</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">slant_down</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068980</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068980</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">slant_up</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.068609</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.068609</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">star</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.062961</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.062961</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">v_lines</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.069446</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.069446</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">wide_lines</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.066575</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.066575</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">x_shape</td>
<td data-quarto-table-cell-role="th">x</td>
<td>1.000000</td>
<td>-0.065583</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y</td>
<td>-0.065583</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>However, a plot reveals that these sets are, to put it mildly, quite distinct:</p>
<div id="0b837013" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>others <span class="op">=</span> dozen[ dozen[<span class="st">"dataset"</span>] <span class="op">!=</span> <span class="st">"dino"</span> ]</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>others,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"x"</span>, y<span class="op">=</span><span class="st">"y"</span>,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    col<span class="op">=</span><span class="st">"dataset"</span>, col_wrap<span class="op">=</span><span class="dv">3</span>, height<span class="op">=</span><span class="fl">2.2</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-68-output-1.png" width="623" height="832"></p>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_kiug6i2v&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_a55arc2f" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.28" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Always plot your data.</p>
</div>
</div>
<p>Always 👏 plot 👏 your 👏 data!</p>
</section>
<section id="correlation-vs.-dependence" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="correlation-vs.-dependence"><span class="header-section-number">2.6.2</span> Correlation vs.&nbsp;dependence</h3>
<p>In casual speech, you might expect two variables that are uncorrelated to be unrelated. But that is not at all how the mathematical definitions play out.</p>
<div id="exm-stats-correlation" class="theorem example" data-chapter="2" type="💻" data-description="Correlation vs. dependence">
<p><span class="theorem-title"><strong>Example 2.29 </strong></span>For example, here are <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> variables that both depend on a hidden variable <span class="math inline">\(\theta\)</span>:</p>
<div id="cb23d5bb" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>np.pi,<span class="dv">50</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.Series(np.cos(theta))</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> pd.Series(np.sin(theta))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>sns.relplot(x<span class="op">=</span>x, y<span class="op">=</span>y)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-69-output-1.png" width="451" height="450"></p>
</div>
</div>
<p>Neither informally nor mathematically would we say that <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are independent! For example, if <span class="math inline">\(y=0\)</span>, then there is only one possible value for <span class="math inline">\(x\)</span>. Yet the correlation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is zero:</p>
<div id="9fbda1d1" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>x.corr(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>8.276095507101827e-18</code></pre>
</div>
</div>
<p>Correlation can only measure the extent of the relationship that is <em>linear</em>; <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> lying on a straight line means perfect correlation. In this case, every line you can draw that passes through <span class="math inline">\((0,0)\)</span> is essentially equally bad at representing the data, and correlation cannot express the relationship.</p>
</div>
</section>
<section id="sec-stats-simpson" class="level3 page-columns page-full" data-number="2.6.3">
<h3 data-number="2.6.3" class="anchored" data-anchor-id="sec-stats-simpson"><span class="header-section-number">2.6.3</span> Simpson’s paradox</h3>
<p>The penguin dataset contains a common paradox—or a counterintuitive phenomenon, at least.</p>
<div id="exm-stats-simpson" class="theorem example" data-chapter="2" type="💻" data-description="Simpson's paradox">
<p><span class="theorem-title"><strong>Example 2.30 </strong></span>Two of the variables show a fairly strong negative correlation:</p>
<div id="6f8ebca4" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="op">=</span> sns.load_dataset(<span class="st">"penguins"</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [ <span class="st">"body_mass_g"</span>, <span class="st">"bill_depth_mm"</span> ]</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>penguins[columns].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">body_mass_g</th>
<th data-quarto-table-cell-role="th">bill_depth_mm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">body_mass_g</td>
<td>1.000000</td>
<td>-0.471916</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bill_depth_mm</td>
<td>-0.471916</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>But something surprising happens if we compute correlations <em>after</em> grouping by species.</p>
<div id="4c7c4877" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>penguins.groupby(<span class="st">"species"</span>)[columns].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">body_mass_g</th>
<th data-quarto-table-cell-role="th">bill_depth_mm</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">species</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Adelie</td>
<td data-quarto-table-cell-role="th">body_mass_g</td>
<td>1.000000</td>
<td>0.576138</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bill_depth_mm</td>
<td>0.576138</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Chinstrap</td>
<td data-quarto-table-cell-role="th">body_mass_g</td>
<td>1.000000</td>
<td>0.604498</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bill_depth_mm</td>
<td>0.604498</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Gentoo</td>
<td data-quarto-table-cell-role="th">body_mass_g</td>
<td>1.000000</td>
<td>0.719085</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bill_depth_mm</td>
<td>0.719085</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Within each individual species, the correlation between the variables is strongly positive!</p>
<p>This is an example of <strong>Simpson’s paradox</strong>. The reason for it can be seen from a scatter plot:</p>
<div id="73942977" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>penguins,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>columns[<span class="dv">0</span>], y<span class="op">=</span>columns[<span class="dv">1</span>], </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">"species"</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-73-output-1.png" width="575" height="468"></p>
</div>
</div>
<p>Within each color, the positive association is clear. But what dominates the combination of all three species is the large difference between Gentoo and the others. Because the Gentoo are both larger and have shallower bills, the dominant relationship is negative.</p>
</div>
<p><img src="_media/memes/simpson.gif" class="img-fluid"></p>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_ocuuaffk&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_cj8ha4z2" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 2.30" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0">
</iframe>
</div>
</div>
</div></div><p>As often happens in statistics, the precise framing of the question can strongly affect its answer. This can lead to honest mistakes by the naive as well as outright deception by the unscrupulous.</p>
</section>
</section>
<section id="exercises" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="exercises">Exercises</h2>
<p>For these exercises, you may use computer help to work on a problem, but your submitted solution should be self-contained without reference to computer output (unless stated otherwise).</p>
<div id="exr-stats-summary" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.1 </strong></span>The following parts are about the sample set of <span class="math inline">\(n\)</span> values (<span class="math inline">\(n&gt;2\)</span>)</p>
<p><span class="math display">\[
0, 0, 0, \ldots, 0, 1000.
\]</span></p>
<p>(That is, there are <span class="math inline">\(n-1\)</span> copies of 0 and one copy of 1000.)</p>
<p><strong>(a)</strong> Show that the sample mean is <span class="math inline">\(1000/n\)</span>.</p>
<p><strong>(b)</strong> Find the sample median when <span class="math inline">\(n\)</span> is odd.</p>
<p><strong>(c)</strong> Show that the corrected sample variance <span class="math inline">\(s_{n-1}^2\)</span> is <span class="math inline">\(10^6/n\)</span>.</p>
<p><strong>(d)</strong> Find the sample z-scores of all the values.</p>
</div>
<div id="exr-stats-outlier" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.2 </strong></span>This exercise is about the same set of sample values as <a href="#exr-stats-summary" class="quarto-xref">Exercise&nbsp;<span>2.1</span></a>. Suppose the 2σ-outlier criterion is applied using the sample mean and sample variance.</p>
<p><strong>(a)</strong> Show that regardless of <span class="math inline">\(n\)</span>, the value 0 is never an outlier.</p>
<p><strong>(b)</strong> Show that the value 1000 is an outlier if <span class="math inline">\(n \ge 6\)</span>.</p>
</div>
<div id="exr-stats-z-scores" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.3 </strong></span>Suppose the samples <span class="math inline">\(x_1,\ldots,x_n\)</span> have the z-scores <span class="math inline">\(z_1,\ldots,z_n\)</span>.</p>
<p><strong>(a)</strong> Show that the sample z-scores satisfy <span class="math inline">\(\displaystyle \sum_{i=1}^n z_i = 0.\)</span></p>
<p><strong>(b)</strong> Show that the sample z-scores satisfy <span class="math inline">\(\displaystyle \sum_{i=1}^n z_i^2 = n-1.\)</span></p>
</div>
<div id="exr-stats-outlier-iqr" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.4 </strong></span>Define a population by</p>
<p><span class="math display">\[
x_i = \begin{cases}
1, &amp; 1 \le i \le 11, \\
2, &amp; 12 \le i \le 14,\\
4, &amp; 15 \le i \le 22, \\
6, &amp; 23 \le i \le 32.
\end{cases}
\]</span></p>
<p>(That is, there are 11 values of 1, 3 values of 2, 8 values of 4, and 10 values of 6.)</p>
<p><strong>(a)</strong> Find the median of the population.</p>
<p><strong>(b)</strong> Find the smallest interval containing all non-outlier values according to the 1.5 IQR criterion.</p>
</div>
<div id="exr-stats-least-squares" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.5 </strong></span>Given a population of values <span class="math inline">\(x_1,x_2,\ldots,x_n\)</span>, define the function</p>
<p><span class="math display">\[
r_2(x) = \sum_{i=1}^n (x_i-x)^2.
\]</span></p>
<p>Show using calculus that <span class="math inline">\(r_2\)</span> is minimized at <span class="math inline">\(x=\mu\)</span>, the population mean.</p>
</div>
<div id="exr-stats-least-mad" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.6 </strong></span>Suppose that <span class="math inline">\(n=2k+1\)</span> and a population has values <span class="math inline">\(x_1,x_2,\ldots,x_{n}\)</span> in sorted order, so that the median is equal to <span class="math inline">\(x_k\)</span>. Define the function</p>
<p><span class="math display">\[
r_1(x) = \sum_{i=1}^n |x_i - x|.
\]</span></p>
<p>(This function is called the <em>total absolute deviation</em> of <span class="math inline">\(x\)</span> from the population.) Show that <span class="math inline">\(r_1\)</span> has a global minimum at <span class="math inline">\(x=x_k\)</span> by way of the following steps.</p>
<p><strong>(a)</strong> Explain why the derivative of <span class="math inline">\(r_1\)</span> is undefined at every <span class="math inline">\(x_i\)</span>. Consequently, all of the <span class="math inline">\(x_i\)</span> are critical points of <span class="math inline">\(r_1\)</span>.</p>
<p><strong>(b)</strong> Determine <span class="math inline">\(r_1'\)</span> within each interval <span class="math inline">\((-\infty,x_1),\, (x_1,x_2),\, (x_2,x_3),\)</span> and so on. Explain why this shows that there cannot be any additional critical points to consider. (Note: you can replace the absolute values with a piecewise definition of <span class="math inline">\(r_1\)</span>, where the formula for the pieces changes as you cross over each <span class="math inline">\(x_i\)</span>.)</p>
<p><strong>(c)</strong> By considering the <span class="math inline">\(r_1'\)</span> values between the <span class="math inline">\(x_i\)</span>, explain why it must be that</p>
<p><span class="math display">\[
r_1(x_1) &gt; r_1(x_2) &gt; \cdots &gt; r_1(x_k) &lt; r_1(x_{k+1}) &lt; \cdots &lt; r_1(x_n).
\]</span></p>
</div>
<div id="exr-stats-pearson-z" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.7 </strong></span>Prove that two sample sets have a Pearson correlation coefficient equal to 1 if they have identical z-scores. (Hint: Use the results of <a href="#exr-stats-z-scores" class="quarto-xref">Exercise&nbsp;<span>2.3</span></a>.)</p>
</div>
<div id="exr-stats-pearson-anti" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.8 </strong></span>Suppose that two sample sets satisfy <span class="math inline">\(y_i=-x_i\)</span> for all <span class="math inline">\(i\)</span>. Prove that the Pearson correlation coefficient between the sets equals <span class="math inline">\(-1\)</span>.</p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Representation of data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./classification.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Classification</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Data Science 1
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Toby Driscoll
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>