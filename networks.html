<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Networks – Data Science 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./review.html" rel="next">
<link href="./clustering.html" rel="prev">
<link href="./_media/logo_small.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/videojs/video.min.js"></script>
<link href="site_libs/quarto-contrib/videojs/video-js.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script> 
MathJax = {
  chtml: {
    scale: 0.92,
  }
}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./networks.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Networks</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="quarto-sidebar-header"><div class="sidebar-header-item">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_media/logo_small.png" class="quarto-figure quarto-figure-center figure-img" height="120"></p>
</figure>
</div>
</div></div>
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science 1</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">List of examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./starting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Representation of data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Classification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model selection</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./networks.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Networks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Review questions by section</span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>Copyright (c) 2024 by <a href="https://tobydriscoll.net">Toby Driscoll</a></p>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#graphs" id="toc-graphs" class="nav-link active" data-scroll-target="#graphs"><span class="header-section-number">7.1</span> Graphs</a>
  <ul class="collapse">
  <li><a href="#sec-networks-zoo" id="toc-sec-networks-zoo" class="nav-link" data-scroll-target="#sec-networks-zoo"><span class="header-section-number">7.1.1</span> A graph menagerie</a></li>
  <li><a href="#neighbors" id="toc-neighbors" class="nav-link" data-scroll-target="#neighbors"><span class="header-section-number">7.1.2</span> Neighbors</a></li>
  <li><a href="#degree" id="toc-degree" class="nav-link" data-scroll-target="#degree"><span class="header-section-number">7.1.3</span> Degree</a></li>
  </ul></li>
  <li><a href="#random-graphs" id="toc-random-graphs" class="nav-link" data-scroll-target="#random-graphs"><span class="header-section-number">7.2</span> Random graphs</a>
  <ul class="collapse">
  <li><a href="#erdős-rényi-graphs" id="toc-erdős-rényi-graphs" class="nav-link" data-scroll-target="#erdős-rényi-graphs"><span class="header-section-number">7.2.1</span> Erdős-Rényi graphs</a></li>
  <li><a href="#wattsstrogatz-graphs" id="toc-wattsstrogatz-graphs" class="nav-link" data-scroll-target="#wattsstrogatz-graphs"><span class="header-section-number">7.2.2</span> Watts–Strogatz graphs</a></li>
  </ul></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering"><span class="header-section-number">7.3</span> Clustering</a>
  <ul class="collapse">
  <li><a href="#er-graphs" id="toc-er-graphs" class="nav-link" data-scroll-target="#er-graphs"><span class="header-section-number">7.3.1</span> ER graphs</a></li>
  <li><a href="#ws-graphs" id="toc-ws-graphs" class="nav-link" data-scroll-target="#ws-graphs"><span class="header-section-number">7.3.2</span> WS graphs</a></li>
  </ul></li>
  <li><a href="#distance" id="toc-distance" class="nav-link" data-scroll-target="#distance"><span class="header-section-number">7.4</span> Distance</a>
  <ul class="collapse">
  <li><a href="#connectedness" id="toc-connectedness" class="nav-link" data-scroll-target="#connectedness"><span class="header-section-number">7.4.1</span> Connectedness</a></li>
  <li><a href="#er-graphs-1" id="toc-er-graphs-1" class="nav-link" data-scroll-target="#er-graphs-1"><span class="header-section-number">7.4.2</span> ER graphs</a></li>
  <li><a href="#sec-networks-distance-WS" id="toc-sec-networks-distance-WS" class="nav-link" data-scroll-target="#sec-networks-distance-WS"><span class="header-section-number">7.4.3</span> WS graphs</a></li>
  <li><a href="#twitch-network" id="toc-twitch-network" class="nav-link" data-scroll-target="#twitch-network"><span class="header-section-number">7.4.4</span> Twitch network</a></li>
  </ul></li>
  <li><a href="#degree-distributions" id="toc-degree-distributions" class="nav-link" data-scroll-target="#degree-distributions"><span class="header-section-number">7.5</span> Degree distributions</a>
  <ul class="collapse">
  <li><a href="#power-law-distribution" id="toc-power-law-distribution" class="nav-link" data-scroll-target="#power-law-distribution"><span class="header-section-number">7.5.1</span> Power-law distribution</a></li>
  <li><a href="#barabásialbert-graphs" id="toc-barabásialbert-graphs" class="nav-link" data-scroll-target="#barabásialbert-graphs"><span class="header-section-number">7.5.2</span> Barabási–Albert graphs</a></li>
  </ul></li>
  <li><a href="#centrality" id="toc-centrality" class="nav-link" data-scroll-target="#centrality"><span class="header-section-number">7.6</span> Centrality</a>
  <ul class="collapse">
  <li><a href="#degree-centrality" id="toc-degree-centrality" class="nav-link" data-scroll-target="#degree-centrality"><span class="header-section-number">7.6.1</span> Degree centrality</a></li>
  <li><a href="#betweenness-centrality" id="toc-betweenness-centrality" class="nav-link" data-scroll-target="#betweenness-centrality"><span class="header-section-number">7.6.2</span> Betweenness centrality</a></li>
  <li><a href="#eigenvector-centrality" id="toc-eigenvector-centrality" class="nav-link" data-scroll-target="#eigenvector-centrality"><span class="header-section-number">7.6.3</span> Eigenvector centrality</a></li>
  </ul></li>
  <li><a href="#friendship-paradox" id="toc-friendship-paradox" class="nav-link" data-scroll-target="#friendship-paradox"><span class="header-section-number">7.7</span> Friendship paradox</a></li>
  <li><a href="#communities" id="toc-communities" class="nav-link" data-scroll-target="#communities"><span class="header-section-number">7.8</span> Communities</a>
  <ul class="collapse">
  <li><a href="#simulating-the-random-walk" id="toc-simulating-the-random-walk" class="nav-link" data-scroll-target="#simulating-the-random-walk"><span class="header-section-number">7.8.1</span> Simulating the random walk</a></li>
  <li><a href="#label-propagation" id="toc-label-propagation" class="nav-link" data-scroll-target="#label-propagation"><span class="header-section-number">7.8.2</span> Label propagation</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Networks</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
<p><span class="math display">\[
    \newcommand{\float}{\mathbb{F}}
    \newcommand{\real}{\mathbb{R}}
    \newcommand{\complex}{\mathbb{C}}
    \newcommand{\nat}{\mathbb{N}}
    \newcommand{\integer}{\mathbb{Z}}
    \newcommand{\bfa}{\mathbf{a}}
    \newcommand{\bfe}{\mathbf{e}}
    \newcommand{\bfh}{\mathbf{h}}
    \newcommand{\bfp}{\mathbf{p}}
    \newcommand{\bfq}{\mathbf{q}}
    \newcommand{\bfu}{\mathbf{u}}
    \newcommand{\bfv}{\mathbf{v}}
    \newcommand{\bfw}{\mathbf{w}}
    \newcommand{\bfx}{\mathbf{x}}
    \newcommand{\bfy}{\mathbf{y}}
    \newcommand{\bfz}{\mathbf{z}}
    \newcommand{\bfA}{\mathbf{A}}
    \newcommand{\bfW}{\mathbf{W}}
    \newcommand{\bfX}{\mathbf{X}}
    \newcommand{\bfzero}{\boldsymbol{0}}
    \newcommand{\bfmu}{\boldsymbol{\mu}}
    \newcommand{\TP}{\text{TP}}
    \newcommand{\TN}{\text{TN}}
    \newcommand{\FP}{\text{FP}}
    \newcommand{\FN}{\text{FN}}
    \newcommand{\rmn}[2]{\mathbb{R}^{#1 \times #2}}
    \newcommand{\dd}[2]{\frac{d #1}{d #2}}
    \newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
    \newcommand{\norm}[1]{\left\lVert \mathstrut #1 \right\rVert}
    \newcommand{\abs}[1]{\left\lvert \mathstrut #1 \right\rvert}
    \newcommand{\twonorm}[1]{\norm{#1}_2}
    \newcommand{\onenorm}[1]{\norm{#1}_1}
    \newcommand{\infnorm}[1]{\norm{#1}_\infty}
    \newcommand{\innerprod}[2]{\langle #1,#2 \rangle}
    \newcommand{\pr}[1]{^{(#1)}}
    \newcommand{\diag}{\operatorname{diag}}
    \newcommand{\sign}{\operatorname{sign}}
    \newcommand{\dist}{\operatorname{dist}}
    \newcommand{\simil}{\operatorname{sim}}
    \newcommand{\ee}{\times 10^}
    \newcommand{\floor}[1]{\lfloor#1\rfloor}
    \newcommand{\argmin}{\operatorname{argmin}}
    \newcommand{\E}[1]{\operatorname{\mathbb{E}}\left[\mathstrut #1\right]}
    \newcommand{\Cov}{\operatorname{Cov}}
    \newcommand{\logit}{\operatorname{logit}}
\]</span></p>
</div>
<div id="a5593009" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> default_rng</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">"figure.figsize"</span>] <span class="op">=</span> [<span class="fl">4.8</span>, <span class="fl">3.6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Many phenomena have a natural network structure. Obvious examples are social networks, transportation networks, and the Web, but other examples include cellular protein interactions, scientific citations, ecological predation, and many others.</p>
<section id="graphs" class="level2 page-columns page-full" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="graphs"><span class="header-section-number">7.1</span> Graphs</h2>
<p>In mathematics, a network is represented as a <strong>graph</strong>.</p>
<div id="def-networks-graph" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.1</strong></span> A graph is a collection of <strong>nodes</strong> (also called <em>vertices</em>) and <strong>edges</strong> that connect pairs of nodes.</p>
<p>In an <strong>undirected graph</strong>, the edge <span class="math inline">\((a,b)\)</span> is identical to <span class="math inline">\((b,a)\)</span>, while in a <strong>directed graph</strong> or <strong>digraph</strong>, <span class="math inline">\((a,b)\)</span> and <span class="math inline">\((b,a)\)</span> are different potential edges.</p>
<p>In either type of graph, each edge might be labeled with a numerical value, which results in a <strong>weighted graph</strong>.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_1vrlogst&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_23nhl7ne" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.1" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>Undirected, unweighted graphs will give us plenty to handle, and we will not go beyond them. We also will not allow graphs that have an edge from a node to itself.</p>
<p>We will use the NetworkX package to work with graphs.</p>
<div id="0a89fe1f" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="exm-networks-construct" class="theorem example" data-chapter="7" type="💻" data-description="Constructing networks/graphs">
<p><span class="theorem-title"><strong>Example 7.1</strong></span> One way to create a graph is from a list of edges:</p>
<div id="4776d87c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>star <span class="op">=</span> nx.Graph( [ (<span class="dv">1</span>,<span class="dv">2</span>),(<span class="dv">1</span>,<span class="dv">3</span>),(<span class="dv">1</span>,<span class="dv">4</span>),(<span class="dv">1</span>,<span class="dv">5</span>),(<span class="dv">1</span>,<span class="dv">6</span>) ] )</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>nx.draw(star, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-4-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Another way to create a graph is to give the start and end nodes of the edges as columns in a data frame:</p>
<div id="be0dac3c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>network <span class="op">=</span> pd.DataFrame( </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'from'</span>: [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>], <span class="st">'to'</span>: [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">1</span>]} </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(network)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> nx.from_pandas_edgelist(network, <span class="st">'from'</span>, <span class="st">'to'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>nx.draw(H, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   from  to
0     1   2
1     2   3
2     3   4
3     4   5
4     5   6
5     6   1</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-5-output-2.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can deconstruct a graph object into its constituent nodes and edges, as they are properties of the graph object. The results have special types that can be converted into sets, lists, or other objects.</p>
<div id="5adcb27c" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Nodes as a list:"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="bu">list</span>(star.nodes) )</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Nodes as an Index:"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( pd.Index(star.nodes) )</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Edges as a list:"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="bu">list</span>(star.edges) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nodes as a list:
[1, 2, 3, 4, 5, 6]

Nodes as an Index:
Index([1, 2, 3, 4, 5, 6], dtype='int64')

Edges as a list:
[(1, 2), (1, 3), (1, 4), (1, 5), (1, 6)]</code></pre>
</div>
</div>
<p>We can change the labels of the nodes to be whatever we want:</p>
<div id="0c54b75a" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>relabel <span class="op">=</span> pd.Series( [<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>,<span class="st">"e"</span>,<span class="st">"f"</span>], index<span class="op">=</span><span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">7</span>) )</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>star_letter <span class="op">=</span> nx.relabel_nodes(star, relabel )</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Edges as a list:"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="bu">list</span>(star_letter.edges) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Edges as a list:
[('a', 'b'), ('a', 'c'), ('a', 'd'), ('a', 'e'), ('a', 'f')]</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_h5jslr5z&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_wa9lv9al" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.1" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><div id="exm-networks-import" class="theorem example" data-chapter="7" type="💻" data-description="Importing networks">
<p><span class="theorem-title"><strong>Example 7.2</strong></span> There are many ways to read graphs from, and write them to, files. For example, here is a friend network among Twitch users:</p>
<div id="5f41d2a3" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>twitch <span class="op">=</span> nx.read_edgelist(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"_datasets/musae_edges.csv"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>     delimiter<span class="op">=</span><span class="st">','</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>     nodetype<span class="op">=</span><span class="bu">int</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The file just imported has a pair of node labels separated by commas on each line, representing one edge. The node labels can be any strings, but we overrode that above to interpret them as integers.</p>
<p>We will explore many functions that tell us facts about a graph. Here are two of the most fundamental:</p>
<div id="767e1887" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Twitch network has"</span>, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    twitch.number_of_nodes(), </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"nodes and"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    twitch.number_of_edges(),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"edges"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Twitch network has 7126 nodes and 35324 edges</code></pre>
</div>
</div>
<p>Due to its large size, this graph is difficult to draw in its entirety.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>As pointed out <a href="https://networkx.org/documentation/stable/reference/drawing.html">in its documentation</a>, the drawing tools provided by NetworkX are bare-bones, and you should look into alternatives if you will be using them heavily.</p>
</div>
</div>
<section id="sec-networks-zoo" class="level3 page-columns page-full" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="sec-networks-zoo"><span class="header-section-number">7.1.1</span> A graph menagerie</h3>
<p>There are functions that generate different well-studied types of graphs. The first graph constructed above is a <strong>star graph</strong>, and the graph <code>H</code> above is a <strong>cycle graph</strong>.</p>
<div id="e056bac2" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>nx.draw(nx.cycle_graph(<span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-10-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_7adqz4nu&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_i0b3xbgb" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.1.1" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
<p><br> <a href="_media/memes/cycle.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="_media/memes/cycle.jpg" class="img-fluid quarto-figure quarto-figure-center" width="200"></a></p>
</div></div><p>A cross between the star and the cycle is a <strong>wheel graph</strong>.</p>
<div id="18a5f600" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>nx.draw(nx.wheel_graph(<span class="dv">9</span>), node_size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-11-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="_media/memes/wheel.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="_media/memes/wheel.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="200"></a></p>
</figure>
</div>
</div></div><p>A <strong>complete graph</strong> is one that has every possible edge, i.e., all possible pairs of nodes are connected.</p>
<div id="497acc03" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>K5 <span class="op">=</span> nx.complete_graph(<span class="dv">5</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"5 nodes,"</span>, nx.number_of_edges(K5), <span class="st">"edges"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>nx.draw(K5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5 nodes, 10 edges</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-12-output-2.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="_media/memes/complete.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="_media/memes/complete.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="200"></a></p>
</figure>
</div>
</div></div><p>In a graph on <span class="math inline">\(n\)</span> nodes, there are</p>
<p><span class="math display">\[
\binom{n}{2} = \frac{n!}{(n-2)!2!} = \frac{n(n-1)}{2}
\]</span></p>
<p>unique pairs of distinct nodes, not counting ordering. Hence, there are <span class="math inline">\(\binom{n}{2}\)</span> edges in the undirected complete graph on <span class="math inline">\(n\)</span> nodes.</p>
<p>A <strong>lattice graph</strong> has a regular structure, like graph paper.</p>
<div id="3f50bd7d" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>lat <span class="op">=</span> nx.grid_graph( (<span class="dv">5</span>,<span class="dv">4</span>) )</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lat.number_of_nodes(), <span class="st">"nodes,"</span>, lat.number_of_edges(), <span class="st">"edges"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>nx.draw(lat, node_size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20 nodes, 31 edges</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-13-output-2.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="_media/memes/grid.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="_media/memes/grid.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="200"></a></p>
</figure>
</div>
</div></div><p>In an <span class="math inline">\(m\times n\)</span> lattice graph, there are <span class="math inline">\(m-1\)</span> edges in one direction repeated <span class="math inline">\(n\)</span> times, plus <span class="math inline">\(n-1\)</span> edges in the other direction, repeated <span class="math inline">\(m\)</span> times. Thus there are</p>
<p><span class="math display">\[
(m-1)n + (n-1)m = 2mn-(m+n)
\]</span></p>
<p>edges altogether.</p>
<p>There are different ways to draw a particular graph in the plane, as determined by the positions of the nodes. The default is to imagine that the edges are springs pulling on the nodes. But there are alternatives that may be useful at times.</p>
<div id="ed4761ee" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>nx.draw_circular(lat, node_size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-14-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As you can see, it’s not easy to tell how similar two graphs are by comparing renderings of them.</p>
</section>
<section id="neighbors" class="level3 page-columns page-full" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="neighbors"><span class="header-section-number">7.1.2</span> Neighbors</h3>
<p>The essence of a graph is how each node connects to others.</p>
<div id="def-networks-adjacency" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.2</strong></span> Nodes are said to be <strong>adjacent</strong> if they share an edge. The <strong>neighbors</strong> of a node are the nodes that are adjacent to it.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_itppnnq4&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_sxacabrk" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.1.2" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><div id="exm-networks-neighbors" class="theorem example" data-chapter="7" type="💻" data-description="Neighbors of a node">
<p><span class="theorem-title"><strong>Example 7.3</strong></span> We get the neighbors of a node by using it as an index on the graph object. As with nodes and edges, we usually need to convert the result into a more convenient form:</p>
<div id="a3329444" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"Neighbors of node 1 in the star graph:"</span>, <span class="bu">list</span>(star[<span class="dv">1</span>]) )</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"Neighbors of node 6 in the star graph:"</span>, <span class="bu">list</span>(star[<span class="dv">6</span>]) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbors of node 1 in the star graph: [2, 3, 4, 5, 6]
Neighbors of node 6 in the star graph: [1]</code></pre>
</div>
</div>
</div>
<div id="exm-networks-ego" class="theorem example" data-chapter="7" type="💻" data-description="Ego graph">
<p><span class="theorem-title"><strong>Example 7.4</strong></span> We can zoom in on a subset of the Twitch graph by selecting a node and its <strong>ego graph</strong>, which includes its neighbors along with all edges between the captured nodes:</p>
<div id="3c1b5307" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ego <span class="op">=</span> nx.ego_graph(twitch, <span class="dv">400</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>nx.draw(ego, with_labels<span class="op">=</span><span class="va">True</span>, node_size<span class="op">=</span><span class="dv">800</span>, node_color<span class="op">=</span><span class="st">"yellow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-16-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notice that the nodes of the ego network have the same labels as they did in the graph that it was taken from. We can widen the ego graph to include the ego graphs of all the neighbors:</p>
<div id="6440759e" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>big_ego <span class="op">=</span> nx.ego_graph(twitch, <span class="dv">400</span>, radius<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(big_ego.number_of_nodes(), <span class="st">"nodes and"</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    big_ego.number_of_edges(), <span class="st">"edges"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>nx.draw(big_ego, </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="fl">0.2</span>, node_size<span class="op">=</span><span class="dv">10</span>, node_color<span class="op">=</span><span class="st">"purple"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>528 nodes and 1567 edges</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-17-output-2.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_y9tl9mt9&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_w5s4ez33" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.4" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>We can represent all the adjacency relationships at once using a matrix.</p>
<div id="def-networks-adjmatrix" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.3</strong></span> If we number the nodes of a graph from <span class="math inline">\(0\)</span> to <span class="math inline">\(n-1\)</span>, then its <strong>adjacency matrix</strong> is the <span class="math inline">\(n\times n\)</span> matrix whose entries are <span class="math display">\[
A_{ij} = \begin{cases}
    1, &amp; \text{if $(i,j)$ is an edge}, \\
    0, &amp; \text{otherwise.}
    \end{cases}
\]</span></p>
</div>
<p>In an undirected graph, we have <span class="math display">\[
A_{ij}=A_{ji},
\]</span></p>
<p>for all valid indices, so adjacency matrices in an undirected graph are symmetric.</p>
<div id="exm-networks-adjmatrix" class="theorem example" data-chapter="7" type="💻" data-description="Adjacency matrix">
<p><span class="theorem-title"><strong>Example 7.5</strong></span> The star graph defined in <a href="#sec-networks-zoo" class="quarto-xref"><span>Section 7.1.1</span></a> has the following adjacency matrix:</p>
<div id="503435e4" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> nx.adjacency_matrix(star)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>&lt;Compressed Sparse Row sparse array of dtype 'int64'
    with 10 stored elements and shape (6, 6)&gt;</code></pre>
</div>
</div>
<p>The matrix <code>A</code> is not stored in the format we have been used to. In a large network we would expect most of its entries to be zero, so it makes more sense to store it as a <em>sparse matrix</em>, where we keep track of only the nonzero entries.</p>
<div id="f2d279c7" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Compressed Sparse Row sparse array of dtype 'int64'
    with 10 stored elements and shape (6, 6)&gt;
  Coords    Values
  (0, 1)    1
  (0, 2)    1
  (0, 3)    1
  (0, 4)    1
  (0, 5)    1
  (1, 0)    1
  (2, 0)    1
  (3, 0)    1
  (4, 0)    1
  (5, 0)    1</code></pre>
</div>
</div>
<p>We can easily convert <code>A</code> to a standard array, if it is not too large to fit in memory.</p>
<div id="1e268b78" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>A.toarray()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array([[0, 1, 1, 1, 1, 1],
       [1, 0, 0, 0, 0, 0],
       [1, 0, 0, 0, 0, 0],
       [1, 0, 0, 0, 0, 0],
       [1, 0, 0, 0, 0, 0],
       [1, 0, 0, 0, 0, 0]])</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_vq62b96w&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_1gcl0xu8" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.5" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div></section>
<section id="degree" class="level3 page-columns page-full" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="degree"><span class="header-section-number">7.1.3</span> Degree</h3>
<div id="def-networks-degree" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.4</strong></span> The <strong>degree</strong> of a node is the number of neighbors it has. The <strong>average degree</strong> of a graph is the mean of the degrees of all of its nodes.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_hjyyr0d6&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_q6qiam9e" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.1.3" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>It’s common to use the notation <span class="math inline">\(\bar{k}\)</span> for the average degree of a graph.</p>
<p>The <code>degree</code> property of a NetworkX graph gives an object of all nodes with their degrees.</p>
<div id="exm-networks-degree" class="theorem example" data-chapter="7" type="💻" data-description="Node degrees">
<p><span class="theorem-title"><strong>Example 7.6</strong></span> Continuing with the graph from <a href="#exm-networks-ego" class="quarto-xref">Example&nbsp;<span>7.4</span></a>:</p>
<div id="ce3b91b5" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ego.degree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>DegreeView({897: 2, 400: 9, 5394: 2, 3379: 3, 4406: 1, 5079: 1, 6136: 2, 5049: 1, 6107: 1, 639: 2})</code></pre>
</div>
</div>
<p>The result here can be a bit awkward to work with; it’s actually a <em>generator</em> of a list, rather than the list itself. (This “lazy” attitude is useful when dealing with very large networks.) We can transform it into different forms, such as a dictionary:</p>
<div id="8c3627b5" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">dict</span>(ego.degree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>{897: 2,
 400: 9,
 5394: 2,
 3379: 3,
 4406: 1,
 5079: 1,
 6136: 2,
 5049: 1,
 6107: 1,
 639: 2}</code></pre>
</div>
</div>
<p>Given our comfort level with pandas, it might be most convenient to use a series or frame to keep track of such quantities:</p>
<div id="94632256" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>degrees <span class="op">=</span> pd.Series( <span class="bu">dict</span>(ego.degree) )</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>degrees</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>897     2
400     9
5394    2
3379    3
4406    1
5079    1
6136    2
5049    1
6107    1
639     2
dtype: int64</code></pre>
</div>
</div>
<p>We can then do familiar calculations:</p>
<div id="409e33e5" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"mean degree of ego graph:"</span>, degrees.mean())</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"median degree of ego graph:"</span>, degrees.median())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mean degree of ego graph: 2.4
median degree of ego graph: 2.0</code></pre>
</div>
</div>
<p>As we are about to see, though, there’s an easier way to compute the average degree.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_0ho332qk&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_0szkxms6" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.6" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
<p><br> <a href="_media/memes/degree.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="_media/memes/degree.jpg" class="img-fluid quarto-figure quarto-figure-center" width="200"></a></p>
</div></div><p>Here is our first nontrivial fact about graphs.</p>
<div id="thm-networks-degree" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7.1</strong></span> Suppose a graph has <span class="math inline">\(n\)</span> nodes and <span class="math inline">\(m\)</span> edges. Then its average degree satisfies <span class="math display">\[
\bar{k} = \frac{2m}{n},
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>If we sum the degrees of all the nodes, we must get <span class="math inline">\(2m\)</span>, because each edge will have been contributed twice to the summation. Dividing by <span class="math inline">\(n\)</span> gives the mean.</p>
</div>
<div id="exm-networks-avgdegree" class="theorem example" data-chapter="7" type="💻" data-description="Average degree">
<p><span class="theorem-title"><strong>Example 7.7</strong></span> Just to check the theorem on the ego graph from <a href="#exm-networks-ego" class="quarto-xref">Example&nbsp;<span>7.4</span></a>:</p>
<div id="cc049c1e" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">*</span>ego.number_of_edges() <span class="op">/</span> ego.number_of_nodes()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>2.4</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="random-graphs" class="level2 page-columns page-full" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="random-graphs"><span class="header-section-number">7.2</span> Random graphs</h2>
<p>One way of understanding a real-world network is by comparing it to ones that are constructed randomly, but according to relatively simple rules. The idea is that if the real network behaves similarly to members of some random family, then perhaps it is constructed according to similar principles.</p>
<section id="erdős-rényi-graphs" class="level3 page-columns page-full" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="erdős-rényi-graphs"><span class="header-section-number">7.2.1</span> Erdős-Rényi graphs</h3>
<p>Our first construction gives every potential edge an equal chance to exist.</p>
<p>Start with <span class="math inline">\(n\)</span> nodes and no edges. Suppose you have a weighted coin that comes up heads (100p)% of the time. For each pair of nodes, you toss the coin, and if it comes up heads, you add the edge between those nodes. This is known as an <em>ER graph</em>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_5u0jo6x8&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_ud78lqic" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.2.1" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><div id="def-networks-ER" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.5</strong></span> An <strong>Erdős-Rényi graph</strong> (ER graph) is a graph in which each potential edge occurs with a fixed probability <span class="math inline">\(p\)</span>.</p>
</div>
<p>Since there are <span class="math inline">\(\binom{n}{2}\)</span> unique unordered pairs among <span class="math inline">\(n\)</span> nodes, the mean number of edges in an ER graph is <span class="math display">\[
p\binom{n}{2} = \frac{pn(n-1)}{2}.
\]</span> This fact is usually stated in terms of the average node degree.</p>
<div id="thm-networks-degree-ER" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7.2</strong></span> The average degree <span class="math inline">\(\bar{k}\)</span> satisfies <span class="math display">\[
\E{\bar{k}} = \frac{1}{n} pn(n-1) = p(n-1),
\]</span> where the expectation operation is taken over all realizations of ER graphs on <span class="math inline">\(n\)</span> nodes.</p>
</div>
<p>There are two senses of averaging going on in <a href="#thm-networks-degree-ER" class="quarto-xref">Theorem&nbsp;<span>7.2</span></a>:. We take the average (expectation operation) over all random instances of the average degree over all nodes within the instance.</p>
<div id="exm-networks-degree-ER" class="theorem example" data-chapter="7" type="💻" data-description="ER graphs">
<p><span class="theorem-title"><strong>Example 7.8</strong></span> &nbsp;</p>
<div id="87b2e4df" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> <span class="dv">50</span>, <span class="fl">0.08</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ER <span class="op">=</span> nx.erdos_renyi_graph(n, p, seed<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ER.number_of_nodes(), <span class="st">"nodes,"</span>, ER.number_of_edges(), <span class="st">"edges"</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>nx.draw_circular(ER, node_size<span class="op">=</span><span class="dv">50</span>, edge_color<span class="op">=</span><span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>50 nodes, 91 edges</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-26-output-2.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here is the distribution of <span class="math inline">\(\bar{k}\)</span> over 20000 ER instances:</p>
<div id="4534a308" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> average_degree(G):</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>G.number_of_edges() <span class="op">/</span> G.number_of_nodes()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>kbar <span class="op">=</span> []</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> <span class="dv">41</span>, <span class="fl">0.1</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20000</span>):</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    ER <span class="op">=</span> nx.erdos_renyi_graph(n, p, seed<span class="op">=</span><span class="bu">iter</span> <span class="op">+</span> <span class="dv">302</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    kbar.append( average_degree(ER) )</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>sns.displot( x<span class="op">=</span>kbar, bins<span class="op">=</span><span class="dv">23</span> )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-27-output-1.png" width="469" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The mean of this distribution converges to <span class="math inline">\(p(n-1)=4\)</span> as the number of random instances goes to infinity.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_olxptbyc&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_0288pbd0" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.8" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p><a href="#thm-networks-degree" class="quarto-xref">Theorem&nbsp;<span>7.1</span></a> states that the average degree in a graph with <span class="math inline">\(n\)</span> nodes and <span class="math inline">\(m\)</span> edges is <span class="math inline">\(2m/n\)</span>. According to <a href="#thm-networks-degree-ER" class="quarto-xref">Theorem&nbsp;<span>7.2</span></a>, an ER graph will have the same expected average degree if <span id="eq-networks-ER-prob"><span class="math display">\[
\frac{2m}{n} = p(n-1),
\tag{7.1}\]</span></span></p>
<p>or <span class="math inline">\(p=2m/(n^2-n)\)</span>.</p>
<p>In <a href="#exm-networks-import" class="quarto-xref">Example&nbsp;<span>7.2</span></a>, for example, we found that our Twitch network has <span class="math inline">\(n=7126\)</span> nodes and <span class="math inline">\(m=35324\)</span> edges, which suggests an ER equivalent of <span class="math display">\[
p = \frac{2(35324)}{(7126)(7125)} \approx 0.001391.
\]</span></p>
<p>That is, if connections in the Twitch network were made completely at random, they would have to occur at a probability of about <span class="math inline">\(0.14\)</span>%.</p>
</section>
<section id="wattsstrogatz-graphs" class="level3 page-columns page-full" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="wattsstrogatz-graphs"><span class="header-section-number">7.2.2</span> Watts–Strogatz graphs</h3>
<p>A <strong>Watts–Strogatz graph</strong> (WS graph) is a crude model of human social relationships. A WS graph has three parameters: <span class="math inline">\(n\)</span>, an even integer <span class="math inline">\(k\)</span>, and a probability <span class="math inline">\(q\)</span>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_z6d36f0c&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_f9yo20e1" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.2.2" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>Imagine <span class="math inline">\(n\)</span> nodes arranged in a circle. In the first phase, we connect each node with an edge to all of its <span class="math inline">\(k/2\)</span> left neighbors and <span class="math inline">\(k/2\)</span> right neighbors. This setup, called a <strong>ring lattice</strong>, represents the idea that people have a local network of friends.</p>
<p>In the next phase, we rewire some of the local relationships into far-flung ones. We visit each node <span class="math inline">\(i\)</span> in turn. For each edge from <span class="math inline">\(i\)</span> to a neighbor, with probability <span class="math inline">\(q\)</span> we replace it with an edge between <span class="math inline">\(i\)</span> and a node chosen at random from all the nodes <span class="math inline">\(i\)</span> currently not adjacent to <span class="math inline">\(i\)</span>.</p>
<div id="exm-networks-WS" class="theorem example" data-chapter="7" type="💻" data-description="WS graphs">
<p><span class="theorem-title"><strong>Example 7.9</strong></span> If we set <span class="math inline">\(q=0\)</span>, we disable the rewiring phase and get a regular ring lattice:</p>
<div id="0bf17dcf" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>WS <span class="op">=</span> nx.watts_strogatz_graph(<span class="dv">13</span>, <span class="dv">4</span>, <span class="dv">0</span>, seed<span class="op">=</span><span class="dv">302</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>nx.draw_circular(WS, node_size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-28-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As <span class="math inline">\(q\)</span> increases, we introduce more randomness:</p>
<div id="fdc7fb27" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>WS <span class="op">=</span> nx.watts_strogatz_graph(<span class="dv">13</span>, <span class="dv">4</span>, <span class="fl">0.25</span>, seed<span class="op">=</span><span class="dv">302</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>nx.draw_circular(WS, node_size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-29-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Taken to the limit <span class="math inline">\(q=1\)</span>, we end up with something that loses the mostly-local structure:</p>
<div id="cbe49cac" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>WS <span class="op">=</span> nx.watts_strogatz_graph(<span class="dv">13</span>, <span class="dv">4</span>, <span class="fl">1.0</span>, seed<span class="op">=</span><span class="dv">302</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>nx.draw_circular(WS, node_size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-30-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_0ljq2qqg&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_ddhp5q6a" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.9" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
<p><br> <a href="_media/memes/bacon.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="_media/memes/bacon.jpg" class="img-fluid quarto-figure quarto-figure-center" width="200"></a></p>
</div></div><p>In the initial setup phase, every node in the WS graph has degree equal to <span class="math inline">\(k\)</span>. The rewiring phase only changes edges—it does not insert nor delete them—so the average degree remains <span class="math inline">\(k\)</span>.</p>
<div id="thm-networks-WS" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7.3</strong></span> A WS graph of type <span class="math inline">\((n,k,q)\)</span> has average node degree equal to <span class="math inline">\(k\)</span>.</p>
</div>
<p>Because of this result and <a href="#thm-networks-degree" class="quarto-xref">Theorem&nbsp;<span>7.1</span></a>, we have <span class="math display">\[
k = \frac{2m}{n}
\]</span></p>
<p>to get a WS graph of the same average degree as any other graph with <span class="math inline">\(n\)</span> nodes and <span class="math inline">\(m\)</span> edges. Keep in mind that we are constrained to use an even integer for <span class="math inline">\(k\)</span>, so this relation usually can hold only approximately.</p>
</section>
</section>
<section id="clustering" class="level2 page-columns page-full" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="clustering"><span class="header-section-number">7.3</span> Clustering</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The term <em>clustering</em> has a meaning in network analysis that has little to do with our earlier use of <em>clustering</em> for samples in a feature matrix.</p>
</div>
</div>
<p>In your own social networks, your friends are probably more likely to be friends with each other than pure randomness would imply. There are various ways to quantify this effect precisely, but here is one of the simplest.</p>
<div id="def-networks-clustering" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.6</strong></span> The <strong>local clustering coefficient</strong> for node <span class="math inline">\(i\)</span> is <span class="math display">\[
C(i) = \frac{ 2 T(i) }{d_i(d_i-1)},
\]</span> where <span class="math inline">\(d_i\)</span> is the degree of the node and <span class="math inline">\(T(i)\)</span> is the number of triangles in the ego graph of node <span class="math inline">\(i\)</span>. If <span class="math inline">\(d_i=0\)</span> or <span class="math inline">\(d_i=1\)</span>, we set <span class="math inline">\(C(i)=0\)</span>.</p>
</div>
<p>The value of <span class="math inline">\(T(i)\)</span> is the same as the number of edges between node <span class="math inline">\(i\)</span>’s neighbors. Because there are <span class="math inline">\(\binom{d_i}{2}\)</span> unique pairs of neighbors, the value of <span class="math inline">\(C(i)\)</span> is between 0 and 1.</p>
<div id="exm-networks-cluster-small-world" class="theorem example" data-chapter="7" type="✍️" data-description="Clustering coefficient">
<p><span class="theorem-title"><strong>Example 7.10</strong></span> Let’s find the clustering coefficient for each node in this wheel graph:</p>
<div id="4ac0dd7c" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> nx.wheel_graph(<span class="dv">7</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>nx.draw(W, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-31-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Node 0 is adjacent to 6 other nodes, and there are 6 triangles that include it. Thus, its clustering coefficient is <span class="math display">\[
C(0) = \frac{6}{6 \cdot 5 / 2} = \frac{2}{5}.
\]</span> Every other node has 3 neighbors and 2 triangles, so they each have <span class="math display">\[
C(i) = \frac{2}{3 \cdot 2 / 2} = \frac{2}{3}, \quad i\neq 0.
\]</span></p>
<p>The <code>clustering</code> function in NetworkX computes <span class="math inline">\(C(i)\)</span> for any single node: or for all the nodes in a graph.</p>
<div id="9c5bff62" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"node 0 clustering is </span><span class="sc">{</span>nx<span class="sc">.</span>clustering(W, <span class="dv">0</span>)<span class="sc">:.7f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>node 0 clustering is 0.4000000</code></pre>
</div>
</div>
<p>If not given a node label, the <code>clustering</code> function returns a dictionary of the clustering coefficients for all of the nodes. As usual, we can convert that output to a series or data frame.</p>
<div id="fe168483" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">clustering at each node:"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( pd.Series(nx.clustering(W)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
clustering at each node:
0    0.400000
1    0.666667
2    0.666667
3    0.666667
4    0.666667
5    0.666667
6    0.666667
dtype: float64</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_zo6715v5&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_m7eg10h2" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.10" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><div id="exm-networks-cluster-twitch" class="theorem example" data-chapter="7" type="💻" data-description="Clustering in the Twitch network">
<p><span class="theorem-title"><strong>Example 7.11</strong></span> Let’s examine clustering within the Twitch network:</p>
<div id="3d321b62" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>twitch <span class="op">=</span> nx.read_edgelist(<span class="st">"_datasets/musae_edges.csv"</span>, delimiter<span class="op">=</span><span class="st">','</span>, nodetype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>cluster <span class="op">=</span> pd.Series(nx.clustering(twitch))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>cluster.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>6194    0.066667
255     0.133333
980     0.065359
2992    0.000000
2507    0.073593
dtype: float64</code></pre>
</div>
</div>
<p>The average clustering coefficient is</p>
<div id="dabd298f" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="ss">f"average Twitch clustering is </span><span class="sc">{</span>cluster<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>average Twitch clustering is 0.1309</code></pre>
</div>
</div>
<p>Suppose we want to explore the relationship between clustering and degree in the network. It’s most convenient to store both values as columns of a data frame:</p>
<div id="5f1af526" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>props <span class="op">=</span> pd.DataFrame()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>props[<span class="st">"clustering"</span>] <span class="op">=</span> nx.clustering(twitch)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>props[<span class="st">"degree"</span>] <span class="op">=</span> <span class="bu">dict</span>(twitch.degree)   <span class="co"># degree view converted to dict</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>props.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">clustering</th>
<th data-quarto-table-cell-role="th">degree</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">6194</td>
<td>0.066667</td>
<td>6</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">255</td>
<td>0.133333</td>
<td>6</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">980</td>
<td>0.065359</td>
<td>18</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2992</td>
<td>0.000000</td>
<td>4</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2507</td>
<td>0.073593</td>
<td>22</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here’s the distribution of clustering coefficients:</p>
<div id="5659a303" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>props, x<span class="op">=</span><span class="st">"clustering"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-37-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>There is a huge number of clustering values at zero. A plot of both quantities clarifies that these are due to nodes of degree 1:</p>
<div id="d9458519" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>props, x<span class="op">=</span><span class="st">"degree"</span>, y<span class="op">=</span><span class="st">"clustering"</span>, kind<span class="op">=</span><span class="st">"line"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-38-output-1.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Other than that massive group, there is a negative association between degree and clustering coefficient in this network.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_t0aghuno&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_ev8aizw3" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.11" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><section id="er-graphs" class="level3 page-columns page-full" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="er-graphs"><span class="header-section-number">7.3.1</span> ER graphs</h3>
<div id="thm-networks-clustering-ER" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7.4</strong></span> The expected value of the average clustering coefficient in ER graphs of type <span class="math inline">\((n,p)\)</span> is <span class="math inline">\(p\)</span>.</p>
</div>
<p>A formal proof of this theorem is largely superfluous. Considering that each edge in the graph has a probability <span class="math inline">\(p\)</span> of inclusion, then <span class="math inline">\(p\)</span> is also the expected fraction of edges that appear within the neighborhood subgraph of any node.</p>
<div id="exm-networks-cluster-er" class="theorem example" data-chapter="7" type="💻" data-description="Clustering in ER graphs">
<p><span class="theorem-title"><strong>Example 7.12</strong></span> Let’s compute average clustering within multiple ER random graphs.</p>
<div id="23cb0965" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>n,p <span class="op">=</span> <span class="dv">121</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">20</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">400</span>):</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    ER <span class="op">=</span> nx.erdos_renyi_graph(n, p, seed<span class="op">=</span><span class="bu">iter</span><span class="op">+</span><span class="dv">5000</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    results.append( nx.average_clustering(ER) )</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>sns.displot(x<span class="op">=</span>results)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-39-output-1.png" width="469" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The distribution above can’t be normal, because there are hard bounds at 0 and 1, but it looks similar to a normal distribution. The peak is at the value of <span class="math inline">\(p\)</span> used in the simulation, in accordance with <a href="#thm-networks-clustering-ER" class="quarto-xref">Theorem&nbsp;<span>7.4</span></a>.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_gtojpji6&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_w1i5bvtd" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.12" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>In <a href="#exm-networks-cluster-twitch" class="quarto-xref">Example&nbsp;<span>7.11</span></a>, we saw that the Twitch network has <span class="math inline">\(n=7126\)</span> and mean clustering equal to about 0.131. If an ER graph is expected to have that same mean clustering, then we must take <span class="math inline">\(p=0.131\)</span>, according to <a href="#thm-networks-clustering-ER" class="quarto-xref">Theorem&nbsp;<span>7.4</span></a>. But by <a href="#thm-networks-degree-ER" class="quarto-xref">Theorem&nbsp;<span>7.2</span></a>, this would imply an average node degree of <span class="math inline">\(p(n-1)\approx 933\)</span>, which is almost 10 times larger than what is actually observed! Thus, clustering strongly suggests that the Twitch network is not much like an ER graph.</p>
</section>
<section id="ws-graphs" class="level3 page-columns page-full" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="ws-graphs"><span class="header-section-number">7.3.2</span> WS graphs</h3>
<p>The initial setup of a WS graph of type <span class="math inline">\((n,k,q)\)</span> is highly clustered by design (see <a href="#exr-networks-ring-lattice" class="quarto-xref">Exercise&nbsp;<span>7.9</span></a>). If <span class="math inline">\(q\)</span> is close to zero, the final graph will retain much of this initial clustering. However, the average clustering coefficient tends to decrease as <span class="math inline">\(q\)</span> increases.</p>
<div id="exm-networks-cluster-WS" class="theorem example" data-chapter="7" type="💻" data-description="Clustering of WS graphs">
<p><span class="theorem-title"><strong>Example 7.13</strong></span> Here is an experiment to observe how the average clustering in a WS graph depends on the rewiring probability <span class="math inline">\(q\)</span>:</p>
<div id="e2a10c33" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>n, k <span class="op">=</span> <span class="dv">60</span>, <span class="dv">6</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">302</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q <span class="kw">in</span> np.arange(<span class="fl">0.05</span>, <span class="fl">1.05</span>, <span class="fl">0.05</span>):</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">60</span>):</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>        WS <span class="op">=</span> nx.watts_strogatz_graph(n, k, q, seed<span class="op">=</span>seed<span class="op">+</span><span class="dv">10</span><span class="op">*</span><span class="bu">iter</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>        results.append( (q, nx.average_clustering(WS)) )</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame( results, columns<span class="op">=</span>[<span class="st">"q"</span>, <span class="st">"mean clustering"</span>] )</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean clustering in WS graphs on 60 nodes:"</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>results,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"q"</span>, y<span class="op">=</span><span class="st">"mean clustering"</span>,</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    kind<span class="op">=</span><span class="st">"line"</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean clustering in WS graphs on 60 nodes:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-40-output-2.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Let’s scale the experiment above up to the size of the Twitch network. Conveniently, the average degree in that network is roughly 10, which is the value we will use for <span class="math inline">\(k\)</span> in the WS construction. To save computation time, we use just one WS realization at each value of <span class="math inline">\(q\)</span>.</p>
<div id="ea43f8d9" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>n, k <span class="op">=</span> twitch.number_of_nodes(), <span class="dv">10</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">19716</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q <span class="kw">in</span> np.arange(<span class="fl">0.15</span>, <span class="fl">0.51</span>, <span class="fl">0.05</span>):</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    WS <span class="op">=</span> nx.watts_strogatz_graph(n, k, q, seed<span class="op">=</span>seed)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    results.append( (q, nx.average_clustering(WS)) )</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>pd.DataFrame( results, columns<span class="op">=</span>[<span class="st">"q"</span>, <span class="st">"mean clustering"</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">q</th>
<th data-quarto-table-cell-role="th">mean clustering</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>0.15</td>
<td>0.415477</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>0.20</td>
<td>0.347262</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>0.25</td>
<td>0.286947</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>0.30</td>
<td>0.232891</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>0.35</td>
<td>0.184559</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">5</td>
<td>0.40</td>
<td>0.146123</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">6</td>
<td>0.45</td>
<td>0.112606</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">7</td>
<td>0.50</td>
<td>0.085669</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The mean clustering for the Twitch network was found to be about 0.131 in <a href="#exm-networks-cluster-twitch" class="quarto-xref">Example&nbsp;<span>7.11</span></a>. From the above, it appears that the WS graphs will have a similar mean clustering at around <span class="math inline">\(q=0.42\)</span>. Let’s freeze <span class="math inline">\(q\)</span> there and try more WS realizations to check:</p>
<div id="5a328d77" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">3383</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>n, k, q <span class="op">=</span> twitch.number_of_nodes(), <span class="dv">10</span>, <span class="fl">0.42</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>cbar <span class="op">=</span> []</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    WS <span class="op">=</span> nx.watts_strogatz_graph(n, k, q, seed<span class="op">=</span>seed)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    cbar.append( nx.average_clustering(WS) )</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">+=</span> <span class="dv">10</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="ss">f"avg WS clustering at q = 0.42 is </span><span class="sc">{</span>np<span class="sc">.</span>mean(cbar)<span class="sc">:.4f}</span><span class="ss">"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>avg WS clustering at q = 0.42 is 0.1327</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_btoabd6z&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_6p6b27l8" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.13" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
<p><br> <a href="_media/memes/cluster.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="_media/memes/cluster.png" class="img-fluid quarto-figure quarto-figure-center" width="200"></a></p>
</div></div><p>So far, the WS construction gives a plausible way to reconstruct the clustering observed in the Twitch network. However, there are many other graph properties left to examine!</p>
</section>
</section>
<section id="distance" class="level2 page-columns page-full" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="distance"><span class="header-section-number">7.4</span> Distance</h2>
<p>The <em>small-world phenomenon</em> is, broadly speaking, the observation that any two people in a large group can be connected by a surprisingly short path of acquaintances. This concept appears, for instance, in the <em>Bacon number game</em>, where actors are nodes, appearing in the same movie creates an edge between them, and one tries to find the distance between Kevin Bacon and some other designated actor.</p>
<div id="def-networks-distance" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.7</strong></span> A <strong>path</strong> from node <span class="math inline">\(x\)</span> to node <span class="math inline">\(y\)</span> is a sequence of edges in the graph, either the singleton sequence <span class="math inline">\((x,y)\)</span>, or <span class="math display">\[
(x,z_1),\, (z_1,z_2)\, (z_2,z_3)\, \ldots, (z_{t-1},z_t)\, (z_t,y),
\]</span></p>
<p>for some <span class="math inline">\(t\ge 1\)</span>. The path above has <strong>length</strong> <span class="math inline">\(t+1\)</span>, which is the number of edges in the path. The <strong>distance</strong> between two nodes in a graph is the length of the shortest path between them. The maximum distance over all pairs of nodes in a graph is called its <strong>diameter</strong>.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="https://www.dropbox.com/s/5nue68tr24nwdon/Section7_4.mp4?raw=1"></video></div>
</div></div><div id="exm-networks-distance-complete" class="theorem example" data-chapter="7" type="✍️" data-description="Distances in a complete graph">
<p><span class="theorem-title"><strong>Example 7.14</strong></span> In a complete graph, all possible pairs of nodes are directly connected by edges. Therefor, distance between any pair of distinct nodes is 1, and the graph has diameter 1.</p>
</div>
<p>Because the diameter depends on the extreme outlier of the distance distribution, it’s often more useful to consider the <strong>average distance</strong> by taking the mean.</p>
<div id="exm-networks-distance-wheel" class="theorem example" data-chapter="7" type="💻" data-description="Distances in a wheel graph">
<p><span class="theorem-title"><strong>Example 7.15</strong></span> Here is a small wheel graph:</p>
<div id="03759c04" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> nx.wheel_graph(<span class="dv">7</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>nx.draw(W, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-43-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>No node is more than two hops away from another, so the diameter of this graph is 2. This graph has so few nodes that we can easily compute the entire matrix of pairwise distances:</p>
<div id="af42dc5a" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>distance <span class="op">=</span> <span class="bu">dict</span>( nx.all_pairs_shortest_path_length(W) )</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> np.array( [ [distance[i][j] <span class="cf">for</span> j <span class="kw">in</span> W.nodes] <span class="cf">for</span> i <span class="kw">in</span> W.nodes] )</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(D)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0 1 1 1 1 1 1]
 [1 0 1 2 2 2 1]
 [1 1 0 1 2 2 2]
 [1 2 1 0 1 2 2]
 [1 2 2 1 0 1 2]
 [1 2 2 2 1 0 1]
 [1 1 2 2 2 1 0]]</code></pre>
</div>
</div>
<p>If all we want is the average distance, though, there is a convenience function for computing it directly:</p>
<div id="2d7839d4" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mean_dist <span class="op">=</span> nx.average_shortest_path_length(W)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The average distance is </span><span class="sc">{</span>mean_dist<span class="sc">:.5f}</span><span class="ss">"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The average distance is 1.42857</code></pre>
</div>
</div>
<p>This function becomes quite slow as the number of nodes grows. In practice, the average distance might be estimated by taking a sample from the set of all possible pairs.</p>
</div>
<section id="connectedness" class="level3 page-columns page-full" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="connectedness"><span class="header-section-number">7.4.1</span> Connectedness</h3>
<p>It could happen that there is a pair of nodes that is not connected by any path of edges. In that case, the distance between them is either undefined or infinite, and we say the graph is <strong>disconnected</strong>. In such a situation, it’s common to decompose the graph into <strong>connected components</strong>, a separation of the nodes into connected subgraphs.</p>
<div id="exm-networks-connected" class="theorem example" data-chapter="7" type="✍️" data-description="Connectedness">
<p><span class="theorem-title"><strong>Example 7.16</strong></span> The following graph is clearly connected:</p>
<div id="6c9fa7a5" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.lollipop_graph(<span class="dv">5</span>,<span class="dv">3</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>nx.draw(G, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"yellow"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-46-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>NetworkX has a function to determine this for us:</p>
<div id="173fb811" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>nx.is_connected(G)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>True</code></pre>
</div>
</div>
<p>If we remove the edge between nodes 4 and 5, then the graph is no longer connected:</p>
<div id="f20f7edb" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>G.remove_edge(<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Is it connected?"</span>, nx.is_connected(G))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>nx.draw(G, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"yellow"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Is it connected? False</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-48-output-2.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We get an error if we try to compute all the distances in a disconnected graph:</p>
<div id="0d623241" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>nx.average_shortest_path_length(G)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NetworkXError</span>                             Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[48], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">nx</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">average_shortest_path_length</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">G</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/mambaforge/envs/21924F/lib/python3.12/site-packages/networkx/utils/backends.py:412</span>, in <span class="ansi-cyan-fg">_dispatch.__call__</span><span class="ansi-blue-fg">(self, backend, *args, **kwargs)</span>
<span class="ansi-green-fg ansi-bold">    409</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">__call__</span>(<span style="color:rgb(0,135,0)">self</span>, <span style="color:rgb(98,98,98)">/</span>, <span style="color:rgb(98,98,98)">*</span>args, backend<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">None</span>, <span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>kwargs):
<span class="ansi-green-fg ansi-bold">    410</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> backends:
<span class="ansi-green-fg ansi-bold">    411</span>         <span style="font-style:italic;color:rgb(95,135,135)"># Fast path if no backends are installed</span>
<span class="ansi-green-fg">--&gt; 412</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">orig_func</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    414</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Use `backend_name` in this function instead of `backend`</span>
<span class="ansi-green-fg ansi-bold">    415</span>     backend_name <span style="color:rgb(98,98,98)">=</span> backend

File <span class="ansi-green-fg">~/mambaforge/envs/21924F/lib/python3.12/site-packages/networkx/algorithms/shortest_paths/generic.py:419</span>, in <span class="ansi-cyan-fg">average_shortest_path_length</span><span class="ansi-blue-fg">(G, weight, method)</span>
<span class="ansi-green-fg ansi-bold">    417</span> <span style="font-style:italic;color:rgb(95,135,135)"># Shortest path length is undefined if the graph is not connected.</span>
<span class="ansi-green-fg ansi-bold">    418</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> G<span style="color:rgb(98,98,98)">.</span>is_directed() <span style="font-weight:bold;color:rgb(175,0,255)">and</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> nx<span style="color:rgb(98,98,98)">.</span>is_connected(G):
<span class="ansi-green-fg">--&gt; 419</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> nx<span style="color:rgb(98,98,98)">.</span>NetworkXError(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Graph is not connected.</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">    421</span> <span style="font-style:italic;color:rgb(95,135,135)"># Compute all-pairs shortest paths.</span>
<span class="ansi-green-fg ansi-bold">    422</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">path_length</span>(v):

<span class="ansi-red-fg">NetworkXError</span>: Graph is not connected.</pre>
</div>
</div>
</div>
<p>The <code>connected_components</code> function creates a generator of subgraphs that are the connected components. We can collect the components into a list, for example:</p>
<div id="a5b831ca" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>( nx.connected_components(G) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>[{0, 1, 2, 3, 4}, {5, 6, 7}]</code></pre>
</div>
</div>
<p>Each element of the list above is a set of nodes.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_pw4n4rxn&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_n8zj89s9" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.16" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
<p><br> <a href="_media/memes/lollipop.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="_media/memes/lollipop.jpg" class="img-fluid quarto-figure quarto-figure-center" width="200"></a></p>
</div></div></section>
<section id="er-graphs-1" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="er-graphs-1"><span class="header-section-number">7.4.2</span> ER graphs</h3>
<p>An ER graph may be disconnected. In order to study the statistics of distances for ER graphs, it’s customary to use the largest connected component (often called the <em>big component</em>) of each instance.</p>
<div id="exm-networks-distance-ER" class="theorem example" data-chapter="7" type="💻" data-description="Distances in ER graphs">
<p><span class="theorem-title"><strong>Example 7.17</strong></span> Let’s examine average distances within ER graphs of a fixed type. First, we need to be able to extract the largest component of a disconnected graph. Here is the idiom (referring back to <a href="#exm-networks-connected" class="quarto-xref">Example&nbsp;<span>7.16</span></a>):</p>
<div id="74bbf805" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.lollipop_graph(<span class="dv">5</span>,<span class="dv">3</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>G.remove_edge(<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>G_sub <span class="op">=</span> G.subgraph( <span class="bu">max</span>(nx.connected_components(G), key<span class="op">=</span><span class="bu">len</span>) )</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>( G_sub.nodes )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>{0, 1, 2, 3, 4}</code></pre>
</div>
</div>
<p>Using this idiom, we set up and run the experiment:</p>
<div id="909153e7" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> <span class="dv">121</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">20</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>dbar <span class="op">=</span> []</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    ER <span class="op">=</span> nx.erdos_renyi_graph(n, p, seed<span class="op">=</span><span class="bu">iter</span><span class="op">+</span><span class="dv">5000</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    ER_sub <span class="op">=</span> ER.subgraph( <span class="bu">max</span>(nx.connected_components(ER), key<span class="op">=</span><span class="bu">len</span>) )</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    dbar.append( nx.average_shortest_path_length(ER_sub) )</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"average distance in the big component of ER graphs:"</span>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>sns.displot(x<span class="op">=</span>dbar, bins<span class="op">=</span><span class="dv">13</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>average distance in the big component of ER graphs:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-52-output-2.png" width="470" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The chances are good, therefore, that any message could be passed along in three hops or fewer within the big component of this type of ER graph.</p>
</div>
<p>Theory states that as <span class="math inline">\(n\to\infty\)</span>, the mean distance in ER graphs is expected to be approximately <span id="eq-networks-ER-distance"><span class="math display">\[
\frac{\ln(n)}{\ln(\bar{k})}.
\tag{7.2}\]</span></span></p>
<p>For <a href="#exm-networks-distance-ER" class="quarto-xref">Example&nbsp;<span>7.17</span></a>, we have <span class="math inline">\(n=121\)</span> and <span class="math inline">\(\bar{k}=6\)</span>, which gives about 2.68 in this formula.</p>
</section>
<section id="sec-networks-distance-WS" class="level3 page-columns page-full" data-number="7.4.3">
<h3 data-number="7.4.3" class="anchored" data-anchor-id="sec-networks-distance-WS"><span class="header-section-number">7.4.3</span> WS graphs</h3>
<p>The Watts–Strogatz model was originally proposed to demonstrate small-world networks. The initial ring-lattice structure of the construction exhibits both large clustering and large mean distance:</p>
<div id="aef575e6" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0 ==&gt; initial ring lattice</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.watts_strogatz_graph(<span class="dv">400</span>, <span class="dv">6</span>, <span class="dv">0</span>)  </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>C0 <span class="op">=</span> nx.average_clustering(G)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>L0 <span class="op">=</span> nx.average_shortest_path_length(G)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Ring lattice has average clustering </span><span class="sc">{</span>C0<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"and average shortest path length </span><span class="sc">{</span>L0<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ring lattice has average clustering 0.6000
and average shortest path length 33.75</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_wmrg9usc&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_vgc4cctn" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.4.3" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>At the other extreme of <span class="math inline">\(q=1\)</span>, we get small clustering and small average distance. The most interesting aspect of WS graphs is the transition between these extremes as <span class="math inline">\(q\)</span> varies.</p>
<div id="601c67b1" class="cell" data-execution_count="54">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> lq <span class="kw">in</span> np.arange(<span class="op">-</span><span class="fl">3.5</span>, <span class="fl">0.01</span>, <span class="fl">0.25</span>):</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>):</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>        G <span class="op">=</span> nx.watts_strogatz_graph(<span class="dv">400</span>, <span class="dv">6</span>, <span class="dv">10</span><span class="op">**</span>lq, seed<span class="op">=</span><span class="dv">302</span> <span class="op">+</span> <span class="dv">10</span><span class="op">*</span><span class="bu">iter</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>        C <span class="op">=</span> nx.average_clustering(G) <span class="op">/</span> C0 </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>        L <span class="op">=</span> nx.average_shortest_path_length(G) <span class="op">/</span> L0</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>        results.append( (lq, C, L) )</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame( results, </span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[ <span class="st">"log10(q)"</span>, <span class="st">"mean clustering"</span>, <span class="st">"mean distance"</span> ] </span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>pd.melt(results, id_vars<span class="op">=</span><span class="st">"log10(q)"</span>),</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">"log10(q)"</span>, y<span class="op">=</span><span class="st">"value"</span>,</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span><span class="st">"variable"</span>, kind<span class="op">=</span><span class="st">"line"</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>            )<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-54-output-1.png" width="613" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The <span class="math inline">\(y\)</span>-axis shows the average clustering and distance relative to their values at <span class="math inline">\(q=0\)</span>, computed above as <code>C0</code> and <code>L0</code>. Watts and Strogatz raised awareness of the fact that for quite small values of <span class="math inline">\(q\)</span>, i.e., relatively few nonlocal connections, there are networks with both large clustering and small average distance—in short, the small-world effect.</p>
</section>
<section id="twitch-network" class="level3 page-columns page-full" data-number="7.4.4">
<h3 data-number="7.4.4" class="anchored" data-anchor-id="twitch-network"><span class="header-section-number">7.4.4</span> Twitch network</h3>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="_media/memes/graph_distance.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="_media/memes/graph_distance.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="200"></a></p>
</figure>
</div>
</div></div><p>Now we consider distances within the Twitch network.</p>
<div id="d09447de" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>twitch <span class="op">=</span> nx.read_edgelist(<span class="st">"_datasets/musae_edges.csv"</span>, delimiter<span class="op">=</span><span class="st">','</span>, nodetype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>n, e <span class="op">=</span> twitch.number_of_nodes(), twitch.number_of_edges()</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>kbar <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>e<span class="op">/</span>n</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n, <span class="st">"nodes and"</span>, e, <span class="st">"edges"</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"average degree is </span><span class="sc">{</span>kbar<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>7126 nodes and 35324 edges
average degree is 9.914</code></pre>
</div>
</div>
<p>Computing the distances between all pairs of nodes in this graph would take a long time, so we sample pairs randomly to get an estimate.</p>
<div id="2edd78d7" class="cell" data-execution_count="56">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> default_rng(<span class="dv">19716</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the distance between a random pair of distinct nodes:</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pairdist(G):</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> nx.number_of_nodes(G)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> j <span class="op">=</span> rng.integers(<span class="dv">0</span>,n)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i<span class="op">==</span>j: j<span class="op">=</span>rng.integers(<span class="dv">0</span>,n)   <span class="co"># get distinct nodes</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nx.shortest_path_length(G, source<span class="op">=</span>i, target<span class="op">=</span>j)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>distances <span class="op">=</span> [ pairdist(twitch) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50000</span>) ]</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Pairwise distances in Twitch graph:"</span>)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>sns.displot(x<span class="op">=</span>distances, discrete<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">"estimated mean ="</span>, np.mean(distances) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pairwise distances in Twitch graph:
estimated mean = 3.67584</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-56-output-2.png" width="469" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_69r73wf2&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_a88i0hvd" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.4.4" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>Next we explore WS graphs with the same <span class="math inline">\(n\)</span> as the Twitch network and <span class="math inline">\(k=10\)</span> to get a similar average degree.</p>
<div id="e8fe27ed" class="cell" data-execution_count="57">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">44044</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>n, k <span class="op">=</span> twitch.number_of_nodes(), <span class="dv">10</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q <span class="kw">in</span> np.arange(<span class="fl">0.1</span>, <span class="fl">0.76</span>, <span class="fl">0.05</span>):</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>        WS <span class="op">=</span> nx.watts_strogatz_graph(n, k, q, seed<span class="op">=</span>seed)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>        dbar <span class="op">=</span> <span class="bu">sum</span>(pairdist(WS) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">60</span>))<span class="op">/</span><span class="dv">60</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>        results.append( (q,dbar) )</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>        seed <span class="op">+=</span> <span class="dv">7</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame( results, columns<span class="op">=</span>[<span class="st">"q"</span>, <span class="st">"mean distance"</span>] )</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Pairwise distances in WS graphs:"</span>)</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>results, x<span class="op">=</span><span class="st">"q"</span>, y<span class="op">=</span><span class="st">"mean distance"</span>, kind<span class="op">=</span><span class="st">"line"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pairwise distances in WS graphs:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-57-output-2.png" width="469" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The decrease with <span class="math inline">\(q\)</span> here is less pronounced that we saw for the smaller WS graphs in <a href="#sec-networks-distance-WS" class="quarto-xref"><span>Section 7.4.3</span></a>.</p>
<p>In <a href="#exm-networks-cluster-WS" class="quarto-xref">Example&nbsp;<span>7.13</span></a>, we found that <span class="math inline">\(q=0.42\)</span> reproduces the same average clustering as in the Twitch network. In the graph above, that corresponds to a mean distance of about 4.5, which is a bit above the estimated Twitch mean distance of 3.7.</p>
<p>Thus, it’s fair to say that our Twitch network has a mean distance comparable to that of a small-world network with the same size, average degree, and local clustering.</p>
</section>
</section>
<section id="degree-distributions" class="level2 page-columns page-full" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="degree-distributions"><span class="header-section-number">7.5</span> Degree distributions</h2>
<p>As we well know, the mean of a distribution does not tell the entire story about it.</p>
<div id="exm-networks-ddist-twitch" class="theorem example" data-chapter="7" type="💻" data-description="Degree distribution in the Twitch network">
<p><span class="theorem-title"><strong>Example 7.18</strong></span> The distribution of the degrees of all the nodes in our Twitch network has some surprising features:</p>
<div id="4e29bf75" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>twitch <span class="op">=</span> nx.read_edgelist(<span class="st">"_datasets/musae_edges.csv"</span>, delimiter<span class="op">=</span><span class="st">','</span>, nodetype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>twitch_degrees <span class="op">=</span> pd.Series( <span class="bu">dict</span>(twitch.degree) )</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>twitch_degrees.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>count    7126.000000
mean        9.914117
std        22.190263
min         1.000000
25%         2.000000
50%         5.000000
75%        11.000000
max       720.000000
dtype: float64</code></pre>
</div>
</div>
<p>Observe above that that there is a significant disparity between the mean and median values of the degree distribution, and that the standard deviation is much larger than the mean. A histogram plot confirms that the degree distribution is widely dispersed:</p>
<div id="519f4170" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Twitch network degree distribution:"</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>sns.displot(twitch_degrees)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Twitch network degree distribution:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-59-output-2.png" width="469" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In fact, a few nodes in the network have hundreds of friends:</p>
<div id="65ab446a" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>friend_counts <span class="op">=</span> twitch_degrees.value_counts()           <span class="co"># histogram bar heights</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>friend_counts.sort_index(ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>720    1
691    1
465    1
378    1
352    1
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>These “gregarious nodes” or <em>hubs</em> are characteristic of many social and other real-world networks.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_l00fb9pz&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_sa3sxqne" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.18" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>Neither ER nor WS graphs show degree distributions even remotely like that of the Twitch network.</p>
<div id="exm-networks-ddist-ERWS" class="theorem example" data-chapter="7" type="💻" data-description="Degree distribution in the Twitch network">
<p><span class="theorem-title"><strong>Example 7.19</strong></span> We can compare the distribution from <a href="#exm-networks-ddist-twitch" class="quarto-xref">Example&nbsp;<span>7.18</span></a> to that in a sample of ER graphs with the same size and expected average degree:</p>
<div id="69fc062b" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>n, m <span class="op">=</span> twitch.number_of_nodes(), twitch.number_of_edges()</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>kbar <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>m<span class="op">/</span>n</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> kbar<span class="op">/</span>(n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>degrees <span class="op">=</span> []</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    ER <span class="op">=</span> nx.erdos_renyi_graph(n, p, seed<span class="op">=</span><span class="dv">111</span><span class="op">+</span><span class="bu">iter</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>    degrees.extend( [ER.degree(i) <span class="cf">for</span> i <span class="kw">in</span> ER.nodes] )</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ER graphs degree distribution:"</span>)</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>sns.displot(degrees, discrete<span class="op">=</span><span class="va">True</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ER graphs degree distribution:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-61-output-2.png" width="469" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Theory proves that the plot above converges to a <em>binomial distribution</em>. A WS graph has a similar distribution:</p>
<div id="3dc7f9e4" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>k, q <span class="op">=</span> <span class="dv">10</span>, <span class="fl">0.42</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>degrees <span class="op">=</span> []</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    WS <span class="op">=</span> nx.watts_strogatz_graph(n, k, q, seed<span class="op">=</span><span class="dv">222</span><span class="op">+</span><span class="bu">iter</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    degrees.extend( [WS.degree(i) <span class="cf">for</span> i <span class="kw">in</span> WS.nodes] )</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"WS graphs degree distribution:"</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>sns.displot(degrees, discrete<span class="op">=</span><span class="va">True</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WS graphs degree distribution:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-62-output-2.png" width="470" height="469" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_5u566a2l&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_2bwv4r5y" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.19" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><section id="power-law-distribution" class="level3 page-columns page-full" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="power-law-distribution"><span class="header-section-number">7.5.1</span> Power-law distribution</h3>
<p>The behavior of the Twitch degree distribution in <a href="#exm-networks-ddist-twitch" class="quarto-xref">Example&nbsp;<span>7.18</span></a> gets very interesting when the axes are transformed to use log scales:</p>
<div id="7d229644" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>twitch_degrees, log_scale<span class="op">=</span>(<span class="va">True</span>, <span class="va">True</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-63-output-1.png" width="468" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_yo0msaom&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_yfg860v3" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.5.1" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>For degrees between 10 and several hundred, the counts lie nearly on a straight line. That is, if <span class="math inline">\(x\)</span> is degree and <span class="math inline">\(y\)</span> is the node count at that degree, then <span class="math display">\[
\log(y) \approx  - a\cdot \log(x) + b,
\]</span> i.e., <span class="math display">\[
y \approx B x^{-a},
\]</span> for some <span class="math inline">\(a &gt; 0\)</span>. This relationship is known as a <strong>power law</strong>, a relationship often seen in physics. The decay of <span class="math inline">\(x^{-a}\)</span> to zero as <span class="math inline">\(x\to\infty\)</span> is much slower than the normal distribution’s <span class="math inline">\(e^{-x^2/2}\)</span>, for instance, and we often say that the power-law network has a <em>heavy-tailed distribution</em>.</p>
<p>Many social networks seem to follow a power-law distribution of node degrees, to some extent. The precise extent is a subject of heated debate.</p>
<!-- ::::{#exm-networks-ddist-powerlaw}
We can get a fair estimate of the constants $B$ and $a$ in the power law by doing a least-squares fit on the logs of $x$ and $y$. First, we need the counts:

::: {#bab3d0a1 .cell execution_count=64}
``` {.python .cell-code}
y = twitch_degrees.value_counts()
counts = pd.DataFrame( {"degree": y.index, "count": y.values} )
counts = counts[ (counts["degree"] > 10) & (counts["degree"] < 200) ];
counts.head(6)
```

::: {.cell-output .cell-output-display execution_count=63}

```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">10</td>
<td>11</td>
<td>193</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">11</td>
<td>12</td>
<td>155</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">12</td>
<td>13</td>
<td>131</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">13</td>
<td>14</td>
<td>122</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">14</td>
<td>15</td>
<td>103</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">15</td>
<td>17</td>
<td>83</td>
</tr>
</tbody>
</table>

</div>
```

:::
:::


Now we will get additional columns by log transformations. (Note: the `np.log` function is the natural logarithm.)

::: {#77215830 .cell execution_count=65}
``` {.python .cell-code}
logcounts = counts.transform(np.log)
```
:::


Then we use `sklearn` for a linear regression:

::: {#8169cb67 .cell execution_count=66}
``` {.python .cell-code}
from sklearn.linear_model import LinearRegression
lm = LinearRegression()
lm.fit(logcounts[["degree"]], logcounts["count"])
lm.coef_[0], lm.intercept_
```

::: {.cell-output .cell-output-display execution_count=65}
```
(-1.9941272617745704, 9.709406760944697)
```
:::
:::


The first value, which is both the slope of the line and the exponent of $x$ in the power law, is the most interesting part: we conclude that the degree counts varies like $x^{-2}$ over a wide range of degrees. 
:::: -->
</section>
<section id="barabásialbert-graphs" class="level3 page-columns page-full" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="barabásialbert-graphs"><span class="header-section-number">7.5.2</span> Barabási–Albert graphs</h3>
<p>Neither the ER nor the WS model can reproduce a power-law degree distribution. A random <strong>Barabási–Albert graph</strong> (BA graph) is a better approach.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_dqgp9119&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_2spquyx9" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.5.2" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>The construction starts with a small seed graph. One by one, new nodes are added with <span class="math inline">\(m\)</span> edges connecting it to existing nodes. The new edges are chosen randomly, but higher probability is given for connections to nodes that already have higher degree (i.e., are more popular). This is a rich-get-richer concept known as <em>preferential attachment</em>.</p>
<p>Because of preferential attachment, there is a strong tendency to develop some hubs of very high degree, as is required for a power-law degree distribution.</p>
<div id="exm-networks-BA" class="theorem example" data-chapter="7" type="💻" data-description="Barabási--Albert graphs">
<p><span class="theorem-title"><strong>Example 7.20</strong></span> Here is a BA graph with 200 nodes and <span class="math inline">\(m=3\)</span> connections per new node:</p>
<div id="ecf2a9f2" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>BA <span class="op">=</span> nx.barabasi_albert_graph(<span class="dv">200</span>, <span class="dv">3</span>, seed<span class="op">=</span><span class="dv">302</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>BA_degrees <span class="op">=</span> pd.Series( <span class="bu">dict</span>(BA.degree) )</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>nx.draw(</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    BA, </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    node_size<span class="op">=</span><span class="dv">6</span><span class="op">*</span>BA_degrees, </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    node_color<span class="op">=</span><span class="st">"red"</span>, edge_color<span class="op">=</span><span class="st">"gray"</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-67-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The size of each node in the drawing above is proportional to its degree. In the default rendering, the large hubs crowd into the center of the picture, while the lowest-degree nodes are pushed to the periphery.</p>
</div>
<p>Probability theory predicts that a BA graph has a power-law degree distribution with exponent <span class="math inline">\(-3\)</span> as <span class="math inline">\(n\to \infty\)</span>.</p>
<p>Except fot the initial seed stage, each node of a BA graph introduces <span class="math inline">\(m\)</span> new edges, for a total edge count of about <span class="math inline">\(mn\)</span>. By <a href="#thm-networks-degree" class="quarto-xref">Theorem&nbsp;<span>7.1</span></a>, the average degree of the graph is roughly <span class="math inline">\(\bar{k} = 2mn/n = 2m\)</span>.</p>
<div id="exm-networks-powerlaw-ba" class="theorem example" data-chapter="7" type="💻" data-description="Power-law degrees in the Twitch network">
<p><span class="theorem-title"><strong>Example 7.21</strong></span> For the Twitch network, <span class="math inline">\(\bar{k}\)</span> is almost 10, so we use <span class="math inline">\(m=5\)</span> to get a comparable BA graph. Here we construct such a graph with the same number of nodes as the Twitch network.</p>
<div id="9ecd1bf0" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> twitch.number_of_nodes()</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="bu">round</span>(kbar<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>BA <span class="op">=</span> nx.barabasi_albert_graph(n, m, seed<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>BA_degrees <span class="op">=</span> pd.Series( <span class="bu">dict</span>(BA.degree) )</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>BA_degrees, log_scale<span class="op">=</span>(<span class="va">True</span>, <span class="va">True</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-68-output-1.png" width="468" height="468" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>While BA graphs capture the heavy-tailed degree distribution of the Twitch network rather well, they are way off when it comes to clustering. For the Twitch network, we have:</p>
<div id="6a6266d0" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean clustering in Twitch: </span><span class="sc">{</span>nx<span class="sc">.</span>average_clustering(twitch)<span class="sc">:.5f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean clustering in Twitch: 0.13093</code></pre>
</div>
</div>
<p>And for BA, we get:</p>
<div id="e2517608" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>cbar <span class="op">=</span> []</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">3383</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">40</span>):</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    BA <span class="op">=</span> nx.barabasi_albert_graph(n, m, seed<span class="op">=</span>seed)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    cbar.append( nx.average_clustering(BA) )</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean clustering in BA graphs: </span><span class="sc">{</span>np<span class="sc">.</span>mean(cbar)<span class="sc">:.5f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean clustering in BA graphs: 0.00923</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_omh94v1c&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_98bgqima" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.21" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>The Twitch network has characteristics of both small-world (high clustering with small distance) and power-law (superstar hub nodes) networks. Possibly, some combination of the WS and BA constructions would get closer to the Twitch network than either one does alone.</p>
</section>
</section>
<section id="centrality" class="level2 page-columns page-full" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="centrality"><span class="header-section-number">7.6</span> Centrality</h2>
<p>In some applications, we want to know which nodes of a network are the most important in some sense. For instance, we might want to find the most informative website, the most influential members of a social network, or nodes that are critical for efficient transfer within the network. These traits go under the general name of <strong>centrality</strong>.</p>
<section id="degree-centrality" class="level3 page-columns page-full" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="degree-centrality"><span class="header-section-number">7.6.1</span> Degree centrality</h3>
<p>A clear candidate for measuring the centrality of a node is its degree.</p>
<div id="def-networks-centrality-degree" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.8</strong></span> The <strong>degree centrality</strong> of a node is its degree, divided by the maximum possible degree for a node in the graph.</p>
</div>
<p>For an undirected graph without self-links, the maximum degree of a node in a graph with <span class="math inline">\(n\)</span> nodes is just <span class="math inline">\(n-1\)</span>. NetworkX has a function <code>degree_centrality</code> to compute this quantity.</p>
<p>While degree centrality yields useful information in some networks, it is not always a reliable measuring stick. For example, a search engine for the Web that uses degree centrality would be easily fooled by creating a large collection of sites that all link to each other, even if few outside sources also link to the collection. Other aspects of network layout also argue against relying on degree centrality.</p>
<div id="exm-networks-centrality-degree" class="theorem example" data-chapter="7" type="💻" data-description="Degree centrality">
<p><span class="theorem-title"><strong>Example 7.22</strong></span> We start with a small graph:</p>
<div id="986f19d9" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.lollipop_graph(<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>nx.draw(G, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"pink"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-71-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Since this graph has 6 nodes, the degree centrality is equal to the degree divided by 5:</p>
<div id="832d4a58" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> pd.DataFrame( index<span class="op">=</span>G.nodes )</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>values[<span class="st">"degree"</span>] <span class="op">=</span> <span class="bu">dict</span>(G.degree)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>values[<span class="st">"degree centrality"</span>] <span class="op">=</span> nx.degree_centrality(G)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">degree centrality</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>3</td>
<td>0.6</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>0.6</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>0.6</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>0.8</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>2</td>
<td>0.4</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">5</td>
<td>1</td>
<td>0.2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now consider the following Watts–Strogatz graph:</p>
<div id="e63083c9" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.watts_strogatz_graph(<span class="dv">60</span>, <span class="dv">2</span>, <span class="fl">.1</span>, seed<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>deg_cen <span class="op">=</span> pd.Series( nx.degree_centrality(G) )</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(G, seed<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>style <span class="op">=</span> <span class="bu">dict</span>(pos<span class="op">=</span>pos, edge_color<span class="op">=</span><span class="st">"gray"</span>, node_color<span class="op">=</span><span class="st">"pink"</span>, with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>nx.draw(G, <span class="op">**</span>style, node_size<span class="op">=</span><span class="dv">3000</span><span class="op">*</span>deg_cen.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-73-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>There is little variation in the degrees of the nodes. In fact, there are only 3 unique values of the degree centrality. From the rendering of the graph, though, it’s clear that the nodes with degree equal to 2 are not all roughly equivalent. If we remove node 6, for instance, then node 5 is the only other node that will be affected. But if we remove node 22, we cut off a large branch from the rest of the network.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_02qlksln&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_hkis5o1w" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.22" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div></section>
<section id="betweenness-centrality" class="level3 page-columns page-full" data-number="7.6.2">
<h3 data-number="7.6.2" class="anchored" data-anchor-id="betweenness-centrality"><span class="header-section-number">7.6.2</span> Betweenness centrality</h3>
<p>A different way to measure centrality is to consider the paths between nodes. If <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are nodes in a graph, then there is at least one path between them whose length is the shortest possible, that is, whose length is the distance between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. If there is only one such path, then removing it would increase the distance between these nodes. But if there are multiple paths of shortest length between the nodes, then the graph has more redundancy or connectedness built-in.</p>
<div id="def-networks-betweenness" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.9</strong></span> For a graph on <span class="math inline">\(n\)</span> nodes, let <span class="math inline">\(\sigma(i,j)\)</span> denote the number of shortest paths between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. For any other node <span class="math inline">\(k\)</span>, let <span class="math inline">\(\sigma(i,j|k)\)</span> be the number of such shortest paths that pass through node <span class="math inline">\(k\)</span>. Then the <strong>betweenness centrality</strong> of node <span class="math inline">\(k\)</span> is <span id="eq-networks-betweenness"><span class="math display">\[
c_B(k) = \frac{1}{\binom{n-1}{2}}\, \displaystyle\sum_{\substack{\text{all pairs }i,j\\[1mm]i\neq k,\,j\neq k}} \frac{\sigma(i,j|k)}{\sigma(i,j)}.
\tag{7.3}\]</span></span></p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_5bfyctir&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_qzlpcn0m" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.6.2" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>In the sum above, node <span class="math inline">\(k\)</span> remains fixed while <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> range over all the other possible pairings. If no shortest path between a particular <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> passes through node <span class="math inline">\(k\)</span>, then that term is zero. Otherwise, it equals the fraction of shortest paths that do pass through <span class="math inline">\(k\)</span>. Finally, the binomial coefficient <span class="math inline">\(\binom{n-1}{2}\)</span> is the number of terms in the sum.</p>
<p>It’s easy to prove that <span class="math inline">\(0\le c_B(k) \le 1\)</span> for any node and that <span class="math inline">\(c_B(k)=0\)</span> if node <span class="math inline">\(k\)</span> has degree zero or one.</p>
<div id="exm-networks-between-barbell" class="theorem example" data-chapter="7" type="✍️" data-description="Betweenness centrality">
<p><span class="theorem-title"><strong>Example 7.23</strong></span> We will find the betweenness centrality of the following <em>barbell graph</em>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="_media/barbell.png" class="img-fluid figure-img" width="350"></p>
<figcaption>Barbell graph</figcaption>
</figure>
</div>
<p>Let’s begin with node <span class="math inline">\(k=3\)</span>, in the middle. It might help to see a matrix for the terms of the sum in <a href="#eq-networks-betweenness" class="quarto-xref">Equation&nbsp;<span>7.3</span></a>: <span class="math display">\[
\begin{array}{r|cccccc}
&amp; 0 &amp; 1 &amp; 2 &amp; 4 &amp; 5 &amp; 6 \\
0 &amp;  &amp; &amp; &amp; 1/1 &amp; 1/1 &amp; 1/1 \\
1 &amp; &amp; &amp; &amp; 1/1  &amp; 1/1  &amp; 1/1 \\
2 &amp; &amp; &amp; &amp; 1/1 &amp; 1/1 &amp; 1/1 \\
4 &amp; 1/1 &amp; 1/1 &amp; 1/1 &amp; &amp; &amp; \\
5 &amp; 1/1 &amp; 1/1 &amp; 1/1 &amp; &amp; &amp; \\
6 &amp; 1/1 &amp; 1/1 &amp; 1/1 &amp; &amp; &amp; \\
\end{array}
\]</span> How was this filled in? Note that we can divide the nodes into the right-side triangle <span class="math inline">\(\{0,1,2\}\)</span> and the left-side triangle <span class="math inline">\(\{4,5,6\}\)</span>. If we take both <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> from the same triangle, then no shortest paths between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> ever go through node <span class="math inline">\(3\)</span>. This explains the empty entries. On the other hand, if <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are in different triangles, then there is a unique shortest path between them, and it does pass through node 3. Therefore, <span class="math inline">\(\sigma(i,j)=\sigma(i,j|3)=1\)</span> for those pairs. As usual, we sum over only the upper triangle of the matrix to avoid counting both <span class="math inline">\((i,j)\)</span> and <span class="math inline">\((j,i)\)</span>, and since <span class="math inline">\(n=7\)</span>, we divide by <span class="math inline">\((6)(5)/2=15\)</span> to obtain <span class="math display">\[
c_B(3) = \frac{9}{15} = \frac{3}{5}.
\]</span></p>
<p>Next, consider node <span class="math inline">\(k=2\)</span>. The reasoning is similar to the above if we divide the other nodes into the sets <span class="math inline">\(\{0,1\}\)</span> and <span class="math inline">\(\{3,4,5,6\}\)</span>. Hence their betweenness matrix looks like <span class="math display">\[
\begin{array}{r|cccccc}
&amp; 0 &amp; 1 &amp; 3 &amp; 4 &amp; 5 &amp; 6 \\
0 &amp; &amp; &amp; 1/1 &amp; 1/1 &amp; 1/1 &amp; 1/1 \\
1 &amp; &amp; &amp; 1/1 &amp; 1/1  &amp; 1/1  &amp; 1/1 \\
3 &amp; 1/1 &amp; 1/1 &amp; &amp; &amp; &amp; \\
4 &amp; 1/1 &amp; 1/1 &amp; &amp; &amp; &amp; \\
5 &amp; 1/1 &amp; 1/1 &amp; &amp; &amp; &amp; \\
6 &amp; 1/1 &amp; 1/1 &amp; &amp; &amp; &amp; \\
\end{array}
\]</span> This gives <span class="math inline">\(c_B(2)=8/15\)</span>. By symmetry, we get the same value for <span class="math inline">\(c_B(4)\)</span>.</p>
<p>Finally, all the other nodes appear in no shortest paths. For instance, any path passing through node 0 can be replaced with a shorter one that follows the edge between nodes 1 and 2. Hence <span class="math inline">\(c_B\)</span> is zero on nodes 0, 1, 5, and 6.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_ocuse3u7&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_2bkk1nzp" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.23" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
<p>(video example is slightly different)</p>
</div></div><p>The <code>betweenness_centrality</code> function returns a dictionary with nodes as keys and <span class="math inline">\(c_B\)</span> as values. (However, look at <em>both</em> of the next two examples.)</p>
<div id="exm-networks-centrality-btw-power" class="theorem example" data-chapter="7" type="💻" data-description="Betweenness centrality in BA graphs">
<p><span class="theorem-title"><strong>Example 7.24</strong></span> Let’s take a look at centrality measures for a power-law graph. Degree centrality points out a dominant hub:</p>
<div id="4e963905" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> nx.barabasi_albert_graph(<span class="dv">60</span>, <span class="dv">1</span>, seed<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>cdeg <span class="op">=</span> pd.Series( nx.degree_centrality(P) )</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>style <span class="op">=</span> <span class="bu">dict</span>(edge_color<span class="op">=</span><span class="st">"gray"</span>, node_color<span class="op">=</span><span class="st">"pink"</span>, with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>style[<span class="st">"pos"</span>] <span class="op">=</span> nx.spring_layout(P, seed<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>nx.draw(P, node_size<span class="op">=</span><span class="dv">1000</span><span class="op">*</span>cdeg, <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-74-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>However, betweenness centrality also highlights some secondary hubs:</p>
<div id="e5827519" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>cbet <span class="op">=</span> pd.Series( nx.betweenness_centrality(P) )</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>nx.draw(P, node_size<span class="op">=</span><span class="dv">600</span><span class="op">*</span>cbet, <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-75-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The exact computation of betweenness centrality takes a very long time in a graph with a large number of nodes.</p>
</div>
</div>
<p>In practice, the <span class="math inline">\(\sigma\)</span> values in the definition of <span class="math inline">\(c_B\)</span> are often estimated by sampling. This capability is also offered by the <code>betweenness_centrality</code> function.</p>
<div id="exm-networks-centrality-btw-big" class="theorem example" data-chapter="7" type="💻" data-description="Betweenness centrality in the Twitch network">
<p><span class="theorem-title"><strong>Example 7.25</strong></span> With <span class="math inline">\(n&gt;7000\)</span>, the Twitch network is much too large for calculating betweenness centrality exactly. So we provide a parameter <code>k</code> to use estimation by sampling:</p>
<div id="14ce3343" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>tcb <span class="op">=</span> pd.Series( </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    nx.betweenness_centrality(twitch, k<span class="op">=</span><span class="dv">400</span>, seed<span class="op">=</span><span class="dv">302</span>), </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>twitch.nodes </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>hist <span class="op">=</span> sns.displot(x<span class="op">=</span>tcb, bins<span class="op">=</span><span class="dv">24</span>)<span class="op">;</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>hist.axes[<span class="dv">0</span>,<span class="dv">0</span>].set_yscale(<span class="st">"log"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-76-output-1.png" width="459" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As you can see above, only a few nodes stand out as having relatively large betweenness centrality:</p>
<div id="9f0e35f7" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>tcb.sort_values().tail(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>2732    0.024132
1103    0.030459
2447    0.034628
166     0.038451
6136    0.042333
1924    0.043946
5842    0.047202
3401    0.063231
1773    0.116461
4949    0.124590
dtype: float64</code></pre>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_y890gng6&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_x79gcyog" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.25" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div></section>
<section id="eigenvector-centrality" class="level3 page-columns page-full" data-number="7.6.3">
<h3 data-number="7.6.3" class="anchored" data-anchor-id="eigenvector-centrality"><span class="header-section-number">7.6.3</span> Eigenvector centrality</h3>
<p>A different way of distinguishing nodes of high degree is to suppose that not all links are equally valuable. By analogy with ranking sports teams, where wins over good teams should count for more than wins over bad teams, we should assign more importance to nodes that link to other important nodes.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_pmopyffq&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_o8a9igyg" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Section 7.6.3" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div></div><p>We can try to turn this idea into an algorithm as follows. Suppose we initially assign uniform centrality scores <span class="math inline">\(x_1,\ldots,x_n\)</span> to all of the nodes. Now we can update the scores by looking at the current scores for all the neighbors. Specifically, the new scores are</p>
<p><span class="math display">\[
x_i^+ = \sum_{j\text{ adjacent to }i} x_j = \sum_{j=1}^n A_{ij} x_j,\quad i=1,\ldots,n,
\]</span></p>
<p>where <span class="math inline">\(A_{ij}\)</span> are entries of the adjacency matrix. Once we have updated the scores, we can repeat the process to update them again, and so on. If the scores were to converge, in the sense that <span class="math inline">\(x_i^+\)</span> approaches <span class="math inline">\(x_i\)</span>, then we would have a solution of the equation</p>
<p><span class="math display">\[
x_i \stackrel{?}{=} \sum_{j=1}^n A_{ij} x_j, \quad i=1,\ldots,n.
\]</span></p>
<p>In fact, since the sums are all inner products across rows of <span class="math inline">\(\bfA\)</span>, this is simply</p>
<p><span class="math display">\[
\bfx \stackrel{?}{=} \bfA \bfx.
\]</span></p>
<p>Except for <span class="math inline">\(\bfx\)</span> equal to the zero vector, this equation does not have a solution in general. However, if we relax it just a bit, we get somewhere important. Instead of equality, let’s look for <em>proportionality</em>, i.e.,</p>
<p><span class="math display">\[
\lambda \bfx = \bfA \bfx
\]</span></p>
<p>for a number <span class="math inline">\(\lambda\)</span>. This is an <strong>eigenvalue equation</strong>, one of the fundamental problems in linear algebra.</p>
<div id="exm-networks-centrality-eigvector" class="theorem example" data-chapter="7" type="✍️" data-description="Eigenvectors">
<p><span class="theorem-title"><strong>Example 7.26</strong></span> &nbsp;</p>
Eigenvectors!
<div style="max-width:400px">
<div style="position:relative;padding-bottom:71.25%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_3jy3eyyq&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_1g86dy28" width="400" height="285" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.26" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
</div>
<p>Every <span class="math inline">\(n\times n\)</span> matrix has at least one nonzero solution to the eigenvalue equation, although complex numbers might be involved. For an adjacency matrix, the <em>Perron–Frobenius theorem</em> guarantees a real solution for some <span class="math inline">\(\lambda &gt; 0\)</span> and for which the <span class="math inline">\(x_i\)</span> all have the same sign. That last property allows us to interpret the <span class="math inline">\(x_i\)</span> as relative importance or centrality of the nodes.</p>
<div id="def-networks-centrality-eig" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7.10</strong></span> The <strong>eigenvector centrality</strong> of node <span class="math inline">\(i\)</span> is the value of <span class="math inline">\(x_i\)</span>, where <span class="math inline">\(\bfx\)</span> is a positive eigenvector of the adjacency matrix.</p>
</div>
<div id="exm-networks-centrality-eig" class="theorem example" data-chapter="7" type="✍️" data-description="Eigenvector centrality">
<p><span class="theorem-title"><strong>Example 7.27</strong></span> Consider the complete graph <span class="math inline">\(K_3\)</span>, which is just a triangle. Its adjacency matrix is <span class="math display">\[
\bfA = \begin{bmatrix}
0 &amp; 1 &amp; 1 \\ 1 &amp; 0 &amp; 1 \\ 1 &amp; 1 &amp; 0
\end{bmatrix}.
\]</span> We would expect to discover that all three vertices are ranked equally. In fact, if we define <span class="math inline">\(\bfx=\tfrac{1}{3}[1,1,1]\)</span>, then <span class="math display">\[
\bfA \bfx = \bigl[\tfrac{2}{3},\tfrac{2}{3},\tfrac{2}{3} \bigr] = 2 \bfx,
\]</span> is an eigenvalue to go with eigenvector <span class="math inline">\(\bfx\)</span>. Note that any (nonzero) multiple of <span class="math inline">\(\bfx\)</span> would work just as well: <span class="math display">\[
\bfA (c \bfx) =  \bigl[\tfrac{2}{3}c,\tfrac{2}{3}c,\tfrac{2}{3}c \bigr] = 2 (c\bfx),
\]</span> so that <span class="math inline">\(c\bfx\)</span> is also an eigenvector. All that the eigenvector gives us, in other words, is the <em>relative</em> centrality of the nodes.</p>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="max-width:304px">
<div style="position:relative;padding-bottom:75.986842105263%">
<iframe id="kaltura_player" src="https://cdnapisec.kaltura.com/p/2358381/sp/235838100/embedIframeJs/uiconf_id/43030021/partner_id/2358381?iframeembed=true&amp;playerId=kaltura_player&amp;entry_id=1_1vnsvxd5&amp;flashvars[streamerType]=auto&amp;flashvars[localizationCode]=en&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[hotspots.plugin]=1&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;&amp;wid=1_53cuyvsh" width="304" height="231" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Example 7.27" style="position:absolute;top:0;left:0;width:100%;height:100%">
</iframe>
</div>
</div>
<p>(video example is slightly different)</p>
</div></div><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>With a small tweak to avoid overestimating the neighbors of a major hub, eigenvector centrality becomes the <em>PageRank</em> algorithm, which launched Google.</p>
</div>
</div>
<p>NetworkX has two functions for computing eigenvector centrality. One that relies on numpy to solve the eigenvalue problem tends to be the faster one and is called <code>eigenvector_centrality_numpy</code>. As with betweenness centrality, the return value is a dictionary with nodes as the keys.</p>
<div id="exm-networks-centrality-smallworld" class="theorem example" data-chapter="7" type="💻" data-description="Comparison of centrality metrics">
<p><span class="theorem-title"><strong>Example 7.28</strong></span> Continuing with the small-world graph <code>G</code> from <a href="#exm-networks-centrality-degree" class="quarto-xref">Example&nbsp;<span>7.22</span></a>, we look at all three centrality measures side by side:</p>
<div id="03f447a6" class="cell" data-execution_count="78">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>centrality <span class="op">=</span> pd.DataFrame( {<span class="st">"degree"</span>: nx.degree_centrality(G)}, index<span class="op">=</span>G.nodes )</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>centrality[<span class="st">"between"</span>] <span class="op">=</span> nx.betweenness_centrality(G)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>centrality[<span class="st">"eigen"</span>] <span class="op">=</span> nx.eigenvector_centrality_numpy(G)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>pd.melt(centrality, var_name<span class="op">=</span><span class="st">"centrality"</span>),</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"value"</span>, col<span class="op">=</span><span class="st">"centrality"</span>,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="fl">2.4</span>, bins<span class="op">=</span><span class="dv">24</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-78-output-1.png" width="680" height="218" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Of the three, eigenvector centrality does the most to create a relatively small distinguished group. Correlation coefficients suggest that while the three centrality measures are related, they are far from redundant:</p>
<div id="3cb2fe60" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>centrality.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">between</th>
<th data-quarto-table-cell-role="th">eigen</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">degree</td>
<td>1.000000</td>
<td>0.630732</td>
<td>0.601884</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">between</td>
<td>0.630732</td>
<td>1.000000</td>
<td>0.736732</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">eigen</td>
<td>0.601884</td>
<td>0.736732</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here is a ranking based on betweenness:</p>
<div id="c57c8ed9" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>centrality.sort_values(by<span class="op">=</span><span class="st">"between"</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">between</th>
<th data-quarto-table-cell-role="th">eigen</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">42</td>
<td>0.050847</td>
<td>0.595850</td>
<td>0.405831</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">23</td>
<td>0.050847</td>
<td>0.576856</td>
<td>0.458056</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">41</td>
<td>0.033898</td>
<td>0.385739</td>
<td>0.232910</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">40</td>
<td>0.033898</td>
<td>0.368206</td>
<td>0.133669</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">51</td>
<td>0.050847</td>
<td>0.363822</td>
<td>0.392303</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">39</td>
<td>0.033898</td>
<td>0.349503</td>
<td>0.076714</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">38</td>
<td>0.033898</td>
<td>0.329632</td>
<td>0.044027</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">22</td>
<td>0.033898</td>
<td>0.329632</td>
<td>0.262883</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As you can see, the top two are quite clear. A drawing of the graph supports the case that they are indeed central:</p>
<div id="ec677afa" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>style[<span class="st">"pos"</span>] <span class="op">=</span> nx.spring_layout(G, seed<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>nx.draw(G, node_size<span class="op">=</span><span class="dv">500</span><span class="op">*</span>centrality[<span class="st">"between"</span>], <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-81-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A drawback, though, is that there are many secondary nodes whose values taper off only slowly as we enter the remote branches.</p>
<p>Here is a ranking according to eigenvector centrality:</p>
<div id="db7d76d7" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>centrality.sort_values(by<span class="op">=</span><span class="st">"eigen"</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">between</th>
<th data-quarto-table-cell-role="th">eigen</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">23</td>
<td>0.050847</td>
<td>0.576856</td>
<td>0.458056</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">42</td>
<td>0.050847</td>
<td>0.595850</td>
<td>0.405831</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">51</td>
<td>0.050847</td>
<td>0.363822</td>
<td>0.392303</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">22</td>
<td>0.033898</td>
<td>0.329632</td>
<td>0.262883</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>0.033898</td>
<td>0.311806</td>
<td>0.249077</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">41</td>
<td>0.033898</td>
<td>0.385739</td>
<td>0.232910</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">52</td>
<td>0.033898</td>
<td>0.134717</td>
<td>0.225527</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">50</td>
<td>0.033898</td>
<td>0.212741</td>
<td>0.225125</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This ranking has a clear top choice, followed by two that are nearly identical. Here we visualize the scores on the rendering:</p>
<div id="80347da8" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>nx.draw(G, node_size<span class="op">=</span><span class="dv">800</span><span class="op">*</span>centrality[<span class="st">"eigen"</span>], <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-83-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Eigenvector centrality identifies a more compact and distinct center.</p>
</div>
</section>
</section>
<section id="friendship-paradox" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="friendship-paradox"><span class="header-section-number">7.7</span> Friendship paradox</h2>
<p>A surprising fact about social networks is that on average, your friends have more friends than you do, a fact that is called the <strong>friendship paradox</strong>. Let <span class="math inline">\(\mathbf{d}\)</span> be an <span class="math inline">\(n\)</span>-vector whose components are the degrees of the nodes in the network. On average, the number of “friends” (i.e., adjacent nodes) is the average degree, which is equal to</p>
<p><span class="math display">\[
\frac{\onenorm{\mathbf{d}}}{n}.
\]</span></p>
<p>Now imagine that we create a list as follows: for each node <span class="math inline">\(i\)</span>, add to the list the number of friends of each of <span class="math inline">\(i\)</span>’s friends. The mean value of this list is the average number of “friends of friends.”</p>
<p>For example, consider the following graph:</p>
<div id="14ae01cc" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> nx.lollipop_graph(<span class="dv">4</span>, <span class="dv">1</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>nx.draw(L, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-84-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The average degree is <span class="math inline">\((3+3+3+4+1)/5=14/5\)</span>. Here are the entries in our friends-of-friends list contributed by each node:</p>
<ul>
<li>Node 0: 3 (from node 1), 3 (from node 2), 4 (from node 3)</li>
<li>Node 1: 3 (from node 0), 3 (from node 2), 4 (from node 3)</li>
<li>Node 2: 3 (from node 0), 3 (from node 1), 4 (from node 3)</li>
<li>Node 3: 3 (from node 0), 3 (from node 1), 3 (from node 2), 1 (from node 4)</li>
<li>Node 4: 4 (from node 3)</li>
</ul>
<p>The average value of this list, i.e., the average number of friends’ friends, is <span class="math inline">\(44/14=3.143\)</span>, which is indeed larger than the average degree.</p>
<p>There is an easy way to calculate this value in general. Node <span class="math inline">\(i\)</span> contributes <span class="math inline">\(d_i\)</span> terms to the list, so the total number of terms is <span class="math inline">\(\onenorm{\mathbf{d}}\)</span>. We observe that node <span class="math inline">\(i\)</span> appears <span class="math inline">\(d_i\)</span> times in the list, each time contributing the value <span class="math inline">\(d_i\)</span>, so the sum of the entire list must be</p>
<p><span class="math display">\[
\sum_{i=1}^n d_i^2 = \twonorm{\mathbf{d}}^2 = \mathbf{d}^T \mathbf{d}.
\]</span></p>
<p>Hence the mathematical statement of the friendship paradox is</p>
<p><span id="eq-networks-friendship-paradox"><span class="math display">\[
\frac{\onenorm{\mathbf{d}}}{n} \le \frac{\mathbf{d}^T \mathbf{d}}{\onenorm{\mathbf{d}}}.
\tag{7.4}\]</span></span></p>
<p>You are asked to prove this inequality in the exercises. Here is a verification for the BA graph above:</p>
<div id="c63b7423" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> G.number_of_nodes()</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> pd.Series(<span class="bu">dict</span>(G.degree))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>dbar <span class="op">=</span> d.mean()</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>dbar_friends <span class="op">=</span> np.dot(d,d) <span class="op">/</span> d.<span class="bu">sum</span>()</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dbar, <span class="st">"is less than"</span>, dbar_friends)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.0 is less than 2.066666666666667</code></pre>
</div>
</div>
<p>The friendship paradox generalizes to eigenvector centrality: the average centrality of all nodes is less than the average of the centrality of all nodes’ friends. The mathematical statement is <span id="eq-networks-eigen-paradox"><span class="math display">\[
\frac{\onenorm{\mathbf{x}}}{n} \le \frac{\mathbf{x}^T \mathbf{d}}{\onenorm{\mathbf{d}}},
\tag{7.5}\]</span></span> where <span class="math inline">\(\bfx\)</span> is the eigenvector defining centrality of the nodes.</p>
<div id="76cbe1c1" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> centrality[<span class="st">"eigen"</span>]</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>xbar <span class="op">=</span> x.mean()</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>xbar_friends <span class="op">=</span> np.dot(x,d) <span class="op">/</span> <span class="bu">sum</span>(d)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(xbar, <span class="st">"is less than"</span>, xbar_friends)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.073658900483701 is less than 0.0853096968514139</code></pre>
</div>
</div>
<p>In fact, the friendship paradox inequality for any vector <span class="math inline">\(\bfx\)</span> is equivalent to <span class="math inline">\(\bfx\)</span> having nonnegative correlation with the degree vector.</p>
</section>
<section id="communities" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="communities"><span class="header-section-number">7.8</span> Communities</h2>
<p>In applications, one may want to identify <em>communities</em> within a network. There are many ways to define this concept precisely. We will choose a <strong>random-walk</strong> model.</p>
<p>Imagine that a bunny sits on node <span class="math inline">\(i\)</span>. In one second, the bunny hops to one of <span class="math inline">\(i\)</span>’s neighbors, chosen randomly. In the next second, the bunny hops to another node chosen randomly from the neighbors of the one it is sitting on, etc. This is a random walk on the nodes of the graph.</p>
<p>Now imagine that we place another bunny on node <span class="math inline">\(i\)</span> and track its path as it hops around the graph. Then we place another bunny, etc., so that we have an ensemble of walks. We can now reason about the <em>probability</em> of the location of the walk after any number of hops. Initially, the probability of node <span class="math inline">\(i\)</span> is 100%. If <span class="math inline">\(i\)</span> has <span class="math inline">\(m\)</span> neighbors, then each of them will have probability <span class="math inline">\(1/m\)</span> after one hop, and all the other nodes (including <span class="math inline">\(i\)</span> itself) have zero probability.</p>
<p>Let’s keep track of the probabilities for this simple wheel graph:</p>
<div id="fcb3f7c9" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.wheel_graph(<span class="dv">5</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>nx.draw(G, node_size<span class="op">=</span><span class="dv">300</span>, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"yellow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-87-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We start at node 4. This corresponds to the probability vector</p>
<p><span class="math display">\[
\bfp = [0,0,0,0,1].
\]</span></p>
<p>On the first hop, we are equally likely to visit each of the nodes 0, 1, or 3. This implies the probability distribution</p>
<p><span class="math display">\[
\mathbf{q} = \left[\tfrac{1}{3},\tfrac{1}{3},0,\tfrac{1}{3},0\right].
\]</span></p>
<p>Let’s now find the probability of standing on node 0 after the next hop. The two possible histories are 4-1-0 and 4-3-0, with total probability</p>
<p><span class="math display">\[
\underbrace{\frac{1}{3}}_{\text{to 1}} \cdot \underbrace{\frac{1}{3}}_{\text{to 0}} + \underbrace{\frac{1}{3}}_{\text{to 3}} \cdot \underbrace{\frac{1}{3}}_{\text{to 0}} = \frac{2}{9}.
\]</span></p>
<p>What about node 2 after two hops? The viable paths are 4-0-2, 4-1-2, and 4-3-2. Keeping in mind that node 0 has 4 neighbors, we get</p>
<p><span class="math display">\[
\underbrace{\frac{1}{3}}_{\text{to 0}} \cdot \underbrace{\frac{1}{4}}_{\text{to 2}} + \underbrace{\frac{1}{3}}_{\text{to 1}} \cdot \underbrace{\frac{1}{3}}_{\text{to 2}} + \underbrace{\frac{1}{3}}_{\text{to 3}} \cdot \underbrace{\frac{1}{3}}_{\text{to 2}}= \frac{11}{36}.
\]</span></p>
<p>This quantity is actually an inner product between the vector <span class="math inline">\(\mathbf{q}\)</span> (probabilities of the prior location) and</p>
<p><span class="math display">\[
\bfw_2 = \left[ \tfrac{1}{4},\, \tfrac{1}{3},\, 0,\, \tfrac{1}{3},\, 0 \right],
\]</span></p>
<p>which encodes the chance of hopping directly to node 2 from anywhere. In fact, the entire next vector of probabilities is just</p>
<p><span class="math display">\[
\bigl[ \bfw_1^T \mathbf{q},\, \bfw_2^T \mathbf{q},\, \bfw_3^T \mathbf{q},\, \bfw_4^T \mathbf{q},\, \bfw_5^T \mathbf{q} \bigr] = \bfW \mathbf{q},
\]</span></p>
<p>where <span class="math inline">\(\bfW\)</span> is the <span class="math inline">\(n\times n\)</span> matrix whose rows are <span class="math inline">\(\bfw_1,\bfw_2,\ldots.\)</span> In terms of matrix-vector multiplications, we have the easy statement that the probability vectors after each hop are</p>
<p><span class="math display">\[
\bfp, \bfW\bfp, \bfW(\bfW\bfp), \ldots.
\]</span></p>
<p>Explicitly, the matrix <span class="math inline">\(\bfW\)</span> is</p>
<p><span class="math display">\[
\bfW = \begin{bmatrix}
0 &amp; \tfrac{1}{3}  &amp; \tfrac{1}{3}  &amp; \tfrac{1}{3}  &amp; \tfrac{1}{3} \\
\tfrac{1}{4} &amp; 0 &amp; \tfrac{1}{3}  &amp; 0  &amp; \tfrac{1}{3} \\
\tfrac{1}{4} &amp; \tfrac{1}{3} &amp; 0 &amp; \tfrac{1}{3} &amp; 0 \\
\tfrac{1}{4} &amp; 0 &amp; \tfrac{1}{3} &amp; 0 &amp; \tfrac{1}{3} \\
\tfrac{1}{4} &amp; \tfrac{1}{3} &amp; 0 &amp; \tfrac{1}{3} &amp; 0
\end{bmatrix}.
\]</span></p>
<p>This has a lot of resemblance to the adjacency matrix</p>
<p><span class="math display">\[
\bfA = \begin{bmatrix}
0 &amp; 1  &amp; 1  &amp; 1  &amp; 1 \\
1 &amp; 0 &amp; 1 &amp; 0  &amp; 1 \\
1 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
1 &amp; 1 &amp; 0 &amp; 1 &amp; 0
\end{bmatrix}.
\]</span></p>
<p>The only difference is that each column has to be normalized by the number of options outgoing at that node, i.e., the degree of the node. Thus,</p>
<p><span class="math display">\[
W_{ij} = \frac{1}{\operatorname{deg}(j)}\,A_{ij}.
\]</span></p>
<section id="simulating-the-random-walk" class="level3" data-number="7.8.1">
<h3 data-number="7.8.1" class="anchored" data-anchor-id="simulating-the-random-walk"><span class="header-section-number">7.8.1</span> Simulating the random walk</h3>
<p>Let’s do a simulation for a more interesting graph:</p>
<div id="cef25093" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>WS <span class="op">=</span> nx.watts_strogatz_graph(<span class="dv">40</span>, <span class="dv">4</span>, <span class="fl">0.04</span>, seed<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(WS, k<span class="op">=</span><span class="fl">0.25</span>, seed<span class="op">=</span><span class="dv">1</span>, iterations<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>style <span class="op">=</span> <span class="bu">dict</span>(pos<span class="op">=</span>pos, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">"pink"</span>, edge_color<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>nx.draw(WS, node_size<span class="op">=</span><span class="dv">240</span>, <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-88-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>First, we construct the random-walk matrix <span class="math inline">\(\bfW\)</span>.</p>
<div id="4d273f6b" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> WS.number_of_nodes()</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> nx.adjacency_matrix(WS).toarray().astype(<span class="bu">float</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>degree <span class="op">=</span> [ WS.degree[i] <span class="cf">for</span> i <span class="kw">in</span> WS.nodes ] </span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> A.copy()</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>    W[:,j] <span class="op">/=</span> degree[j]</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>sns.heatmap(W).set_aspect(<span class="dv">1</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-89-output-1.png" width="378" height="313" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We set up a probability vector to start at node 0, and then use <code>W.dot</code> to compute the first hop. The result is to end up at 5 other nodes with equal probability:</p>
<div id="7ff4772c" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>init <span class="op">=</span> <span class="dv">33</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.zeros(n)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>p[init] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> W.dot(p)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>sz <span class="op">=</span> <span class="dv">3000</span><span class="op">*</span>p</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="ss">f"Total probability after 1 hop: </span><span class="sc">{</span>p<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.6f}</span><span class="ss">"</span> )</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>nx.draw(WS, node_size<span class="op">=</span>sz, <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total probability after 1 hop: 1.000000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-90-output-2.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>After the next hop, there will again be a substantial probability of being at node 33. But we could also be at some second-generation nodes as well.</p>
<div id="7233a5eb" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> W.dot(p)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="ss">f"Total probability after 2 hops: </span><span class="sc">{</span>p<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.6f}</span><span class="ss">"</span> )</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>nx.draw(WS, node_size<span class="op">=</span><span class="dv">3000</span><span class="op">*</span>p, <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total probability after 2 hops: 1.000000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-91-output-2.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We’ll take 3 more hops. That lets us penetrate a little into the distant nodes.</p>
<div id="d74e19b2" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> W.dot(p)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="ss">f"Total probability after 5 hops: </span><span class="sc">{</span>p<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:.6f}</span><span class="ss">"</span> )</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>nx.draw(WS, node_size<span class="op">=</span><span class="dv">3000</span><span class="op">*</span>p, <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total probability after 5 hops: 1.000000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-92-output-2.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the long run, the probabilities even out, as long as the graph is connected.</p>
<div id="dfdff422" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">200</span>):</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> W.dot(p)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>nx.draw(WS, node_size<span class="op">=</span><span class="dv">3000</span><span class="op">*</span>p, <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-93-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="label-propagation" class="level3" data-number="7.8.2">
<h3 data-number="7.8.2" class="anchored" data-anchor-id="label-propagation"><span class="header-section-number">7.8.2</span> Label propagation</h3>
<p>The random walk brings us to a type of algorithm known as <strong>label propagation</strong>. We start off by “labelling” one or several nodes whose community we want to identify. This is equivalent to initializing the probability vector <span class="math inline">\(\bfp\)</span>. Then, we take a running total over the entire history of the random walk:</p>
<p><span class="math display">\[
\hat{\bfx} = \lambda \bfp_1  + \lambda^2 \bfp_2 +  \lambda^3 \bfp_3 + \cdots,
\]</span></p>
<p>where <span class="math inline">\(0 &lt; \lambda &lt; 1\)</span> is a damping parameter, and</p>
<p><span class="math display">\[
\bfp_1 = \bfW \bfp, \, \bfp_2 = \bfW \bfp_1, \, \bfp_3 = \bfW \bfp_2,\, \ldots.
\]</span></p>
<!-- 
. It's irresistible (and legit linear algebra) to write $\bfW (\bfW \bfp) = \bfW^2\bfp$ and so on for future iterations. Hence,

$$
\hat{\bfx} = \sum_{k=1}^\infty \lambda^k \bfW^k \bfp.
$$ 
-->
<p>In practice, we terminate the sum once <span class="math inline">\(\lambda^k\)</span> is sufficiently small. The resulting <span class="math inline">\(\hat{\bfx}\)</span> can be normalized to a probability distribution,</p>
<p><span class="math display">\[
\bfx = \frac{\hat{\bfx}}{\norm{\hat{\bfx}}_1}.
\]</span></p>
<p>The value <span class="math inline">\(x_i\)</span> can be interpreted as the probability of membership in the community.</p>
<p>Let’s try looking for a community of node 0 in the WS graph above.</p>
<div id="8cd72a56" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.zeros(n)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>p[init] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>lam <span class="op">=</span> <span class="fl">0.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will compute <span class="math inline">\(\bfx\)</span> by accumulating terms in a loop. Note that there is no need to keep track of the entire history of random-walk probabilities; we just use one generation at a time.</p>
<div id="fe01fe78" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.zeros(n)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>mult <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">200</span>):</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> W.dot(p)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>    mult <span class="op">*=</span> lam</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>    x <span class="op">+=</span> mult<span class="op">*</span>p</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">/=</span> np.<span class="bu">sum</span>(x)  <span class="co"># normalize to probability distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The probabilities tend to be distributed logarithmically:</p>
<p>In the following rendering, any node <span class="math inline">\(i\)</span> with a value of <span class="math inline">\(x_i &lt; 10^{-2}\)</span> gets a node size of 0. (You can ignore the warning below. It happens because we have negative node sizes.)</p>
<div id="37f4b356" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>x[x<span class="op">&lt;</span><span class="fl">0.01</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>style[<span class="st">"node_color"</span>] <span class="op">=</span> <span class="st">"lightblue"</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>nx.draw(WS, node_size<span class="op">=</span><span class="dv">4000</span><span class="op">*</span>x, <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-96-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The parameter <span class="math inline">\(\lambda\)</span> controls how quickly the random-walk process is faded out. A smaller value puts more weight on the early iterations, generally localizing the community more strictly.</p>
<div id="ab3aeeb3" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.zeros(n)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>p[init] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>lam <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.zeros(n)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>mult <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">200</span>):</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> W.dot(p)</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>    mult <span class="op">*=</span> lam</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>    x <span class="op">+=</span> mult<span class="op">*</span>p</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">/=</span> np.<span class="bu">sum</span>(x)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="05357c5b" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>x[x<span class="op">&lt;</span><span class="fl">0.01</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>nx.draw(WS, node_size<span class="op">=</span><span class="dv">4000</span><span class="op">*</span>x, <span class="op">**</span>style)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-98-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In practice, we could define a threshold cutoff on the probabilities, or set a community size and take the highest-ranking nodes. Then a new node could be selected and a community identified for it in the subgraph without the first community, etc.</p>
<p>A more sophisticated version of the label propagation algorithm (and many other community detection methods) is offered in a special module.</p>
<div id="c06cfcb3" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> networkx.algorithms.community <span class="im">import</span> label_propagation_communities</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>comm <span class="op">=</span> label_propagation_communities(WS)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>[ <span class="bu">print</span>(c) <span class="cf">for</span> c <span class="kw">in</span> comm ]<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{0, 1, 2, 3, 39}
{4, 5, 6, 7, 8, 29, 30, 31}
{9, 10, 11}
{12, 13, 14, 15}
{16, 17, 18, 19, 20}
{32, 33, 34, 35, 21}
{22, 23, 24, 25, 26, 27, 28}
{36, 37, 38}</code></pre>
</div>
</div>
<div id="b9b08a1b" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> np.array( [<span class="st">"lightblue"</span>,<span class="st">"pink"</span>,<span class="st">"yellow"</span>,<span class="st">"lightgreen"</span>,<span class="st">"purple"</span>,<span class="st">"orange"</span>,<span class="st">"red"</span>,<span class="st">"lightgray"</span>] )</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>color_index <span class="op">=</span> [<span class="dv">0</span>]<span class="op">*</span>n</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,S <span class="kw">in</span> <span class="bu">enumerate</span>(comm):</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> S:</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>        color_index[k] <span class="op">=</span> i</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>nx.draw( WS, node_size<span class="op">=</span><span class="dv">100</span>, pos<span class="op">=</span>pos, node_color<span class="op">=</span>color[color_index] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="networks_files/figure-html/cell-100-output-1.png" width="480" height="365" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="exercises" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="exercises">Exercises</h2>
<div id="exr-networks-basic" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.1</strong></span> For each graph, give the number of nodes, the number of edges, and the average degree.</p>
<p><strong>(a)</strong> The complete graph <span class="math inline">\(K_6\)</span>.</p>
<p><strong>(b)</strong> <a href="_media/nws.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="_media/nws.png" title="NWS graph" class="img-fluid" width="380"></a></p>
<p><strong>(c)</strong> <a href="_media/ladder.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="_media/ladder.png" title="Ladder graph" class="img-fluid" width="380"></a></p>
</div>
<div id="exr-networks-adjmat" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.2</strong></span> Give the adjacency matrix for the graphs in <a href="#exr-networks-basic" class="quarto-xref">Exercise&nbsp;<span>7.1</span></a> (parts (a) and (b) only).</p>
</div>
<div id="exr-networks-ego" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.3</strong></span> For the graph below, draw the ego graph of <strong>(a)</strong> node 4 and <strong>(b)</strong> node 8.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="_media/ba.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="_media/ba.png" title="BA graph" class="img-fluid quarto-figure quarto-figure-center figure-img" width="380"></a></p>
</figure>
</div>
</div>
<div id="exr-networks-erprob" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.4</strong></span> To construct an Erdős-Rényi graph on 25 nodes with expected average degree 8, what should the edge inclusion probability <span class="math inline">\(p\)</span> be?</p>
</div>
<div id="exr-networks-diam" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.5</strong></span> Find the diameters of the graphs in <a href="#exr-networks-basic" class="quarto-xref">Exercise&nbsp;<span>7.1</span></a>.</p>
</div>
<div id="exr-networks-degree-vector" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.6</strong></span> Suppose that <span class="math inline">\(\bfA\)</span> is the adjacency matrix of an undirected graph on <span class="math inline">\(n\)</span> nodes. Let <span class="math inline">\(\boldsymbol{1}\)</span> be the <span class="math inline">\(n\)</span>-vector whose components all equal 1, and let <span class="math display">\[
\mathbf{d} = \bfA \boldsymbol{1}.
\]</span> Explain why <span class="math inline">\(\mathbf{d}\)</span> is the vector whose components are the degrees of the nodes.</p>
</div>
<div id="exr-networks-centrality" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.7</strong></span> Find <strong>(a)</strong> the clustering coefficient and <strong>(b)</strong> the betweenness centrality for each node in the following graph:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="_media/lolly.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="_media/lolly.png" title="lollipop graph" class="img-fluid quarto-figure quarto-figure-center figure-img" width="380"></a></p>
</figure>
</div>
</div>
<div id="exr-networks-centrality-star" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.8</strong></span> A star graph with <span class="math inline">\(n\)</span> nodes and <span class="math inline">\(n-1\)</span> edges has a central node that has an edge to each other node. In terms of <span class="math inline">\(n\)</span>, find <strong>(a)</strong> the clustering coefficient and <strong>(b)</strong> the betweenness centrality of the central node of the star graph.</p>
</div>
<div id="exr-networks-ring-lattice" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.9</strong></span> The Watts–Strogatz construction starts with a <em>ring lattice</em> in which the nodes are arranged in a circle and each is connected to its <span class="math inline">\(k\)</span> nearest neighbors (i.e., <span class="math inline">\(k/2\)</span> on each side). Show that the clustering coefficient of an arbitrary node in the ring lattice is <span class="math display">\[
\frac{3(k-2)}{4(k-1)}.
\]</span></p>
<p>(Hint: Count up all the edges between the neighbors on one side of the node of interest, then all the edges between neighbors on the other side, and finally, the edges going from a neighbor on one side to a neighbor on the other side. It might be easier to work with <span class="math inline">\(m=k/2\)</span> and then eliminate <span class="math inline">\(m\)</span> at the end.)</p>
</div>
<div id="exr-networks-centrality-complete" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.10</strong></span> Recall that the complete graph <span class="math inline">\(K_n\)</span> contains every possible edge on <span class="math inline">\(n\)</span> nodes. Prove that the vector <span class="math inline">\(\bfx=[1,1,\ldots,1]\)</span> is an eigenvector of the adjacency matrix of <span class="math inline">\(K_n\)</span>. (Therefore, the eigenvector centrality is uniform over the nodes.) Note: You do not need to know how to compute an eigenvector or eigenvalue in general; just verify that the given vector satisfies the equation <span class="math inline">\(\bfA \bfx = \lambda \bfx\)</span> for some <span class="math inline">\(\lambda\)</span>.</p>
</div>
<div id="exr-networks-star-eigen" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.11</strong></span> Prove that for the star graph on <span class="math inline">\(n\)</span> nodes as described in <a href="#exr-networks-centrality-star" class="quarto-xref">Exercise&nbsp;<span>7.8</span></a>, the vector <span class="math display">\[
\bfx = \bigl[ \sqrt{n-1},1,1,\ldots,1 \bigr]
\]</span> is an eigenvector of the adjacency matrix, where the central node corresponds to the first element of the vector.</p>
</div>
<div id="exr-networks-friendship" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7.12</strong></span> Prove the friendship paradox, i.e., inequality <a href="#eq-networks-friendship-paradox" class="quarto-xref">Equation&nbsp;<span>7.4</span></a>. (Hint: Start with <a href="clustering.html#eq-cluster-angle" class="quarto-xref">Equation&nbsp;<span>6.1</span></a> using <span class="math inline">\(\bfu=\mathbf{d}\)</span> and <span class="math inline">\(\bfv\)</span> equal to a vector of all ones. Convert from equality to inequality to get rid of the angle <span class="math inline">\(\theta\)</span>. Simplify the inner product, square both sides, and show that it can be rearranged into <a href="#eq-networks-friendship-paradox" class="quarto-xref">Equation&nbsp;<span>7.4</span></a>.)</p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./clustering.html" class="pagination-link" aria-label="Clustering">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Clustering</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./review.html" class="pagination-link" aria-label="Review questions by section">
        <span class="nav-page-text">Review questions by section</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Data Science 1
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Toby Driscoll
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>videojs(video_shortcode_videojs_video1);</script>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","loop":false,"selector":".lightbox","closeEffect":"zoom","descPosition":"bottom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>